<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example: Filtering Preexisting Data · ParticleFilters.jl</title><meta name="title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="og:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="twitter:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta name="description" content="Documentation for ParticleFilters.jl."/><meta property="og:description" content="Documentation for ParticleFilters.jl."/><meta property="twitter:description" content="Documentation for ParticleFilters.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ParticleFilters.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../bootstrap/">Bootstrap Filter</a></li><li><a class="tocitem" href="../beliefs/">Beliefs</a></li><li><a class="tocitem" href="../basic/">Basic Particle Filter</a></li><li><a class="tocitem" href="../depletion/">Handling Particle Depletion</a></li><li><a class="tocitem" href="../sampling/">Sampling</a></li><li class="is-active"><a class="tocitem" href>Example: Filtering Preexisting Data</a><ul class="internal"><li><a class="tocitem" href="#Model"><span>Model</span></a></li><li><a class="tocitem" href="#Data"><span>Data</span></a></li><li><a class="tocitem" href="#Filtering"><span>Filtering</span></a></li><li><a class="tocitem" href="#Plotting-the-Results"><span>Plotting the Results</span></a></li><li><a class="tocitem" href="#Appendix"><span>Appendix</span></a></li></ul></li><li><a class="tocitem" href="../example-feedback/">Example: Feedback Control</a></li><li><a class="tocitem" href="../example-pomdps/">Example: Use with POMDPs.jl</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl/blob/master/docs/src/example-filtering.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-Filtering-Preexisting-Data"><a class="docs-heading-anchor" href="#Example:-Filtering-Preexisting-Data">Example: Filtering Preexisting Data</a><a id="Example:-Filtering-Preexisting-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Filtering-Preexisting-Data" title="Permalink"></a></h1><p>In some cases, there is no need to perform control based on the particle belief and instead the goal is to filter a previously-generated sequence of measurements to remove noise or reconstruct hidden state variables. This tutorial will illustrate use of the <code>runfilter</code> function for that purpose.</p><p>First, we import the packages we will use. </p><pre><code class="language-julia hljs">using Distributions
using Random
using DelimitedFiles
using ParticleFilters
using VegaLite</code></pre><h2 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h2><p>We will use <a href="https://en.wikipedia.org/wiki/Euler_method">Euler-integrated</a> <a href="https://en.wikipedia.org/wiki/Van_der_Pol_oscillator">Van Der Pol Oscillator Equations</a> with noise added as the dynamics (<code>f</code>), and measurements of the position with gaussian noise added (the pdf is encoded in <code>g</code>).</p><p>This model is implemented below. For more information on defining models for particle filters, see the <a href="https://juliapomdp.github.io/ParticleFilters.jl/latest/models/">documentation</a>.</p><pre><code class="language-julia hljs">const dt = 0.2
const mu = 0.8
const sigma = 1.0

function f(x, u, rng)
    xdot = [x[2], mu * (1 - x[1]^2) * x[2] - x[1] + u + 0.1 * randn(rng)]
    return x + dt * xdot
end

g(x1, u, x2, y) = pdf(Normal(sigma), y - x2[1])</code></pre><h2 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h2><p>Suppose that the data we would like to filter are contained in text files. <a href="../u.txt"><code>u.txt</code></a> contains the control inputs, and <a href="../y.txt"><code>y.txt</code></a> contains the measurements. The code that generated this data can be found in the <a href="#Appendix">appendix below</a>.</p><pre><code class="language-julia hljs">ys = vec(readdlm(&quot;y.txt&quot;));
us = vec(readdlm(&quot;u.txt&quot;));</code></pre><h2 id="Filtering"><a class="docs-heading-anchor" href="#Filtering">Filtering</a><a id="Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering" title="Permalink"></a></h2><p>We can use an SIR particle filter to get a better estimate of the state. Note that we start with an initial belief consisting of particles with zero velocity and position uniformly distributed in <span>$[-5, 5]$</span>.</p><pre><code class="language-julia hljs">n = 10_000

fil = BootstrapFilter(f, g, n)

# construct initial belief
b0 = ParticleCollection([[10.0 * (rand() - 0.5), 0.0] for i in 1:n])

bs = runfilter(fil, b0, us, ys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100-element Vector{Any}:
 WeightedParticleBelief{Vector{Float64}}([[3.9233442125078666, -0.7733258143828287], [-1.4800766434442336, 0.30763884951888126], [-3.2178433555143693, 0.6428490208913027], [-0.2647497355025963, 0.043413739462105375], [-0.9007044193907454, 0.15626724994797553], [-4.161908484296592, 0.8496534871464558], [-3.175269429739176, 0.6659747171899715], [3.6593677893529364, -0.7193950710926102], [0.7198364392274659, -0.1590390190159963], [0.11710098984233364, -0.006594455353048334]  …  [0.3067467688592207, -0.062314781249369344], [1.5255798569366308, -0.2895367289083583], [1.3350472584356943, -0.2495162173794234], [4.719897878298799, -0.969195859611152], [1.4769849181184025, -0.31713700033019243], [-2.36263769882622, 0.47301030024026486], [-3.123715495580065, 0.6088317304475719], [-2.6307959069221476, 0.548313463038601], [3.728319798655808, -0.731872495984808], [0.567937729195469, -0.10622474403474785]], [0.12169963481966396, 0.0002298035212696816, 6.17433986040681e-8, 0.012002639195271971, 0.0018211035611693628, 1.9996097088300854e-10, 7.829666177376418e-8, 0.1765295402536635, 0.10015957386193607, 0.030662367159115914  …  0.0462775493046998, 0.2763725631267989, 0.2305221806638844, 0.02596784793678435, 0.2647887031528152, 5.149500790511716e-6, 1.0413577538374468e-7, 1.3916994669413345e-6, 0.16126698226974792, 0.07691396011368093], 989.3190260564536, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[3.768679049631301, 0.2305594698819694], [-0.2560669876101752, 0.1301419336376362], [3.5154887751344144, -0.015871436486502577], [0.6880286354242666, -0.3208362440451916], [0.11578209877172396, 0.010277254124133014], [2.3624631064750723, -0.5260443973141522], [2.3624631064750723, -0.548273416905755], [2.3624631064750723, -0.5697569497397], [2.3624631064750723, -0.5803132427197214], [1.5796708576608813, -0.5712925317634948]  …  [1.4676725111549591, -0.5085797533974808], [1.4676725111549591, -0.5347045184642469], [1.4676725111549591, -0.5034053498920725], [1.2851440149598097, -0.4604259346607406], [1.2851440149598097, -0.4754281087650151], [1.413557518052364, -0.534364283269083], [1.413557518052364, -0.5708862157651657], [1.413557518052364, -0.562533365953933], [3.5819452994588463, 0.0413468051100816], [0.5466927803885194, -0.20590211364332817]], [0.06587360588034395, 0.04156067694271015, 0.10315409164221552, 0.19822624673094974, 0.08553034891923568, 0.3535139193444986, 0.3535139193444986, 0.3535139193444986, 0.3535139193444986, 0.38239533646422263  …  0.36781624182245604, 0.36781624182245604, 0.36781624182245604, 0.3360813113737685, 0.3360813113737685, 0.3593536670438825, 0.3593536670438825, 0.3593536670438825, 0.09226931553676997, 0.16604536803607783], 2771.7536482369524, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[3.814790943607695, -1.0242679342717356], [0.6238613866152283, -0.49090701358831934], [2.257254227012242, -0.6256953997966159], [2.252808423093921, -0.611663971174069], [2.252808423093921, -0.6410562825354147], [2.2485117165271324, -0.6150381989824797], [2.246400457931128, -0.6368475502440714], [1.4654123513081823, -0.7521224440649099], [1.4654123513081823, -0.7640261370551601], [1.4629266038329825, -0.7409380339154041]  …  [1.3659565604754629, -0.7163441577089004], [1.3607316074621096, -0.7443209881070605], [1.3669914411765447, -0.7138606181649831], [1.1930588280276615, -0.6829877081366323], [1.1900583932068067, -0.6891278697691803], [1.1900583932068067, -0.675958189679842], [1.3066846613985474, -0.730302989691914], [1.2993802748993308, -0.7624531120757274], [1.3010508448615774, -0.7267617213758553], [3.5902146604808625, -0.789693965675284]], [0.092204190778876, 0.1335704986977533, 0.3942348699410967, 0.39450111351912664, 0.39450111351912664, 0.3947511847540769, 0.3948714484194903, 0.3255268278241607, 0.3255268278241607, 0.32501016777189906  …  0.3040127875810728, 0.3028398666069377, 0.3042446552175959, 0.26365968811245294, 0.26293949794710253, 0.26293949794710253, 0.29050382147578746, 0.2888109050530291, 0.28919857689254297, 0.13204941770043094], 3246.6927909092365, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[3.6099373567533477, 0.4624437019764036], [0.5256799838975644, -0.6854153916574267], [2.132115147052919, -0.6664728701689177], [2.1304756288591076, -0.6386434756205511], [2.124597166586838, -0.6613330409932566], [2.1255040767306363, -0.6567673161834282], [2.119030947882314, -0.6664634160539011], [1.3149878624952003, -0.8988273681423123], [1.3126071238971502, -0.956425387508508], [1.3147389970499017, -0.9206933276149394]  …  [1.2226877289336828, -0.9148498677454757], [1.2118674098406976, -0.8783072153559646], [1.224219317543548, -0.8911548698669293], [1.056461286400335, -0.89973914349587], [1.0522328192529706, -0.8652728672757051], [1.0548667552708384, -0.9023562380129524], [1.1606240634601646, -0.9353236098000675], [1.1468896524841854, -0.9276301205254834], [1.1556985005864064, -0.9216855083369915], [3.4322758673458056, -0.01970796265311836]], [6.18373728845053e-5, 0.21681886813712167, 0.010122258997632663, 0.010167332028619528, 0.010330368523439671, 0.010305069501335315, 0.010486820107529424, 0.06641449124161063, 0.06671438911054958, 0.06644579485344401  …  0.07876251202107279, 0.08030801922701908, 0.07854542277318442, 0.10479947893468974, 0.10552562408016525, 0.10507293610686759, 0.0879094945700114, 0.09002623964985548, 0.08866475925710324, 0.00012810803174983915], 442.05018641817827, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.38859690556607906, -0.87663115333226], [0.38859690556607906, -0.8512913192795892], [0.38859690556607906, -0.9209755992183564], [0.38859690556607906, -0.8779198270029609], [0.38859690556607906, -0.8733234422221596], [2.0027469337349975, -0.7083983590651521], [1.1352223888667379, -1.0712929111276355], [1.1352223888667379, -1.0839021253519305], [1.1213220463954485, -1.125483602357225], [1.1306003315269137, -1.129205637803684]  …  [0.8791782457978297, -1.0826663234063882], [0.8791782457978297, -1.0640988781584144], [0.8743955076682479, -1.1049908969387678], [0.8743955076682479, -1.0625085188055532], [0.9735593415001511, -1.1370572586892038], [0.9735593415001511, -1.140350167185322], [0.9613636283790887, -1.088697031610953], [0.9613636283790887, -1.1039967539393467], [0.9713613989190082, -1.1051708797550703], [0.9713613989190082, -1.1050603234519798]], [0.10433312161781146, 0.10433312161781146, 0.10433312161781146, 0.10433312161781146, 0.10433312161781146, 0.3988305348260505, 0.26819183676227076, 0.26819183676227076, 0.2648644030934905, 0.2670865324389077  …  0.20659037879639214, 0.20659037879639214, 0.20545758322331126, 0.20545758322331126, 0.22919238789395918, 0.22919238789395918, 0.22625146347335112, 0.22625146347335112, 0.2286620697620099, 0.2286620697620099], 2239.259053809491, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.21327067489962703, -1.0700967067385523], [0.20440178572240777, -1.1336351870749768], [0.21393221712164712, -1.0917326212621137], [1.861067261921967, -0.7522181848174855], [1.861067261921967, -0.7787428823059686], [0.9209638066412108, -1.267282185931717], [0.9184419637963518, -1.2802390334132783], [0.8962253259240035, -1.3108765256464645], [0.9047592039661769, -1.3051899595543806], [0.9186724713407051, -1.2435959916608026]  …  [0.6569234866391636, -1.3263694434537163], [0.662644981116552, -1.3001917808644867], [0.6663584701661468, -1.3162477849751166], [0.6618938039071373, -1.253702342621031], [0.7461478897623104, -1.3414577727879635], [0.7454893080630867, -1.3233979501454367], [0.7436242220568982, -1.275748417073033], [0.7405642775912193, -1.2956239714687299], [0.7503272229679941, -1.3447147052109623], [0.7503493342286123, -1.3303711405185752]], [0.032515112614158084, 0.031874490843878896, 0.032563307636162914, 0.33492627278434994, 0.33492627278434994, 0.12346890622635122, 0.12299255645827858, 0.11884202150809386, 0.1204265290417136, 0.12303605299635408  …  0.07957810137873975, 0.08039854319619899, 0.08093414758439879, 0.08029049645625498, 0.09303438886207882, 0.09292987693270169, 0.09263432050388531, 0.09215075770006868, 0.09369941525735374, 0.09370294191807631], 1459.2793747386409, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.0007486664480834404, -1.26666861660918], [1.7106236249584699, -0.8365044545887302], [1.7106236249584699, -0.8318285253126588], [1.7053186854607734, -0.8689183057617483], [1.7053186854607734, -0.8585260954732072], [1.7053186854607734, -0.851745790441012], [0.6675073694548674, -1.4698890911360405], [0.6340500207947106, -1.5353851233116131], [0.6437212120553009, -1.4820670474869149], [0.6699532730085446, -1.4680484599529913]  …  [0.5575036357158449, -1.5530831129312272], [0.5775258570736769, -1.447925646516032], [0.5976577525696135, -1.4795239308790435], [0.3774818487505201, -1.6252465545115184], [0.3916495979484203, -1.5736154905151691], [0.4026066249436547, -1.5349077220913203], [0.41115333538293103, -1.4957737061895646], [0.4808097180339993, -1.5654646873648501], [0.4884745386422915, -1.5348863448417664], [0.4813842819258017, -1.5947615731943232]], [0.2762197277066455, 0.27706022351918685, 0.27706022351918685, 0.27831422191936656, 0.27831422191936656, 0.27831422191936656, 0.3918650023010978, 0.38917432889700804, 0.3899950465288859, 0.39204521816576415  …  0.3814781916089354, 0.38369350570244437, 0.38577796639591144, 0.3556636903031581, 0.3580507927534085, 0.3598583699941589, 0.36124454111163107, 0.3717290329601948, 0.3727906633276328, 0.37180926642116224], 3489.6721887918916, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.2540823897699195, -1.4849799213668093], [1.5433227340407238, -0.9366524952576366], [1.544257919895938, -0.9001024014221348], [1.5315350243084236, -0.9217662076784976], [1.5336134663661318, -0.9703553183217187], [1.534969527372571, -0.9289773793635595], [0.37352955122765935, -1.7265033392527642], [0.32697299613238795, -1.7991807152187724], [0.3473078025579179, -1.7517090431329618], [0.3763435810179463, -1.7413405855000719]  …  [0.2468870131295995, -1.8425622232192729], [0.2879407277704705, -1.705013150155881], [0.3017529663938048, -1.781708208028708], [0.05243253784821639, -1.9228671007686562], [0.07692649984538646, -1.8775190276382878], [0.0956250805253906, -1.8115032439979362], [0.11199859414501812, -1.8081094866750227], [0.16771678056102923, -1.8428985388991295], [0.1814972696739382, -1.8004326269828987], [0.16243196728693704, -1.8804176415438594]], [0.1361419609673237, 0.3776712797368302, 0.3775542130374169, 0.3791215527187539, 0.3788692555153118, 0.37870385507873167, 0.2806365175565743, 0.26959664073110556, 0.2744373059778123, 0.2812985686887938  …  0.25033971360098967, 0.2602413248786368, 0.26356005793127035, 0.2036059209894838, 0.20941036645576655, 0.21386620328125955, 0.21778323276059708, 0.2311932638032967, 0.2345230151237687, 0.229917300463626], 3243.4300724958603, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.5510783740432814, -1.6471731142090456], [1.3559922349891966, -1.0575648668824211], [1.3642374396115111, -0.9933460004674414], [1.347181782772724, -1.0324016615178495], [1.3395424027017881, -1.0909802336065753], [1.3491740514998591, -1.0095964518683402], [0.028228883377106495, -2.040047400575235], [-0.03286314691136655, -2.1337686764924775], [-0.0030340060686744885, -2.033656211693038], [0.02807546391793192, -2.0535409841334413]  …  [-0.12162543151425509, -2.1581476917408398], [-0.05306190226070573, -2.0016294577996847], [-0.05458867521193689, -2.1194995759805693], [-0.33214088230551486, -2.2787341247980732], [-0.29857730568227114, -2.184709647670624], [-0.26667556827419664, -2.1297329888714716], [-0.24962330318998643, -2.1293389339832376], [-0.20086292721879667, -2.1594333108145296], [-0.17858925572264156, -2.1441210569680433], [-0.21365156102183486, -2.17783901376609]], [0.39756593622665887, 0.05505606117973559, 0.05415814040939819, 0.05602778814124881, 0.05688065247921018, 0.055806944926206914, 0.3203454705142624, 0.33295388774503404, 0.3268891987521326, 0.3203780257378617  …  0.34982817432516095, 0.3369540575348077, 0.3372527733223032, 0.38114961956687216, 0.37709231157863465, 0.3728863538414954, 0.3705027628756248, 0.36318749679883916, 0.3596095266521635, 0.36517600491901997], 2104.078940204684, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.8805129968850905, -1.7158080674844103], [-0.8805129968850905, -1.7120432150239042], [1.165568239518023, -1.1300406392171378], [-0.37978059673794057, -2.38729494647991], [-0.37978059673794057, -2.3593534421542963], [-0.4596168822098621, -2.4685644474812114], [-0.4596168822098621, -2.4563078590857987], [-0.40976524840728207, -2.3455152084846818], [-0.3826327329087564, -2.390592426043657], [-0.3826327329087564, -2.392980996402947]  …  [-0.735519235216396, -2.4559361886653486], [-0.735519235216396, -2.4939613008100867], [-0.692622166048491, -2.396448983897107], [-0.675491089986634, -2.3600108787746557], [-0.675491089986634, -2.40680790257987], [-0.6327495893817026, -2.4711879249356303], [-0.6327495893817026, -2.451680936502565], [-0.6074134671162503, -2.4164176987796253], [-0.6074134671162503, -2.422301006682403], [-0.649219363775053, -2.458898707399947]], [0.21133974248371046, 0.21133974248371046, 0.26156796531503224, 0.32784884527674807, 0.32784884527674807, 0.31086124793295805, 0.31086124793295805, 0.32160276039190566, 0.3272621968909612, 0.3272621968909612  …  0.24626299777185362, 0.24626299777185362, 0.2566250392124246, 0.2607498653269212, 0.2607498653269212, 0.2709856056282345, 0.2709856056282345, 0.27700279656406857, 0.27700279656406857, 0.2670524498471808], 3224.8992015085505, nothing, nothing)
 ⋮
 WeightedParticleBelief{Vector{Float64}}([[0.9267331231305215, -1.271160205619524], [0.9057002060685462, -1.3556931021606793], [0.9498012659007522, -1.3235137596090114], [0.9437719376074917, -1.3304710736872338], [0.7820075990385551, -1.4173141687486943], [0.8899116309942994, -1.3216819256322037], [0.7081259577151524, -1.510390495975871], [0.8090363658802728, -1.426922969058994], [0.8111687720544232, -1.4411584942330904], [0.8287435220869415, -1.4141636481628903]  …  [1.3297494954472466, -1.015030991375368], [0.9251510164752036, -1.305381549845375], [0.9269800799707673, -1.3339582096113627], [0.7272458901645622, -1.503166432771764], [1.0339998583738195, -1.2651394060993904], [0.9030777297196191, -1.3514892018704812], [0.7595201201841091, -1.4917248409868478], [0.8232906750018519, -1.4393428432347366], [0.8472834966405964, -1.4544629115074932], [0.816988407011554, -1.465206419635678]], [0.37440069168673695, 0.3715228866305129, 0.3773905877110648, 0.3766261658996373, 0.35187708746586804, 0.3692698218292471, 0.3381646545691238, 0.3565448068894069, 0.3569045892757857, 0.35982136727872727  …  0.39850798760979395, 0.3741892060240912, 0.3744336294782445, 0.34184011996533703, 0.38675726039061126, 0.37115411113586755, 0.3478465105770097, 0.3589257108568639, 0.36280269812061544, 0.35788005320871463], 3962.70829841087, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.6725010820066166, -1.4703528111891973], [0.6345615856364103, -1.5958935008903312], [0.6850985139789498, -1.5311607218850036], [0.6776777228700449, -1.5453759890400185], [0.49854476528881625, -1.6786795834819834], [0.6255752458678586, -1.543758296511509], [0.4060478585199782, -1.8051939711115061], [0.523651772068474, -1.6456177757925476], [0.5229370732078051, -1.6844899730989542], [0.5459107924543634, -1.643613866678449]  …  [1.126743297172173, -1.129318430766592], [0.6640747065061285, -1.4997899953602203], [0.6601884380484947, -1.5213334538720913], [0.42661260361020936, -1.7629678626911254], [0.7809719771539414, -1.4825614184393845], [0.6327798893455228, -1.5577452180215452], [0.46117515198673953, -1.7623581464505422], [0.5354221063549046, -1.6731099095557775], [0.5563909143390977, -1.699483103832823], [0.5239471230844184, -1.712763034003929]], [0.3827594045950331, 0.378330623920702, 0.3841190810056983, 0.38332491317199463, 0.3586023678286982, 0.37720961106819784, 0.3421422785601391, 0.3626694918914055, 0.36255624153609345, 0.3661207700391696  …  0.3934534506258131, 0.38181878753956844, 0.3813766269025497, 0.3459910770365686, 0.39257984701933224, 0.37811052618695146, 0.35222170491338456, 0.36451291823313625, 0.3676939888423427, 0.3627162490989311], 3938.4498536622477, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.3784305197687772, -1.7338963496645867], [0.31538288545834403, -1.8554155472756346], [0.3788663696019491, -1.7701154510352832], [0.36860252506204116, -1.8050480596167295], [0.16280884859241956, -2.0009996270071806], [0.31682358656555676, -1.8171943458671787], [0.04500906429767698, -2.1486793519592386], [0.19452821690996447, -1.9249442101738707], [0.18603907858801427, -1.9989999017510545], [0.21718801911867353, -1.908940808003079]  …  [0.9008796110188545, -1.3203414557426605], [0.3641167074340845, -1.752221581033944], [0.35592174727407644, -1.8072668014949322], [0.07401903107198426, -2.0858144436739225], [0.4844596934660645, -1.7068017711637793], [0.3212308457412137, -1.8615698772864633], [0.10870352269663108, -2.1009064681417473], [0.20080012444374906, -1.955313689645619], [0.21649429357253308, -2.0069968739080775], [0.18139451628363257, -2.0400643005871246]], [0.1326027703448718, 0.12051735008659496, 0.1326885659992728, 0.1306762304548545, 0.0940739335400657, 0.12078617616321545, 0.076470212378229, 0.09923551221977021, 0.09783662133038727, 0.10303189388369485  …  0.2512158016728277, 0.12980205545234383, 0.12821347042920272, 0.08057676213493228, 0.15433225873062492, 0.1216107054467169, 0.08568233374533823, 0.10027722443866192, 0.10291432517285859, 0.09707666552223848], 2287.360690516791, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.03165124983585982, -1.9876813638541768], [-0.05570022399678293, -2.143874758792949], [0.024843279394892392, -2.1115854969348757], [0.007592913138695256, -2.105496513252994], [-0.23739107680901655, -2.2907546317917564], [-0.046615282607879005, -2.109694041858182], [-0.38472680609417076, -2.5241588604125837], [-0.1904606251248097, -2.293434836548483], [-0.21376090176219664, -2.3460340346034], [-0.16460014248194227, -2.211894206248008]  …  [0.6368113198703225, -1.5375969896073], [0.013672391227295633, -2.074452565016417], [-0.005531613024910009, -2.145548635223445], [-0.34314385766280026, -2.4735800909038512], [0.1430993392333086, -2.0232873042290462], [-0.05108312971607898, -2.2107821628792514], [-0.3114777709317184, -2.46456859676095], [-0.19026261348537477, -2.2950382590621965], [-0.18490508120908244, -2.334043108305459], [-0.22661834383379237, -2.3812617610925138]], [0.18589975864640834, 0.20630218193827854, 0.18746604917616808, 0.19145439791875962, 0.2500097782971144, 0.20415246245687788, 0.28516987679231454, 0.2386571745458968, 0.24429488126466753, 0.23240442966143046  …  0.0732763087988407, 0.1900456623409595, 0.19450680436341763, 0.27537842155008146, 0.16097820096313364, 0.20520896707360883, 0.2678373760499081, 0.23860927060029846, 0.23731326169834646, 0.24740515823596035], 928.5094952100809, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.36588502293497555, -2.3510463744370806], [-0.36588502293497555, -2.290458832274835], [-0.4844751757553728, -2.457585651907139], [-0.4844751757553728, -2.486703754723554], [-0.39747381999208276, -2.4489109718751774], [-0.39747381999208276, -2.4294947942854708], [-0.41350638951190355, -2.432950075787737], [-0.41350638951190355, -2.470034709982293], [-0.6955420031673678, -2.561189399321329], [-0.6955420031673678, -2.5506568539384675]  …  [-0.8043914902839084, -2.771884678858964], [-0.8043914902839084, -2.775133267604879], [-0.6492702652978141, -2.6204976781940146], [-0.6492702652978141, -2.6173926963890155], [-0.6492702652978141, -2.5854338094961915], [-0.6517137028701743, -2.7028621602970513], [-0.6517137028701743, -2.686926240691813], [-0.7028706960522951, -2.673411842578914], [-0.7028706960522951, -2.6525727937480004], [-0.7028706960522951, -2.6893509013542007]], [0.2755579421833001, 0.2755579421833001, 0.3030154554867467, 0.3030154554867467, 0.28300749992158325, 0.28300749992158325, 0.2867556662756366, 0.2867556662756366, 0.3465579092215773, 0.3465579092215773  …  0.3649940613773853, 0.3649940613773853, 0.33779112426609015, 0.33779112426609015, 0.33779112426609015, 0.33826658157746864, 0.33826658157746864, 0.34789880997848904, 0.34789880997848904, 0.34789880997848904], 1649.4753269411308, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.8360942978223918, -2.5994759585728766], [-0.8360942978223918, -2.558301617819578], [-0.8239767893899426, -2.531794952790002], [-0.9759923061368005, -2.6816865401568193], [-0.9759923061368005, -2.631027117420596], [-0.9818159267000837, -2.714190336345097], [-0.9818159267000837, -2.7277366591898278], [-0.8872560143671182, -2.714634538738971], [-0.8872560143671182, -2.752551475089147], [-0.883372778849177, -2.6458662788439278]  …  [-1.1922861349295846, -2.7925101392685545], [-1.1922861349295846, -2.8046622200909868], [-1.1890989510085368, -2.825163787981417], [-1.1890989510085368, -2.788498273985208], [-1.237553064568078, -2.7117189408831135], [-1.237553064568078, -2.7553156495692295], [-1.2333852548018953, -2.7649068809243094], [-1.2333852548018953, -2.763941491530818], [-1.2407408763231353, -2.7362955519120753], [-1.2407408763231353, -2.775243294330515]], [0.36622831738245676, 0.36622831738245676, 0.3680416611460985, 0.34227009537830033, 0.34227009537830033, 0.3411626946086602, 0.3411626946086602, 0.3580899932164684, 0.3580899932164684, 0.3587342373238534  …  0.29662721561772615, 0.29662721561772615, 0.29735442683651153, 0.29735442683651153, 0.28617472050645226, 0.28617472050645226, 0.2871460969623542, 0.2871460969623542, 0.28543062068262126, 0.28543062068262126], 3767.395916785008, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.355989489536967, -2.5770882194976044], [-1.3477546213863074, -2.5199492755005424], [-1.330335779947943, -2.5134009191056066], [-1.5123296141681646, -2.5047956970475806], [-1.50219772962092, -2.4246009474627175], [-1.524653993969103, -2.5170137014449305], [-1.5273632585380492, -2.560930593144558], [-1.4301829221149123, -2.646740551961693], [-1.4377663093849478, -2.6368442814847204], [-1.4125460346179626, -2.5291753277802442]  …  [-1.7507881627832955, -2.3553589373518413], [-1.753218578947782, -2.3439703634269393], [-1.7541317086048203, -2.3439672740285133], [-1.7467986058055784, -2.329720250271399], [-1.7798968527447006, -2.2432651487566577], [-1.7886161944819237, -2.270677823669307], [-1.7863666309867572, -2.3306735168689827], [-1.786173553108059, -2.293464638280012], [-1.7879999867055503, -2.2516590194656922], [-1.7957895351892383, -2.2970164061477814]], [0.09814693042586388, 0.09679938140561689, 0.09398861831379027, 0.12597344968527316, 0.12404392603384863, 0.12834325684572895, 0.1288675346589612, 0.1108266061901674, 0.11217672917372039, 0.10772513719071881  …  0.17586412258928216, 0.17641152309711344, 0.1766173569252993, 0.1749669975608619, 0.18246255478304968, 0.184456425868542, 0.18394127577554026, 0.18389708467000287, 0.18431526372620588, 0.1861024863417268], 496.6170302090631, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.8714071334364881, -1.9559984863075988], [-1.8714071334364881, -1.957616428587941], [-1.851744476486416, -1.9448645837373215], [-1.851744476486416, -1.9441014580405227], [-1.8330159637690642, -1.9253413963906345], [-1.8330159637690642, -1.8962720718557051], [-2.013288753577681, -1.6823786846719453], [-2.013288753577681, -1.6279984376317875], [-1.9871179191134634, -1.627700027246783], [-1.9871179191134634, -1.6173471170026057]  …  [-2.2448664807640615, -1.1420798941075445], [-2.2448664807640615, -1.114630903024036], [-2.238331790598689, -1.1368041040824008], [-2.238331790598689, -1.0789660293500092], [-2.238331790598689, -1.1004547386549666], [-2.238331790598689, -1.0956136030468018], [-2.255192816418795, -1.1451711189802858], [-2.255192816418795, -1.1161593226412097], [-2.255192816418795, -1.1259185845838522], [-2.255192816418795, -1.1126104809812567]], [0.1442091802842074, 0.1442091802842074, 0.1401931910893844, 0.1401931910893844, 0.1364229833583757, 0.1364229833583757, 0.17479324868163743, 0.17479324868163743, 0.1689562828450787, 0.1689562828450787  …  0.2291312709749451, 0.2291312709749451, 0.2275550001529224, 0.2275550001529224, 0.2275550001529224, 0.2275550001529224, 0.2316242713633889, 0.2316242713633889, 0.2316242713633889, 0.2316242713633889], 1269.622082596527, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-2.262606830698008, -0.7818726062224632], [-2.2629304191540762, -0.7739188333606144], [-2.2629304191540762, -0.8134225193787519], [-2.24071739323388, -0.8404212585571564], [-2.2405647680945204, -0.8239369852869634], [-2.218084243047191, -0.8416109480833909], [-2.212270378140205, -0.8097331350349413], [-2.34976449051207, -0.4315135873717668], [-2.3388884411040385, -0.4715852500734199], [-2.3388884411040385, -0.4081759087429697]  …  [-2.458422738329682, 0.024250297317993663], [-2.457454511208049, 0.04730425290859852], [-2.457454511208049, 0.06654008175841586], [-2.484227040214852, 0.027587492673658343], [-2.484227040214852, 0.052940718831172795], [-2.478424680947037, 0.043507238293630346], [-2.478424680947037, 0.0316039573391369], [-2.480376533335565, 0.0498070555099388], [-2.4777149126150464, 0.040481541473752714], [-2.4777149126150464, 0.06923724813087273]], [0.10788822472683043, 0.10783177401556666, 0.10783177401556666, 0.11174913333618991, 0.11177634508864567, 0.11582819259860565, 0.11689015168289787, 0.0933488244906098, 0.09508974865831449, 0.09508974865831449  …  0.07711084143661122, 0.07724628779364741, 0.07724628779364741, 0.07356184625341837, 0.07356184625341837, 0.07434967861548387, 0.07434967861548387, 0.07408400122515821, 0.07444645482117199, 0.07444645482117199], 1083.9545468552003, nothing, nothing)</code></pre><h2 id="Plotting-the-Results"><a class="docs-heading-anchor" href="#Plotting-the-Results">Plotting the Results</a><a id="Plotting-the-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-the-Results" title="Permalink"></a></h2><p>We can now plot the observations, the smoothed estimate of the position (the mean of the belief at every time step), and the true state. Note that the estimated position is much closer to the true position than the noisy measurements.</p><pre><code class="language-julia hljs">xmat = readdlm(&quot;x.txt&quot;);

plot_data = [(; t, x1=x[1], x2=x[2], y, b_mean=mean(b)[1]) for (t, (x, y, b)) in enumerate(zip(eachslice(xmat; dims=1), ys, bs))]

plot_data |&gt; @vlplot(x = :t, width = 700) +
             @vlplot(:line, y = :x1, color = {datum = &quot;True State&quot;}) +
             @vlplot(:point, y = :y, color = {datum = &quot;Observation&quot;}) +
             @vlplot(:line, y = :b_mean, color = {datum = &quot;Mean Belief&quot;})</code></pre><img src="7fce0a5f.svg" alt="Example block output"/><h2 id="Appendix"><a class="docs-heading-anchor" href="#Appendix">Appendix</a><a id="Appendix-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix" title="Permalink"></a></h2><h3 id="Code-for-Generating-Data"><a class="docs-heading-anchor" href="#Code-for-Generating-Data">Code for Generating Data</a><a id="Code-for-Generating-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Code-for-Generating-Data" title="Permalink"></a></h3><p>The following code can be used to generate the data in the text files:</p><pre><code class="language-julia hljs">rng = MersenneTwister(1)

k = 100
h(x, rng) = x[1] + sigma*randn(rng)

x = [3.0, 0.0]
xs = Array{typeof(x)}(undef, k)
us = zeros(k)
ys = zeros(k)
for t in 1:k
    x = f(x, us[t], rng)
    ys[t] = h(x, rng)
    xs[t] = x
end

using DelimitedFiles
writedlm(&quot;x.txt&quot;, xs)
writedlm(&quot;y.txt&quot;, ys)
writedlm(&quot;u.txt&quot;, us)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sampling/">« Sampling</a><a class="docs-footer-nextpage" href="../example-feedback/">Example: Feedback Control »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Sunday 26 January 2025 21:44">Sunday 26 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
