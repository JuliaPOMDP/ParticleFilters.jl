<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example: Filtering Preexisting Data · ParticleFilters.jl</title><meta name="title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="og:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="twitter:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta name="description" content="Documentation for ParticleFilters.jl."/><meta property="og:description" content="Documentation for ParticleFilters.jl."/><meta property="twitter:description" content="Documentation for ParticleFilters.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ParticleFilters.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../bootstrap/">Bootstrap Filter</a></li><li><a class="tocitem" href="../beliefs/">Beliefs</a></li><li><a class="tocitem" href="../basic/">Basic Particle Filter</a></li><li><a class="tocitem" href="../depletion/">Handling Particle Depletion</a></li><li><a class="tocitem" href="../sampling/">Sampling</a></li><li class="is-active"><a class="tocitem" href>Example: Filtering Preexisting Data</a><ul class="internal"><li><a class="tocitem" href="#Model"><span>Model</span></a></li><li><a class="tocitem" href="#Data"><span>Data</span></a></li><li><a class="tocitem" href="#Filtering"><span>Filtering</span></a></li><li><a class="tocitem" href="#Plotting-the-Results"><span>Plotting the Results</span></a></li><li><a class="tocitem" href="#Appendix"><span>Appendix</span></a></li></ul></li><li><a class="tocitem" href="../example-feedback/">Example: Feedback Control</a></li><li><a class="tocitem" href="../example-pomdps/">Example: Use with POMDPs.jl</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl/blob/master/docs/src/example-filtering.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-Filtering-Preexisting-Data"><a class="docs-heading-anchor" href="#Example:-Filtering-Preexisting-Data">Example: Filtering Preexisting Data</a><a id="Example:-Filtering-Preexisting-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Filtering-Preexisting-Data" title="Permalink"></a></h1><p>In some cases, there is no need to perform control based on the particle belief and instead the goal is to filter a previously-generated sequence of measurements to remove noise or reconstruct hidden state variables. This tutorial will illustrate use of the <code>runfilter</code> function for that purpose.</p><p>First, we import the packages we will use. </p><pre><code class="language-julia hljs">using Distributions
using Random
using DelimitedFiles
using ParticleFilters
using VegaLite</code></pre><h2 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h2><p>We will use <a href="https://en.wikipedia.org/wiki/Euler_method">Euler-integrated</a> <a href="https://en.wikipedia.org/wiki/Van_der_Pol_oscillator">Van Der Pol Oscillator Equations</a> with noise added as the dynamics (<code>f</code>), and measurements of the position with gaussian noise added (the pdf is encoded in <code>g</code>).</p><p>This model is implemented below. For more information on defining models for particle filters, see the <a href="https://juliapomdp.github.io/ParticleFilters.jl/latest/models/">documentation</a>.</p><pre><code class="language-julia hljs">const dt = 0.2
const mu = 0.8
const sigma = 1.0

function f(x, u, rng)
    xdot = [x[2], mu * (1 - x[1]^2) * x[2] - x[1] + u + 0.1 * randn(rng)]
    return x + dt * xdot
end

g(x1, u, x2, y) = pdf(Normal(sigma), y - x2[1])</code></pre><h2 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h2><p>Suppose that the data we would like to filter are contained in text files. <a href="../u.txt"><code>u.txt</code></a> contains the control inputs, and <a href="../y.txt"><code>y.txt</code></a> contains the measurements. The code that generated this data can be found in the <a href="#Appendix">appendix below</a>.</p><pre><code class="language-julia hljs">ys = vec(readdlm(&quot;y.txt&quot;));
us = vec(readdlm(&quot;u.txt&quot;));</code></pre><h2 id="Filtering"><a class="docs-heading-anchor" href="#Filtering">Filtering</a><a id="Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering" title="Permalink"></a></h2><p>We can use an SIR particle filter to get a better estimate of the state. Note that we start with an initial belief consisting of particles with zero velocity and position uniformly distributed in <span>$[-5, 5]$</span>.</p><pre><code class="language-julia hljs">n = 10_000

fil = BootstrapFilter(f, g, n)

# construct initial belief
b0 = ParticleCollection([[10.0 * (rand() - 0.5), 0.0] for i in 1:n])

bs = runfilter(fil, b0, us, ys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100-element Vector{Any}:
 WeightedParticleBelief{Vector{Float64}}([[1.8558239840492952, -0.35284601637646257], [3.9702554257089706, -0.7885092328130802], [4.132193386867959, -0.8153533341582828], [1.8665709464487812, -0.37134077432939144], [-2.089772037861204, 0.41326324132999237], [2.813491497833409, -0.5697965112130373], [-1.7697580355809883, 0.3361104186741267], [0.6428237443616125, -0.11288707516115665], [3.112819383194868, -0.64609888883021], [-1.9248650212516327, 0.35188363790667243]  …  [-4.035365101779349, 0.7824179044759834], [4.813882443800214, -0.9685125955754101], [-2.2622163085864178, 0.45362817289703594], [-1.0595310718422046, 0.18588015787240095], [-2.489230061727948, 0.4944441477996351], [0.4439712675602281, -0.11065666799593687], [-4.5341920369111115, 0.9108577910974921], [-3.3076712734086913, 0.6553977275521832], [3.2244636459474476, -0.5987709402329842], [1.4665689572821017, -0.28323623743641574]], [0.3472960960215329, 0.11308818546784606, 0.08630790922090031, 0.34924686420982404, 1.8109355611962673e-5, 0.3635420851191218, 7.197944491047116e-5, 0.08786143625625821, 0.3055329298722923, 3.73496451512206e-5  …  4.5407119806615123e-10, 0.020754301040729256, 8.25121469959979e-6, 0.0010675708913769626, 2.801631536300447e-6, 0.06095108069078216, 1.6321573646935855e-11, 3.718460007382302e-8, 0.27985672015843815, 0.26228906292555637], 1003.7622511605903, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.7852547807740027, -0.56912537268527], [1.7852547807740027, -0.5774993278031371], [1.7852547807740027, -0.5761466039601658], [3.8125535791463547, 0.32948569242257475], [3.9691227200363026, 0.4605309983548129], [1.7923027915829028, -0.6069058757703351], [1.7923027915829028, -0.5973049488011959], [1.7923027915829028, -0.5983607677866195], [1.7923027915829028, -0.6135592000157247], [2.699532195590802, -0.5021560327317909]  …  [3.565896665407221, 0.0012695193487216594], [3.339019527783623, -0.13288079008736997], [3.339019527783623, -0.13640616461323185], [3.339019527783623, -0.1417162722274442], [3.1047094579008507, -0.3448216139921407], [3.1047094579008507, -0.34033113640628976], [3.1047094579008507, -0.3599232250913036], [1.4099217097948185, -0.5158386858357029], [1.4099217097948185, -0.48503046552588097], [1.4099217097948185, -0.5484391086352463]], [0.39748712769003214, 0.39748712769003214, 0.39748712769003214, 0.06055211171455042, 0.04413353502639196, 0.3977168187888731, 0.3977168187888731, 0.3977168187888731, 0.3977168187888731, 0.28297872902826354  …  0.09482615891504306, 0.13576155799060943, 0.13576155799060943, 0.13576155799060943, 0.18632291223556685, 0.18632291223556685, 0.18632291223556685, 0.3587544592351557, 0.3587544592351557, 0.3587544592351557], 2761.1533529593544, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.6714297062369488, -0.7016059796013174], [1.6714297062369488, -0.6994988736729224], [1.6697549152133753, -0.7357747114065804], [1.6700254599819695, -0.6923304135838849], [3.87845071763087, -1.1317907916212868], [1.6709216164288359, -0.7554803229558558], [1.6728418018226636, -0.7309366252779684], [1.6728418018226636, -0.7392964244923261], [1.6726306380255789, -0.7568205382921325], [1.669590951579758, -0.7724751012758447]  …  [2.3148953720098873, -0.6166695759483901], [2.312321426633759, -0.6358954065973522], [3.566150569276965, -0.7287066601839808], [3.3117382948609766, -0.557335275380199], [3.0357451351024225, -0.4879408015749177], [3.036643230619593, -0.49881462770062834], [1.3067539726276778, -0.719828013590891], [1.3067539726276778, -0.7562020134338936], [1.3129156166896423, -0.6905200968215964], [1.3002338880677693, -0.7479225061880436]], [0.36343987854331267, 0.36343987854331267, 0.3631766657306647, 0.36321924105780173, 0.08251815599096579, 0.363360113889873, 0.3636611613500821, 0.3636611613500821, 0.36362810841378357, 0.36315085245004824  …  0.3901005042520254, 0.3903118551134953, 0.13682064382091264, 0.19219424089435239, 0.25826212903108664, 0.2580458118779053, 0.29051985873460484, 0.29051985873460484, 0.29194348140882304, 0.2890090300053997], 3257.328799060255, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.5311085103166853, -0.8570931365071561], [1.5315299315023643, -0.8147463709457268], [1.5225999729320592, -0.8424288542111456], [1.5315593772651925, -0.830253626510653], [3.6520925593066123, 0.6211062508728808], [1.5198255518376647, -0.8805974242935202], [1.52665447676707, -0.8563895289014254], [1.5249825169241984, -0.823858786630226], [1.5212665303671524, -0.8586570426454294], [1.515095931324589, -0.9143907750564279]  …  [2.1915614568202093, -0.6416840712796119], [2.185142345314288, -0.6560976109197822], [3.420409237240169, -0.0637591734625037], [3.2002712397849367, -0.3483165218885468], [2.938156974787439, -0.4688175067484657], [2.9368803050794674, -0.43710973287160254], [1.1627883699094996, -0.8929580360150876], [1.155513569940899, -0.9453586948277014], [1.174811597325323, -0.8804706407831266], [1.1506493868301606, -0.9123971805814052]], [0.04309084105125963, 0.043052542614330565, 0.04386975337775299, 0.04304986759266534, 5.178234833628189e-5, 0.04412607828714203, 0.04349723677539217, 0.043650553969713075, 0.04399280417200828, 0.04456570797162164  …  0.008600547873777816, 0.008754671968539076, 0.000134343436317985, 0.00031624285041924853, 0.0008227590615259346, 0.0008264607004429239, 0.08757899493606082, 0.08869319985503542, 0.08575817285469463, 0.08944345178540188], 430.58220128170825, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.359689883015254, -0.9843659045225995], [1.3685806573132189, -0.903086125825398], [1.35411420208983, -0.9904257721088403], [1.365508651963062, -0.9851317252109199], [1.3437060669789607, -0.9754596562188736], [1.3553765709867849, -0.9680379866528865], [1.3602107595981532, -0.9641525402603268], [1.3495351218380665, -0.9735194718456106], [1.3322177763133034, -1.024360487998963], [1.335582927558891, -1.0081691667350376]  …  [2.1717087030033673, -0.6687060264847577], [2.063224642564287, -0.67570292845337], [0.984196762706482, -1.101850263103095], [0.984196762706482, -1.0948620574313028], [0.9664418309753586, -1.124133247155656], [0.9664418309753586, -1.166884786504322], [0.9987174691686977, -1.0804506692311242], [0.9987174691686977, -1.0260287100078915], [0.9681699507138796, -1.0829379319554764], [0.9681699507138796, -1.106901431853871]], [0.3194350608617468, 0.32132150692678696, 0.31824483156936956, 0.32067129799514155, 0.3160085944065749, 0.31851478508324893, 0.3195459710535207, 0.31726328562409556, 0.31351908482417534, 0.31425056934510154  …  0.3947536716915553, 0.3986721327613993, 0.23176058768310004, 0.23176058768310004, 0.22747553982482188, 0.22747553982482188, 0.2352698710461545, 0.2352698710461545, 0.22789226303814644, 0.22789226303814644], 2234.3671044223297, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.162816702110734, -1.0961078160820747], [1.1879634321481394, -1.0559713438030753], [1.1879634321481394, -1.06942844596487], [1.156029047668062, -1.128342799801355], [1.168482306920878, -1.1171247910896178], [1.148614135735186, -1.096269275708139], [1.148614135735186, -1.0855133128475343], [1.1617689736562076, -1.144332277504705], [1.1673802515460878, -1.1076892948008232], [1.1673802515460878, -1.1101427126734646]  …  [1.928084056873613, -0.7230847548167798], [0.763826710085863, -1.3317962743545193], [0.763826710085863, -1.3262037764627608], [0.7652243512202215, -1.2963525924879777], [0.7416151815442275, -1.3385206463973738], [0.7330648736744942, -1.355346225682844], [0.7826273353224729, -1.2888459364613714], [0.7935117271671195, -1.2341920952021574], [0.7515823643227842, -1.2857395287031117], [0.7467896643431053, -1.3335704163119753]], [0.173669398679808, 0.1793374178334186, 0.1793374178334186, 0.1721517592680814, 0.17494022886838845, 0.1705000475551125, 0.1705000475551125, 0.1734347902252262, 0.17469274392751682, 0.17469274392751682  …  0.3476867247375723, 0.09586869720151932, 0.09586869720151932, 0.09609513822515213, 0.09231664416745929, 0.09097267275662892, 0.09894372130816102, 0.10075257047469123, 0.09389974302959146, 0.09313630784152804], 1488.8184395228004, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.9435951388943191, -1.2511171008642794], [0.9767691633875243, -1.2183430809881863], [0.9740777429551654, -1.2141823032932435], [0.9303604877077909, -1.2897262153032962], [0.9303604877077909, -1.2456401628970708], [0.9450573487029545, -1.2840814252082011], [0.9293602805935582, -1.250628946713713], [0.9315114731656792, -1.266878976127258], [0.9329025181552666, -1.287099015231499], [0.9458423925859232, -1.270359577507362]  …  [1.900050407900476, -0.7481334553505721], [1.900050407900476, -0.7424263802866359], [1.7834671059102571, -0.7810983933108301], [1.7834671059102571, -0.7743600495978726], [0.4974674552149591, -1.5644354650766374], [0.5059538327226258, -1.5521336472731375], [0.47391105226475266, -1.5926559150902173], [0.5248581480301986, -1.5133825059903934], [0.546673308126688, -1.4710046487558286], [0.4800755810807103, -1.5967004821509614]], [0.3974394022244125, 0.39607753217028446, 0.39620409927138117, 0.39786181826566847, 0.39786181826566847, 0.39738848982623987, 0.39789092798953757, 0.39782783046068815, 0.3977860544365779, 0.3973608077164896  …  0.23149078385095734, 0.23149078385095734, 0.2596617889775729, 0.2596617889775729, 0.37401209536925006, 0.37514057400892226, 0.3707574804421307, 0.37756887080481544, 0.380221699749479, 0.37162636301024987], 3467.3704971367993, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.6933717187214632, -1.4433360702776807], [0.733100547189887, -1.4511098096934565], [0.7312412822965166, -1.4480537433922271], [0.6724152446471316, -1.4837530225614302], [0.6812324551283767, -1.477624886783581], [0.6882410636613143, -1.4939915251712816], [0.6792344912508157, -1.4720205459426008], [0.6781356779402276, -1.4820906478659626], [0.6754827151089668, -1.485397859109941], [0.6917704770844508, -1.5044900912365269]  …  [1.7504237168303616, -0.8261665016498145], [1.7515651318431489, -0.8414464895982804], [1.6272474272480912, -0.8267143024836324], [1.6285950959906825, -0.8694914203792516], [0.1845803621996316, -1.8784016898283495], [0.19552710326799833, -1.8387915409348277], [0.15537986924670916, -1.899769598419576], [0.22218164683211988, -1.7899884358911773], [0.2524723783755223, -1.7133777928313059], [0.160735484650518, -1.8936732983933908]], [0.3486890574124283, 0.35567139284116317, 0.35535404028021134, 0.3448420082802493, 0.34647395515089907, 0.3477573750681369, 0.34610584128834193, 0.3459029691806794, 0.34541192799296694, 0.3483990027023691  …  0.34516439421809736, 0.34495222148216265, 0.3660318601100595, 0.3658268890795698, 0.23526840088332815, 0.23791586650660315, 0.22821567830704134, 0.24436502932221546, 0.25168929220903047, 0.22950783822027898], 3266.4166801514893, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.40470450466592706, -1.6985055940773042], [0.4428785852511957, -1.7185440149583924], [0.4416305336180712, -1.7209022964274743], [0.37566464013484563, -1.7474058481097483], [0.3857074777716605, -1.770869188207485], [0.38944275862705796, -1.7284503653502898], [0.38483038206229553, -1.7738615424651833], [0.38171754836703503, -1.7695291119472822], [0.3784031432869786, -1.7555884727451985], [0.39087245883714544, -1.7937728900744911]  …  [1.5851904165003987, -0.9229233599836081], [1.583275833923493, -0.8948739441693336], [1.4619045667513648, -0.9321342093865808], [1.4546968119148322, -0.9867242280035394], [-0.19109997576603832, -2.1708233314340784], [-0.1722312049189672, -2.1646589734080557], [-0.22457405043720607, -2.24375991886134], [-0.1358160403461156, -2.085285234854288], [-0.09020318019073892, -2.030849857308584], [-0.21799917502816019, -2.2259442388212953]], [0.2325577640961169, 0.22335226067075942, 0.22365253410186178, 0.2395799307442781, 0.23715041511117407, 0.23624701354865985, 0.2373625665351359, 0.23811555151067434, 0.2389173771109725, 0.23590127183058332  …  0.03398549804255649, 0.03413015518786578, 0.044343034299095224, 0.04501690037007574, 0.3616369313835966, 0.35856203410163817, 0.36683545826864977, 0.35234661460438343, 0.34406881084315427, 0.3658408652346305], 2045.8210852289878, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.06500338585046622, -2.0028631498895777], [0.09916978225951723, -2.0275412111517017], [0.0974500743325763, -2.0098820628106657], [0.026183470512895934, -2.042953718371195], [0.031533640130163465, -2.0750464700003737], [0.04375268555699996, -2.0498908675759315], [0.04375268555699996, -2.017221433405874], [0.030058073569258825, -2.0672246520572397], [0.027811725977578583, -2.095888251509315], [0.027285448737938867, -2.063625821109138]  …  [-0.625264642052854, -2.495966505638032], [-0.6051629996005783, -2.5065634577262657], [-0.6051629996005783, -2.455936591462006], [-0.6733260342094741, -2.512156936356451], [-0.6733260342094741, -2.5318569872381076], [-0.5528730873169732, -2.397424532238813], [-0.49637315165245577, -2.3401709390261782], [-0.49637315165245577, -2.3062160829130787], [-0.6631880227924193, -2.5238542400995017], [-0.6631880227924193, -2.5081320534405056]], [0.3924082030147244, 0.39462196220518, 0.39452124523365734, 0.3893560170843093, 0.3898101552560267, 0.39080737986338543, 0.39080737986338543, 0.3896859659041107, 0.38949535238634847, 0.38945042454841444  …  0.2727677295034931, 0.2775350730451328, 0.2775350730451328, 0.2612704076391409, 0.2612704076391409, 0.28978119394494617, 0.302689675036154, 0.302689675036154, 0.2637052934084077, 0.2637052934084077], 3232.7863715775675, nothing, nothing)
 ⋮
 WeightedParticleBelief{Vector{Float64}}([[0.8768600003767951, -1.3764394791187708], [0.7626708981240431, -1.420330414185437], [0.8047282006026862, -1.383853295228973], [0.9348778745067368, -1.3230248327095302], [0.6828862659951191, -1.5553262833448065], [0.8408911610636562, -1.3466439839964017], [0.595593866028985, -1.6872569435661455], [0.8074976538066716, -1.4123765895469331], [1.0434630893354613, -1.2054456395066564], [0.9312818673643495, -1.3393552353888223]  …  [0.8670331439478891, -1.3909192355366877], [0.7139046485994391, -1.5111015481329886], [0.8472285496671543, -1.4209392046344809], [0.8141624920314211, -1.3753819804980398], [0.6979734663723894, -1.4855845888953025], [0.7251240815914062, -1.4818965320601596], [0.908202728577611, -1.275861933563876], [0.8407231232564174, -1.362312627528215], [0.6113240944632452, -1.6200171994427404], [0.757135371131608, -1.4782190752449995]], [0.36734850101489835, 0.34841906525785515, 0.35581409730338603, 0.3754764483287666, 0.3331866473606954, 0.36178604156805505, 0.3149773854862558, 0.3562844123621997, 0.38765258987534507, 0.37500417510352324  …  0.3658673663903309, 0.33928439636087704, 0.36279401019080937, 0.35740756394307477, 0.33617915182350416, 0.34143643465126816, 0.3718727510145608, 0.36175915538697107, 0.3183627247054925, 0.347411490098514], 3859.6422546071076, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.6015721045530409, -1.6069521300669554], [0.4786048152869557, -1.6865734293187724], [0.5279575415568916, -1.6487055151356844], [0.6702729079648306, -1.5032706661524378], [0.3718210093261578, -1.8421968385112089], [0.5715623642643759, -1.5782242700265772], [0.2581424773157559, -1.96282026911484], [0.525022335897285, -1.666355252815698], [0.80237396143413, -1.400170781473786], [0.6634108202865849, -1.5603589313256103]  …  [0.5888492968405515, -1.6165791990723686], [0.4116843389728414, -1.7378917769822253], [0.5630407087402581, -1.639129520307334], [0.5390860959318131, -1.6132864726054543], [0.4008565485933289, -1.7307905692364947], [0.42874477517937426, -1.7279775893774638], [0.6530303418648358, -1.4939902962264744], [0.5682605977507744, -1.6345964925150978], [0.28732065457469713, -1.9370072411922685], [0.4614915560826081, -1.7438147553022452]], [0.3740834274022493, 0.3552452023792885, 0.36334860082129805, 0.3825130948634252, 0.33551648760898284, 0.36991144198753223, 0.311784995707849, 0.36288625026503835, 0.39399909265607386, 0.38174362585033106  …  0.3723499191166037, 0.343207334539078, 0.3686747249117249, 0.3650783459666295, 0.3411546767063173, 0.34638421135836944, 0.38054851064535583, 0.3694349605739682, 0.318103062208029, 0.3522773147997565], 3912.001151585218, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.2801816785396498, -1.8963158592979084], [0.14129012942320118, -2.0139379571609934], [0.19821643852975468, -1.9702068585636676], [0.36961877473434307, -1.7759219144273266], [0.0033816416239160207, -2.174649589107564], [0.25591751025906045, -1.8636101930740252], [-0.1344215765072121, -2.314507889528265], [0.19175128533414537, -1.967661129615829], [0.5223398051393728, -1.6514731159215743], [0.3513390340214628, -1.8053249222113312]  …  [0.2655334570260778, -1.9066477879769943], [0.0641059835763963, -2.044632041890771], [0.2352148046787913, -1.944569718544952], [0.21642880141072224, -1.9282752529439857], [0.05469843474602998, -2.065871270663175], [0.08314925730388145, -2.0380855561238067], [0.3542322826195409, -1.742257486854443], [0.24134129924775483, -1.9145278655541957], [-0.1000807936637566, -2.274384629199627], [0.11272860502215903, -2.0583152845396486]], [0.11405814642741345, 0.09067403067591352, 0.09984725319631055, 0.1308747230475695, 0.0708362598398729, 0.10972932370459143, 0.05430750979943331, 0.09877650878547174, 0.16248675366192494, 0.1273298791892264  …  0.1114326857408715, 0.0791567722806514, 0.10611660733555169, 0.10290323030349242, 0.07782526891229825, 0.08190002145790796, 0.12788732662298924, 0.10717792301639702, 0.05812837883554536, 0.08628867452420172], 1609.940626757102, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.09908149331993188, -2.237563108376465], [-0.26149746200899754, -2.361779224363002], [-0.1958249331829789, -2.300448785671154], [0.014434391848877737, -2.045439811353066], [-0.43154827619759684, -2.4982472026639506], [-0.11680452835574462, -2.217984033001622], [-0.5973231544128652, -2.632785159303949], [-0.20178094058902046, -2.30323465605775], [0.19204518195505793, -1.9294312935787379], [-0.00972595042080343, -2.108802478623095]  …  [-0.1157961005693211, -2.243393686884507], [-0.3448204248017579, -2.4077496595129104], [-0.1536991390301991, -2.2884819523150672], [-0.16922624917807494, -2.260543723786353], [-0.35847581938660505, -2.4000875400399657], [-0.3244678539208799, -2.34835054931329], [0.005780785248652276, -2.063213339883414], [-0.14156427386308434, -2.23977858317158], [-0.5549577195036821, -2.6365827632284975], [-0.2989344518857707, -2.4162561982209354]], [0.21663685587718665, 0.2558303851104851, 0.23995502013629358, 0.18986932938342135, 0.29599891601904565, 0.22088687412508212, 0.3318536318898388, 0.24139615411061896, 0.15052491028341014, 0.19548541695032598  …  0.2206446889240306, 0.2757758418368982, 0.2297719908140262, 0.2335222773632971, 0.27900499725546996, 0.270938423925181, 0.19187494860104373, 0.22684493974934092, 0.32314071323396704, 0.26483425611302985], 1555.7333074594426, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.5465941149952249, -2.5770671196404358], [-0.733853306881598, -2.6633560685938025], [-0.6559146903172097, -2.559321165507106], [-0.3946535704217355, -2.3826619184451925], [-0.931197716730387, -2.750672797061241], [-0.560401334956069, -2.545955654551987], [-1.123880186273655, -2.779975531465141], [-0.6624278718005705, -2.6286750497734372], [-0.19384107676068968, -2.2851409319344236], [-0.4314864461454224, -2.4426696011033826]  …  [-0.5644748379462226, -2.5926969585975925], [-0.82637035670434, -2.665613126164335], [-0.6113955294932125, -2.646306657086625], [-0.6213349939353455, -2.5910035686584534], [-0.8384933273945983, -2.7098750249498442], [-0.794137963783538, -2.6133065414483196], [-0.40686188272803053, -2.4236295943690878], [-0.5895199904974004, -2.576546507001298], [-1.0822742721493817, -2.7945642190966167], [-0.7821856915299579, -2.71445450582517]], [0.31669077603778356, 0.35341532805100284, 0.33908086495864465, 0.2823457483851531, 0.3819621189072675, 0.31964568240614133, 0.39686186350352126, 0.34033532619205686, 0.23415816369092773, 0.2909292361996806  …  0.32051104234975125, 0.3683041493486579, 0.3302538872238872, 0.3322615774387177, 0.37006623205105205, 0.3633999840849254, 0.28520519271760203, 0.3257644551824813, 0.3948350780887879, 0.36150261836067565], 2398.3823509433582, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.0620075389233121, -2.7916543350271934], [-1.2665245206003584, -2.7353516507992293], [-1.167778923418631, -2.673042569682958], [-0.871185954110774, -2.6114609946429392], [-1.481332276142635, -2.6528738415788067], [-1.0695924658664664, -2.7338316574901134], [-1.6798752925666833, -2.4849843644991623], [-1.1881628817552579, -2.719503839455331], [-0.6508692631475744, -2.5647031318804436], [-0.920020366366099, -2.688682589477901]  …  [-1.083014229665741, -2.780035941503045], [-1.359492981937207, -2.635476947761253], [-1.1406568609105374, -2.805296864768538], [-1.1395357076670363, -2.725222870865146], [-1.380468332384567, -2.67982099064474], [-1.3167992720732018, -2.622928950234255], [-0.8915878016018481, -2.669259291428905], [-1.1048292918976599, -2.718715363831657], [-1.641187115968705, -2.504391085958658], [-1.325076592694992, -2.7083658083788045]], [0.3251497771287526, 0.2793785048296777, 0.302186069502972, 0.36072829115306937, 0.2277339142837131, 0.3235669349941666, 0.1809517182712614, 0.2975677715002137, 0.3886674537900234, 0.35248843086910536  …  0.32073968518724316, 0.25717881316801666, 0.3082436666075108, 0.3084917841429409, 0.2521177828991146, 0.26743244872024347, 0.35736633905507204, 0.31607552000672706, 0.18983023837717974, 0.26545086397688994], 3781.3373740419147, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.620338405928751, -2.5128075570376907], [-1.8135948507602042, -2.1970420093343903], [-1.7023874373552226, -2.270266217944383], [-1.393478153039362, -2.5209972966992846], [-2.0119070444583964, -1.8159176530413785], [-1.616358797364489, -2.480734526476695], [-2.176872165466516, -1.446022482373008], [-1.732063649646324, -2.319678901289011], [-1.1638098895236633, -2.6699538028510243], [-1.4577568842616793, -2.5827429479179402]  …  [-1.63902141796635, -2.51219289641111], [-1.8865883714894576, -2.005293508864384], [-1.701716233864245, -2.465675331196102], [-1.6845802818400655, -2.325506075892799], [-1.916432530513515, -2.073891143080531], [-1.841385062120053, -2.0428447794890974], [-1.425439659887629, -2.5642331717952667], [-1.6485723646639912, -2.39536600748903], [-2.1420653331604367, -1.487340086072489], [-1.866749754370753, -2.1109596393997276]], [0.14756032597114183, 0.19020971546205248, 0.16510654814026313, 0.1044330430579146, 0.2374205248488719, 0.14673326582508373, 0.27707654480950944, 0.17166937253304185, 0.06983611335233017, 0.1157832252915403  …  0.15147379180677642, 0.20732860827994973, 0.1649593713132828, 0.16122142757756097, 0.21443467458062443, 0.1966774504739814, 0.10998718793206934, 0.15349361806338663, 0.2688002437844984, 0.2026358160835456], 791.698680704139, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-2.122899917336289, -1.5463931650016636], [-2.122899917336289, -1.527598282280128], [-2.2530032526270825, -1.0287215843306023], [-2.2530032526270825, -1.041892256569065], [-2.1564406809440992, -1.2520874537265785], [-2.1564406809440992, -1.2316506824528606], [-1.8976776123792192, -1.8635464259182895], [-1.8976776123792192, -1.8751370178318303], [-2.375090575066672, -0.5081972042338836], [-2.375090575066672, -0.5621419813630824]  …  [-2.2499540180178723, -0.9098629397072273], [-1.9382862942466823, -1.8624435139504443], [-2.1276455661617972, -1.3924947872665847], [-2.1276455661617972, -1.4345315486472772], [-2.4395333503749344, -0.20354948604142442], [-2.4395333503749344, -0.20067493117258062], [-2.4395333503749344, -0.22159236370557034], [-2.2889416822506985, -0.9326989431120027], [-2.2889416822506985, -0.9105545586773218], [-2.2889416822506985, -0.9169581478722744]], [0.20001908590640005, 0.20001908590640005, 0.231095465940258, 0.231095465940258, 0.20794285530819534, 0.20794285530819534, 0.14966455811239796, 0.14966455811239796, 0.2605921075758223, 0.2605921075758223  …  0.23035921071083162, 0.1582911914775166, 0.20113534459756358, 0.20113534459756358, 0.2759868870031621, 0.2759868870031621, 0.2759868870031621, 0.23978432047691703, 0.23978432047691703, 0.23978432047691703], 1381.6366876251184, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-2.432178550336622, -0.2976464144973998], [-2.428419573792315, -0.26690249125671905], [-2.458747569493203, 0.0918253218125702], [-2.4613817039408956, 0.15671814183488464], [-2.406858171689415, -0.09885323242574073], [-2.4027708174346714, -0.07624867033376148], [-2.270386897562877, -0.7147907162183518], [-2.2727050159455855, -0.7351440215591003], [-2.476730015913449, 0.3207107249375448], [-2.4875189713392887, 0.3380130047172464]  …  [-2.4319266059593176, 0.1373411858430611], [-2.3107749970367712, -0.6527134530546574], [-2.406144523615114, -0.17370615569351333], [-2.4145518758912528, -0.19226344722149125], [-2.4802432475832195, 0.44436773461378976], [-2.4796683366094503, 0.4549153552514258], [-2.4838518231160482, 0.4522568792288557], [-2.475481470873099, 0.14432031419506708], [-2.4710525939861627, 0.14935793319178403], [-2.472333311825153, 0.19608410542346033]], [0.0808407765996395, 0.08138500078985773, 0.07706543748829739, 0.0766979330373306, 0.08455510957101352, 0.0851653756913832, 0.10653603563546082, 0.10613518710494382, 0.07458089097545181, 0.07311749750543423  …  0.08087717475114727, 0.09968712277903215, 0.08466144736833836, 0.08341445130206182, 0.07410212222521724, 0.07418032053619694, 0.07361261398639887, 0.07475155930258873, 0.07535916766951564, 0.07518310861337917], 1141.8438914305493, nothing, nothing)</code></pre><h2 id="Plotting-the-Results"><a class="docs-heading-anchor" href="#Plotting-the-Results">Plotting the Results</a><a id="Plotting-the-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-the-Results" title="Permalink"></a></h2><p>We can now plot the observations, the smoothed estimate of the position (the mean of the belief at every time step), and the true state. Note that the estimated position is much closer to the true position than the noisy measurements.</p><pre><code class="language-julia hljs">xmat = readdlm(&quot;x.txt&quot;);

plot_data = [(; t, x1=x[1], x2=x[2], y, b_mean=mean(b)[1]) for (t, (x, y, b)) in enumerate(zip(eachslice(xmat; dims=1), ys, bs))]

plot_data |&gt; @vlplot(x = :t, width = 700) +
             @vlplot(:line, y = :x1, color = {datum = &quot;True State&quot;}) +
             @vlplot(:point, y = :y, color = {datum = &quot;Observation&quot;}) +
             @vlplot(:line, y = :b_mean, color = {datum = &quot;Mean Belief&quot;})</code></pre><img src="356e4e36.svg" alt="Example block output"/><h2 id="Appendix"><a class="docs-heading-anchor" href="#Appendix">Appendix</a><a id="Appendix-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix" title="Permalink"></a></h2><h3 id="Code-for-Generating-Data"><a class="docs-heading-anchor" href="#Code-for-Generating-Data">Code for Generating Data</a><a id="Code-for-Generating-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Code-for-Generating-Data" title="Permalink"></a></h3><p>The following code can be used to generate the data in the text files:</p><pre><code class="language-julia hljs">rng = MersenneTwister(1)

k = 100
h(x, rng) = x[1] + sigma*randn(rng)

x = [3.0, 0.0]
xs = Array{typeof(x)}(undef, k)
us = zeros(k)
ys = zeros(k)
for t in 1:k
    x = f(x, us[t], rng)
    ys[t] = h(x, rng)
    xs[t] = x
end

using DelimitedFiles
writedlm(&quot;x.txt&quot;, xs)
writedlm(&quot;y.txt&quot;, ys)
writedlm(&quot;u.txt&quot;, us)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sampling/">« Sampling</a><a class="docs-footer-nextpage" href="../example-feedback/">Example: Feedback Control »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Saturday 26 April 2025 16:23">Saturday 26 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
