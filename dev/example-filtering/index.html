<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example: Filtering Preexisting Data · ParticleFilters.jl</title><meta name="title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="og:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="twitter:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta name="description" content="Documentation for ParticleFilters.jl."/><meta property="og:description" content="Documentation for ParticleFilters.jl."/><meta property="twitter:description" content="Documentation for ParticleFilters.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ParticleFilters.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../bootstrap/">Bootstrap Filter</a></li><li><a class="tocitem" href="../beliefs/">Beliefs</a></li><li><a class="tocitem" href="../basic/">Basic Particle Filter</a></li><li><a class="tocitem" href="../depletion/">Handling Particle Depletion</a></li><li><a class="tocitem" href="../sampling/">Sampling</a></li><li class="is-active"><a class="tocitem" href>Example: Filtering Preexisting Data</a><ul class="internal"><li><a class="tocitem" href="#Model"><span>Model</span></a></li><li><a class="tocitem" href="#Data"><span>Data</span></a></li><li><a class="tocitem" href="#Filtering"><span>Filtering</span></a></li><li><a class="tocitem" href="#Plotting-the-Results"><span>Plotting the Results</span></a></li><li><a class="tocitem" href="#Appendix"><span>Appendix</span></a></li></ul></li><li><a class="tocitem" href="../example-feedback/">Example: Feedback Control</a></li><li><a class="tocitem" href="../example-pomdps/">Example: Use with POMDPs.jl</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl/blob/master/docs/src/example-filtering.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-Filtering-Preexisting-Data"><a class="docs-heading-anchor" href="#Example:-Filtering-Preexisting-Data">Example: Filtering Preexisting Data</a><a id="Example:-Filtering-Preexisting-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Filtering-Preexisting-Data" title="Permalink"></a></h1><p>In some cases, there is no need to perform control based on the particle belief and instead the goal is to filter a previously-generated sequence of measurements to remove noise or reconstruct hidden state variables. This tutorial will illustrate use of the <code>runfilter</code> function for that purpose.</p><p>First, we import the packages we will use. </p><pre><code class="language-julia hljs">using Distributions
using Random
using DelimitedFiles
using ParticleFilters
using VegaLite</code></pre><h2 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h2><p>We will use <a href="https://en.wikipedia.org/wiki/Euler_method">Euler-integrated</a> <a href="https://en.wikipedia.org/wiki/Van_der_Pol_oscillator">Van Der Pol Oscillator Equations</a> with noise added as the dynamics (<code>f</code>), and measurements of the position with gaussian noise added (the pdf is encoded in <code>g</code>).</p><p>This model is implemented below. For more information on defining models for particle filters, see the <a href="https://juliapomdp.github.io/ParticleFilters.jl/latest/models/">documentation</a>.</p><pre><code class="language-julia hljs">const dt = 0.2
const mu = 0.8
const sigma = 1.0

function f(x, u, rng)
    xdot = [x[2], mu * (1 - x[1]^2) * x[2] - x[1] + u + 0.1 * randn(rng)]
    return x + dt * xdot
end

g(x1, u, x2, y) = pdf(Normal(sigma), y - x2[1])</code></pre><h2 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h2><p>Suppose that the data we would like to filter are contained in text files. <a href="../u.txt"><code>u.txt</code></a> contains the control inputs, and <a href="../y.txt"><code>y.txt</code></a> contains the measurements. The code that generated this data can be found in the <a href="#Appendix">appendix below</a>.</p><pre><code class="language-julia hljs">ys = vec(readdlm(&quot;y.txt&quot;));
us = vec(readdlm(&quot;u.txt&quot;));</code></pre><h2 id="Filtering"><a class="docs-heading-anchor" href="#Filtering">Filtering</a><a id="Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering" title="Permalink"></a></h2><p>We can use an SIR particle filter to get a better estimate of the state. Note that we start with an initial belief consisting of particles with zero velocity and position uniformly distributed in <span>$[-5, 5]$</span>.</p><pre><code class="language-julia hljs">n = 10_000

fil = BootstrapFilter(f, g, n)

# construct initial belief
b0 = ParticleCollection([[10.0 * (rand() - 0.5), 0.0] for i in 1:n])

bs = runfilter(fil, b0, us, ys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100-element Vector{Any}:
 WeightedParticleBelief{Vector{Float64}}([[-0.34260608460339625, 0.020723705137489785], [-2.6371604480130815, 0.49241940302240866], [2.8180120686749452, -0.5374160927083443], [4.751438226718245, -0.9462796007871015], [3.8074050929536583, -0.7593475409089678], [0.3275886139541939, -0.0669983161556329], [-1.464105984387294, 0.30518242597750583], [-2.6368473817557883, 0.519885437734446], [-3.5505493968994752, 0.7550845890781077], [-2.517345793429234, 0.46830270992051065]  …  [3.5014596706442425, -0.6741178729049667], [2.979405540913426, -0.5471981216737118], [-2.5409885733504876, 0.5254065203069634], [-2.1543386968344147, 0.4358903552347846], [1.752716535588259, -0.340143944864259], [-4.659243481174843, 0.9091191381532862], [1.098420280186082, -0.1835103646317633], [4.552360893837014, -0.9808013557298555], [3.058697410152348, -0.587335333950686], [0.968966003807753, -0.21871872630025588]], [0.009737638680562063, 1.3479686007971123e-6, 0.36283059761519465, 0.024110227630622347, 0.14453059892167086, 0.04831297292080243, 0.00024439441880063257, 1.35008847018939e-6, 9.064874082006793e-9, 2.4420488056897715e-6  …  0.21329260603628686, 0.3338215372536688, 2.174316483707288e-6, 1.3539228900953825e-5, 0.3271990339040105, 6.819181964525132e-12, 0.17495345420911196, 0.03788074197509195, 0.31738797623174825, 0.14692534699853954], 1001.6642708524222, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[2.7105288501332763, -0.46069675290458356], [2.7105288501332763, -0.4826079572554282], [2.7105288501332763, -0.5224972140955668], [2.7105288501332763, -0.5199137967663121], [3.6555355847718647, 0.1661302102964013], [3.6555355847718647, 0.10478257999471563], [4.479572249571869, 1.32867925571143], [3.3139937305307634, -0.16304128861175526], [3.3139937305307634, -0.17085678428379847], [4.34843368576701, 1.0811508700473524]  …  [1.6846877466154073, -0.5877272151573886], [1.6846877466154073, -0.5982330920162617], [1.6846877466154073, -0.5874549685072301], [1.6846877466154073, -0.5766099914183958], [1.0617182072597293, -0.42860358628694895], [4.356200622691043, 1.198282493776873], [2.9412303433622107, -0.4219801948201797], [2.9412303433622107, -0.43741077843014464], [2.9412303433622107, -0.35540365894426573], [0.9252222585477018, -0.4309466753897836]], [0.28039445248470274, 0.28039445248470274, 0.28039445248470274, 0.28039445248470274, 0.08113188819173317, 0.08113188819173317, 0.013274223686508636, 0.14079877165585347, 0.14079877165585347, 0.01852911773955333  …  0.392096623647197, 0.392096623647197, 0.392096623647197, 0.392096623647197, 0.2875956366427258, 0.018175403131760796, 0.22494279847476348, 0.22494279847476348, 0.22494279847476348, 0.2551396778953841], 2744.6767281557127, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[2.6183894995523596, -0.5443431771117194], [2.6140072586821907, -0.5243273292132882], [2.6060294073141628, -0.6097131271120158], [2.606546090780014, -0.5569917796806364], [3.281385472808412, -0.5612191976124392], [4.564663859776481, -2.864015733923092], [0.5135454541836338, -0.35125295802480844], [2.3469217811888754, -0.6249261751169426], [2.3406818758859975, -0.6053254070747477], [2.34380076221634, -0.6125866809550566]  …  [1.5671423035839296, -0.7271173939062927], [1.565041128212155, -0.7415233437891098], [1.5671967529139612, -0.7314956400302755], [1.5671967529139612, -0.7501280744778811], [1.5693657483317283, -0.7777907067451305], [0.9759974900023395, -0.5979149200826245], [2.8568343043981748, -0.47809479817818057], [2.8537481876761817, -0.5074259776178532], [2.8701496115733574, -0.5177321546710324], [0.8390329234697451, -0.6129796285326362]], [0.3493571602715445, 0.35014346274941793, 0.35156213583019347, 0.3514707594778962, 0.19928363895123544, 0.019285585290194564, 0.1127702469353522, 0.38726568582526466, 0.38784759278836806, 0.38755851579519623  …  0.3455544240104633, 0.34516468222150476, 0.34556450924891285, 0.34556450924891285, 0.34596566115601246, 0.2113572718695422, 0.30031053981566636, 0.3010084039254093, 0.2972855856524517, 0.17943026476668095], 3240.0463587741397, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[2.5095208641300157, -0.5690004009649671], [2.509141792839533, -0.5533680396957523], [2.48408678189176, -0.5309220362237065], [2.495147734843887, -0.5807242025724452], [3.1691416332859244, -0.30909986642626225], [3.991860712991862, 5.298081244276906], [0.4432948625786721, -0.5119982265267278], [2.221936546165487, -0.6220633002005127], [2.219616794471048, -0.6414832960207759], [2.221283426025329, -0.6512904558068554]  …  [1.421718824802671, -0.8675736978880295], [1.416736459454333, -0.8813768382630465], [1.4208976249079062, -0.874664300399867], [1.417171138018385, -0.9041617895342893], [1.4138076069827021, -0.8962490562390373], [0.8564145059858146, -0.8109083979668951], [2.7612153447625385, -0.5033408988321273], [2.752262992152611, -0.5356769051179757], [2.7666031806391507, -0.476280486076075], [0.7164369977632179, -0.8057836461575411]], [0.003388770522849118, 0.0033927396009806993, 0.0036644861138972417, 0.003542208244637769, 0.0003555485231543789, 1.1609944875450964e-5, 0.23666547961198678, 0.007902819989625005, 0.007954307402991556, 0.007917286647335051  …  0.0539529011173222, 0.05449263418619264, 0.05404158358542213, 0.05444538563775507, 0.054811794339603016, 0.14247049809486775, 0.0015091108581343148, 0.0015548515525644529, 0.0014821764300012921, 0.17246814967843252], 439.4061413812557, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.34089521727332656, -0.640885616380334], [0.34089521727332656, -0.6554437094733695], [0.34089521727332656, -0.7189266770338468], [0.34089521727332656, -0.669644868375406], [0.34089521727332656, -0.6142108300245125], [0.34089521727332656, -0.6877247834359588], [2.0957851668039873, -0.6794809636321035], [0.982285640834454, -1.0470430461404718], [0.982285640834454, -1.0805250862845721], [0.9617237600755115, -1.1259931811091721]  …  [1.236338780111527, -0.9994822445569762], [1.236338780111527, -1.039963414785157], [1.2345577957348945, -1.0231192954368877], [0.6942328263924356, -0.9969209376165598], [0.6942328263924356, -1.0077730062954435], [0.6942328263924356, -1.0009857724273283], [0.5552802685317096, -1.0085630303401718], [0.5552802685317096, -1.0186104331230976], [0.5552802685317096, -0.986080185107499], [0.5552802685317096, -0.9848866912051244]], [0.09638247087607385, 0.09638247087607385, 0.09638247087607385, 0.09638247087607385, 0.09638247087607385, 0.09638247087607385, 0.3979835996244091, 0.23129900153634397, 0.23129900153634397, 0.22633824636094615  …  0.29198565881656907, 0.29198565881656907, 0.29157462717345867, 0.16426138474865776, 0.16426138474865776, 0.16426138474865776, 0.13519181439535113, 0.13519181439535113, 0.13519181439535113, 0.13519181439535113], 2219.7860645945084, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.19710988186655717, -0.874921114132181], [0.21805305126842406, -0.7744300678921388], [1.9598889740775667, -0.7434950836009845], [1.9598889740775667, -0.7148885231937603], [0.7728770316063597, -1.2365936054711206], [0.7661806235775396, -1.282494156881499], [0.7365251238536771, -1.308989432877076], [0.7311661609322709, -1.3700196236050803], [0.7337109232748975, -1.361849005253231], [0.7313900699445166, -1.3704294252892906]  …  [1.0499620173884274, -1.1114689572754852], [1.0364423312001319, -1.180630011056355], [1.0283460971544955, -1.1941070178672257], [1.0283460971544955, -1.2084995230094822], [1.029933936647517, -1.176067955111256], [0.49484863886912356, -1.2342069183720927], [0.49403567190696984, -1.2161783236117434], [0.35356766246367527, -1.2234440060644447], [0.35806423151020983, -1.18308909222484], [0.3583029302906847, -1.1750343271105217]], [0.031355396983424336, 0.032864809566850055, 0.3533558503752728, 0.3533558503752728, 0.09734114356746133, 0.09625026995326276, 0.09151500148079221, 0.0906759909835402, 0.09107376701046896, 0.0907109443243867  …  0.14919239111256896, 0.14637666491100496, 0.14470331614329715, 0.14470331614329715, 0.14503072908974726, 0.05870848672357044, 0.058615105959711124, 0.04408073583984718, 0.04449829253592368, 0.04452054345234407], 1460.8835153062896, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.8111899573573698, -0.7740377923844628], [1.8111899573573698, -0.8043231108835641], [1.8169112694388145, -0.7504163382247634], [1.8169112694388145, -0.7944291275533761], [1.8169112694388145, -0.7752390502530557], [0.5255583105121355, -1.4772306925721645], [0.4747272372782619, -1.5567834228142732], [0.4613411222242513, -1.6265465542317334], [0.45730418488665847, -1.6382972557866362], [0.49140117793656657, -1.5838890688672582]  …  [0.8144805831317325, -1.3429684560267794], [0.7859004149738824, -1.40311205809031], [0.7935009074733682, -1.400756705040488], [0.8276682259333303, -1.3032980853770841], [0.8003163289888608, -1.3517342242839498], [0.7895246935810504, -1.3628374083488461], [0.7866461925525992, -1.388203001500875], [0.7947203456252658, -1.3725593115705166], [0.25080000718462114, -1.4618087643023436], [0.12329606486858036, -1.4229677218851213]], [0.25297822614646354, 0.25297822614646354, 0.2515963943786617, 0.2515963943786617, 0.2515963943786617, 0.3776565173774009, 0.37087321338288165, 0.36894860946073593, 0.36835720217671186, 0.3731910383644555  …  0.3985866702386763, 0.397943306416785, 0.39814604061387465, 0.39877404458487076, 0.39830835431250183, 0.3980428349747663, 0.39796421180157737, 0.39817643603448977, 0.33203872060819634, 0.30486427976998637], 3448.2828724952715, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.6563823988804771, -0.8417871528635085], [1.650325335180657, -0.8468316519245819], [1.666828001793862, -0.8288292014150441], [1.6580254439281392, -0.8816097760114496], [1.6618634593882033, -0.8875899492519854], [0.23011217199770262, -1.7764001817934516], [0.16337055271540724, -1.8445225346512255], [0.13603181137790454, -1.929414326715767], [0.12964473372933122, -1.956052478544759], [0.1746233641631149, -1.8651822884303915]  …  [0.5458868919263766, -1.6078341854788014], [0.5052780033558204, -1.6561369608553964], [0.5133495664652705, -1.6487478518616363], [0.5670086088579135, -1.5317358922023994], [0.5299694841320708, -1.5873623928743952], [0.5169572119112811, -1.5972893569429483], [0.5090055922524241, -1.6635111555205484], [0.5202084833111624, -1.5980647133261683], [-0.04156174567584758, -1.7448115516490081], [-0.16129747950844392, -1.6577312094456969]], [0.36147976873786625, 0.3624467799519544, 0.3597871722740093, 0.361215616472475, 0.3605955379354905, 0.24628360370035784, 0.23014386619565802, 0.2235544209868962, 0.2220184219895505, 0.2328616631532933  …  0.3195049150342698, 0.31071819525329947, 0.3124862486440023, 0.3239616334527501, 0.3160936795984195, 0.31327314328879635, 0.31153598886982614, 0.3139805026364313, 0.1817712955975045, 0.15531425870651414], 3230.1043249812747, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.4880249683077755, -0.958398198321875], [1.4809590047957406, -0.9600650494368516], [1.501062161510853, -0.8967915239801203], [1.4817034887258493, -0.9938971209997819], [1.4843454695378062, -0.9862491389491933], [-0.1251678643609877, -2.099237607525914], [-0.2055339542148379, -2.197326670586622], [-0.24985105396524887, -2.255452814120961], [-0.2615657619796206, -2.2927780820525943], [-0.19841309352296338, -2.1827156880006333]  …  [0.22432005483061634, -1.9286727389728577], [0.17405061118474108, -2.006378365508198], [0.18359999609294325, -1.9342639870647056], [0.2606614304174336, -1.7815893555013478], [0.21249700555719175, -1.86795921438418], [0.1974993405226914, -1.8883772217930774], [0.17630336114831446, -1.958358261419423], [0.20059554064592877, -1.9189825144682777], [-0.3905240560056492, -2.0023452500057544], [-0.4928437213975833, -1.843662126335913]], [0.041966134888182495, 0.042599124248367294, 0.040817459902526, 0.04253208381601473, 0.04229483587326428, 0.35046177686435276, 0.3639194371244955, 0.3705352075160455, 0.37218184868899656, 0.36280103707063194  …  0.275965126583665, 0.2877721829327907, 0.2855465575303191, 0.26731126579609465, 0.2787610961625423, 0.2822918273859535, 0.2872479485963143, 0.28156446699747445, 0.3872706559370132, 0.39497546872419687], 2067.8751776654644, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.2889459949083704, -1.069278723231485], [-0.5450153858661706, -2.3821445766945715], [-0.5450153858661706, -2.3905305148871108], [-0.6449992883321624, -2.518532230820612], [-0.6449992883321624, -2.4770027771694574], [-0.7009416167894411, -2.5396835034355605], [-0.7201213783901395, -2.5913648145854338], [-0.7201213783901395, -2.5924803059729613], [-0.6349562311230901, -2.4969591896815233], [-0.6349562311230901, -2.4822416052456227]  …  [-0.09565644068283596, -2.0832449362454666], [-0.16109483731964425, -2.184862437307194], [-0.18017610383592408, -2.199854187769714], [-0.18017610383592408, -2.2433750543589843], [-0.21536829113557016, -2.3053543825873755], [-0.1832009622477268, -2.267954127314843], [-0.7909931060068001, -2.1651705663101124], [-0.7909931060068001, -2.1959472271486713], [-0.861576146664766, -1.9906498849838983], [-0.861576146664766, -1.9797250430505668]], [0.23176412793629747, 0.2915986540535049, 0.2915986540535049, 0.26806170389518436, 0.26806170389518436, 0.25461852471445084, 0.24998632161929837, 0.24998632161929837, 0.2704595503347519, 0.2704595503347519  …  0.3762293970906618, 0.36710653226678064, 0.3641944871885011, 0.3641944871885011, 0.35854159233146304, 0.3637228201677724, 0.23284468884034112, 0.23284468884034112, 0.21586092036672688, 0.21586092036672688], 3183.561383599963, nothing, nothing)
 ⋮
 WeightedParticleBelief{Vector{Float64}}([[1.2196589058157967, -1.1057652529503763], [1.2197059217032424, -1.1160522890646538], [1.1880102066363376, -1.166847406545458], [1.3237613138403415, -0.9984125785531459], [1.312357770917369, -1.0600720648656488], [1.3018644625310665, -1.0876673048549164], [1.2990668402981447, -1.0673758843183756], [1.3165829029715685, -1.0697712891761275], [1.254016875096587, -1.0810830904051414], [1.2722736546796893, -1.043837106951718]  …  [0.9984529694467292, -1.32136974100188], [0.9658572794465705, -1.3033794997282726], [0.971114469348438, -1.3159729863789853], [0.9382795854140094, -1.292329741696245], [0.9488695931662592, -1.3197733365917481], [0.8565219192284689, -1.3806488158839452], [0.7460739347713249, -1.420253613856115], [0.9268764364288069, -1.3078213834795016], [0.8471481285941453, -1.3246780478303664], [0.7006236077046921, -1.5258359348411084]], [0.3981408656200251, 0.39814205228453564, 0.39714362259840913, 0.39861223486847913, 0.39877128710050885, 0.3988718726884643, 0.3988912780512617, 0.39871839564913597, 0.3987738749932309, 0.3989190042884198  …  0.38310595140126696, 0.37936653936174647, 0.3799944778089019, 0.3759192772758316, 0.3772732612288629, 0.36425075470973567, 0.34537510607436966, 0.37441980848104767, 0.36278129282918886, 0.33669965476959796], 3947.5285036666132, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.9985058552257214, -1.2505582753824107], [0.9964954638903116, -1.2716371728367735], [0.954640725327246, -1.2999704894952697], [1.1240787981297122, -1.1381998971857954], [1.1003433579442392, -1.1778050761904326], [1.084331001560083, -1.2079229713345288], [1.0855916634344696, -1.2451176309912537], [1.102628645136343, -1.2243330683960116], [1.0378002570155587, -1.2102087436656705], [1.0635062332893457, -1.1964793537035892]  …  [0.7341790212463533, -1.5037371158673332], [0.705181379500916, -1.4970161662680428], [0.707919872072641, -1.5059173176860345], [0.6798136370747603, -1.495396280906608], [0.6849149258479095, -1.563072867652036], [0.5803921560516798, -1.6217102005025492], [0.4620232120001019, -1.675041276218313], [0.6653121597329066, -1.5113779417744702], [0.582212519028072, -1.5380612346833886], [0.3954564207364704, -1.7865695953544751]], [0.3986510110780535, 0.3986808375098036, 0.3989359230044668, 0.3936265983824666, 0.395048579598677, 0.39588477267815175, 0.39582255510246633, 0.3949211250694825, 0.3977455710568512, 0.3968226912338185  …  0.388873662187333, 0.3861699309001565, 0.3864383554887708, 0.3835554935589433, 0.3840996688679038, 0.3711688198126922, 0.3523706967976243, 0.3819584756161896, 0.371424973154976, 0.34012064721600205], 3943.6565336020494, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.7483942001492393, -1.4650412337088974], [0.7421680293229569, -1.4714108668919317], [0.6946466274281919, -1.4860351669293537], [0.8964388186925532, -1.2797973485704537], [0.8647823427061527, -1.349024326881216], [0.8427464072931774, -1.3646265590736537], [0.8365681372362188, -1.4419971950213462], [0.8577620314571406, -1.4197747200673019], [0.7957585082824246, -1.3861231360708226], [0.8242103625486279, -1.4436018050637827]  …  [0.4334315980728866, -1.77464156760403], [0.4057781462473074, -1.773005234877628], [0.406736408535434, -1.8014563213829653], [0.3807343808934387, -1.7563876912736436], [0.37230035231750225, -1.8272132654204407], [0.25605011595116994, -1.9060713785016385], [0.12701495675643926, -1.949918014179894], [0.36303657137801254, -1.793917209969008], [0.27460027209139426, -1.8122160077396539], [0.03814250166557537, -2.1206498687575897]], [0.21443999723560064, 0.21295332608953813, 0.2016829355038219, 0.2501426710775751, 0.2424858660960312, 0.23715444870805177, 0.23566027727283276, 0.24078716650300686, 0.22580784476359306, 0.23267317281865696  …  0.14366429159154562, 0.13804421005500575, 0.13823700036173675, 0.13305662101293098, 0.1313992825217967, 0.10975270441518246, 0.08846405814470945, 0.1295920491417507, 0.11305341213903826, 0.07551994101818511], 2129.0764841266478, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.4553859534074598, -1.7201795121778052], [0.44788585594457053, -1.761239809817892], [0.3974395940423212, -1.7135655205431164], [0.6404793489784624, -1.5167836280765203], [0.5949774773299095, -1.5707989192598526], [0.5698210954784466, -1.6259974831124777], [0.5481686982319496, -1.6759557903808828], [0.5738070874436803, -1.6258040918121146], [0.51853388106826, -1.5996728762299282], [0.5354900015358713, -1.6648823692268582]  …  [0.07850328455208061, -2.077017441899882], [0.05117709927178177, -2.0832549439058687], [0.04644514425884094, -2.157619348258036], [0.029456842638709957, -2.070661828690323], [0.006857699233414061, -2.174632661180463], [-0.1251641597491578, -2.2284329774903737], [-0.26296864607953957, -2.282850582334831], [0.0042531293842109075, -2.0997128496495634], [-0.08784292945653654, -2.1056795014102017], [-0.3859874720859426, -2.452057399162453]], [0.10066295370141272, 0.10192084077024907, 0.1106379699405334, 0.07278267170481215, 0.07907343900959551, 0.08270832669607409, 0.0859268811228375, 0.08212490188011613, 0.0904672051366027, 0.08785023831103442  …  0.1752493785030983, 0.18143306370922568, 0.18251197226689708, 0.18640412874425574, 0.1916249877560431, 0.222896068034205, 0.25618514558311584, 0.1922297074415251, 0.2139494728892526, 0.285464390023249], 1063.6044398996817, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.11135005097189876, -2.0076377108437846], [0.0956378939809921, -2.0510287626205805], [0.054726489933697886, -1.9888781427466429], [0.3371226233631583, -1.7877076897188995], [0.24462159885595103, -1.905098510578186], [0.21297754015577297, -1.9848927705699568], [0.2486462690812573, -1.9199885520487923], [0.19859930582227436, -1.9209646771074262], [0.371557004155503, -1.707361223974921], [0.3010446068436541, -1.875920541811132]  …  [-0.5708507552472326, -2.5251688896278557], [-0.7195387625465057, -2.599653341937025], [-0.7195387625465057, -2.5415792730120605], [-0.7195387625465057, -2.5603026926405676], [-0.4156894405457018, -2.4408642479050657], [-0.5089788297385769, -2.4562656127906846], [-0.5089788297385769, -2.4403558062760484], [-0.8763989519184332, -2.689570089237369], [-0.8763989519184332, -2.7159574797265575], [-0.8763989519184332, -2.732414950097932]], [0.16310231271967718, 0.16654559204930894, 0.17565256697449275, 0.11755691758745913, 0.13526661314971208, 0.1416398995715979, 0.13446720172709214, 0.14458629296080122, 0.11133011505146259, 0.12429666946907182  …  0.321859502227308, 0.35089766470413397, 0.35089766470413397, 0.35089766470413397, 0.28726414337859596, 0.3084800218198436, 0.3084800218198436, 0.37527441984853815, 0.37527441984853815, 0.37527441984853815], 1876.2825292936463, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.2901774911968582, -2.358216428154322], [-0.314567858543124, -2.4072715227049146], [-0.3430491386156307, -2.327714653156768], [-0.020418914580621617, -2.105333175430885], [-0.13639810325968615, -2.2616401389719067], [-0.18400101395821844, -2.322738161240551], [-0.1353514413285012, -2.2391226068279297], [-0.18559362959921089, -2.2437955695384524], [0.030084759360518798, -1.976255331354642], [-0.07413950151857235, -2.2207226718026]  …  [-1.0758845331728037, -2.710043778250139], [-1.2394694309339107, -2.627378658820486], [-1.227854617148918, -2.5930413892316535], [-1.2315993010746191, -2.6093205980686145], [-0.9038622901267149, -2.6856952136432977], [-1.0002319522967138, -2.659837911520989], [-0.9970499909937867, -2.6636324345936386], [-1.414312969765907, -2.6120273316987483], [-1.4195904478637447, -2.635015644549024], [-1.4228819419380194, -2.657371828447641]], [0.39546868695552284, 0.39662839554808227, 0.39768738112080004, 0.36797352127401073, 0.3829521765476938, 0.3877624718397834, 0.3828373369751828, 0.38790925017122346, 0.36011834814728144, 0.3754646068223634  …  0.3222456702179079, 0.28572751765083576, 0.2884324597190056, 0.28756182244485057, 0.3552875248112737, 0.33760892584791113, 0.3382284950682065, 0.24393434780685633, 0.24265739395813976, 0.24186095060438845], 3812.2014562234117, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.7618207768277225, -2.6441898586503143], [-0.7960221630841069, -2.6910635636585436], [-0.8085920692469843, -2.5827450338052955], [-0.4414855496667986, -2.4325944725133457], [-0.5887261310540675, -2.592538049456959], [-0.6485486462063286, -2.6808397784522136], [-0.5831759626940871, -2.5699969569984797], [-0.6343527435069014, -2.567128587748751], [-0.36516630691040963, -2.301269974560792], [-0.5182840358790923, -2.5579435708006244]  …  [-1.6178932888228315, -2.4276056038331766], [-1.764945162698008, -2.1546269780056635], [-1.7464628949952488, -2.1396837398890223], [-1.753463420688342, -2.171764923520541], [-1.4410013328553744, -2.607541968046434], [-1.5321995346009116, -2.4192151397970663], [-1.5297764779125145, -2.4653263787541198], [-1.9367184361056566, -1.9091711925655264], [-1.9465935767735494, -1.9472576424160395], [-1.9543563076275476, -1.9490333601084027]], [0.030413254216794427, 0.032848068104527964, 0.0337811785268074, 0.013967940664402555, 0.020229953643319597, 0.023370179973586327, 0.01995731042748807, 0.022590808050432738, 0.011430034346525569, 0.016990673453703406  …  0.14705189607515123, 0.17906186592655943, 0.17489158893215545, 0.1764667051758971, 0.1127557029058184, 0.12980637772905476, 0.12933552762703857, 0.21929187266107428, 0.22166299662917843, 0.22352959030396008], 493.63355163862775, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.2906587485577854, -2.6909594633521547], [-1.3251410760080433, -2.5549619254803595], [-1.1072337409454593, -2.791074047604268], [-1.1477784610566517, -2.655895619400221], [-1.029872750039217, -2.7538199977785958], [-1.1457247571386675, -2.7777194972766512], [-1.1274688303831417, -2.689220777570233], [-1.1611145278216053, -2.729726844597596], [-1.2810150971564478, -2.6924906124150962], [-1.0063285437125162, -2.8117264408869347]  …  [-2.318552674618762, -0.6731717122194625], [-2.3360451052567575, -0.7009934109631468], [-2.3360451052567575, -0.6818114815669218], [-2.3360451052567575, -0.695888540999904], [-2.3360451052567575, -0.7169100269161761], [-2.3441629796492283, -0.6839019447321526], [-2.3441629796492283, -0.6865441874819409], [-2.3441629796492283, -0.7263285458273114], [-2.3441629796492283, -0.666700062116039], [-2.3441629796492283, -0.6571294074604905]], [0.05320497796223623, 0.0569842251784839, 0.03620282278207612, 0.03953309853548366, 0.030467684719048805, 0.03935882728257922, 0.03783604670270558, 0.04067951035294443, 0.05218252026566653, 0.028875362060281396  …  0.24694854829560028, 0.25117741975236507, 0.25117741975236507, 0.25117741975236507, 0.25117741975236507, 0.253138163246974, 0.253138163246974, 0.253138163246974, 0.253138163246974, 0.253138163246974], 1147.0345930223398, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.8288506412282164, -2.1662590976864404], [-1.665448550466313, -2.4586992437577813], [-1.7012686565939976, -2.410290671425137], [-1.8195132196394672, -2.1664295654695027], [-1.7046167161988548, -2.248313259462109], [-1.5729898946648126, -2.444404517795381], [-1.9145674923439593, -1.9799410978633862], [-1.8721220424108136, -2.1105290321296772], [-1.8252582315013346, -2.05054333579004], [-1.643393509734818, -2.4330830446489102]  …  [-2.480943368595659, 0.2973340634551077], [-2.480943368595659, 0.30210900203548763], [-2.4814718171456165, 0.2883280451880357], [-2.4814718171456165, 0.3386780806049481], [-2.4894286888146904, 0.26036959376418556], [-2.4894286888146904, 0.29911087745977305], [-2.477502992072436, 0.28039012978743194], [-2.477502992072436, 0.30715726257669285], [-2.4755888611413264, 0.2939149295295661], [-2.4755888611413264, 0.28108423192825627]], [0.19804777078538346, 0.237113920708999, 0.22845973609647605, 0.2002397292080328, 0.2276522356232837, 0.259454441294181, 0.17828630051900507, 0.18798484890820052, 0.19889028648095758, 0.24244994508337311  …  0.07400697135817677, 0.07400697135817677, 0.07393520878426409, 0.07393520878426409, 0.07286059093645088, 0.07286059093645088, 0.07447536711574783, 0.07447536711574783, 0.07473686896280238, 0.07473686896280238], 1168.1797961644877, nothing, nothing)</code></pre><h2 id="Plotting-the-Results"><a class="docs-heading-anchor" href="#Plotting-the-Results">Plotting the Results</a><a id="Plotting-the-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-the-Results" title="Permalink"></a></h2><p>We can now plot the observations, the smoothed estimate of the position (the mean of the belief at every time step), and the true state. Note that the estimated position is much closer to the true position than the noisy measurements.</p><pre><code class="language-julia hljs">xmat = readdlm(&quot;x.txt&quot;);

plot_data = [(; t, x1=x[1], x2=x[2], y, b_mean=mean(b)[1]) for (t, (x, y, b)) in enumerate(zip(eachslice(xmat; dims=1), ys, bs))]

plot_data |&gt; @vlplot(x = :t, width = 700) +
             @vlplot(:line, y = :x1, color = {datum = &quot;True State&quot;}) +
             @vlplot(:point, y = :y, color = {datum = &quot;Observation&quot;}) +
             @vlplot(:line, y = :b_mean, color = {datum = &quot;Mean Belief&quot;})</code></pre><img src="cd65378e.svg" alt="Example block output"/><h2 id="Appendix"><a class="docs-heading-anchor" href="#Appendix">Appendix</a><a id="Appendix-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix" title="Permalink"></a></h2><h3 id="Code-for-Generating-Data"><a class="docs-heading-anchor" href="#Code-for-Generating-Data">Code for Generating Data</a><a id="Code-for-Generating-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Code-for-Generating-Data" title="Permalink"></a></h3><p>The following code can be used to generate the data in the text files:</p><pre><code class="language-julia hljs">rng = MersenneTwister(1)

k = 100
h(x, rng) = x[1] + sigma*randn(rng)

x = [3.0, 0.0]
xs = Array{typeof(x)}(undef, k)
us = zeros(k)
ys = zeros(k)
for t in 1:k
    x = f(x, us[t], rng)
    ys[t] = h(x, rng)
    xs[t] = x
end

using DelimitedFiles
writedlm(&quot;x.txt&quot;, xs)
writedlm(&quot;y.txt&quot;, ys)
writedlm(&quot;u.txt&quot;, us)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sampling/">« Sampling</a><a class="docs-footer-nextpage" href="../example-feedback/">Example: Feedback Control »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Saturday 26 April 2025 15:33">Saturday 26 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
