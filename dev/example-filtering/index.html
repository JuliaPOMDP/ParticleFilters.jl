<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example: Filtering Preexisting Data · ParticleFilters.jl</title><meta name="title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="og:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="twitter:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta name="description" content="Documentation for ParticleFilters.jl."/><meta property="og:description" content="Documentation for ParticleFilters.jl."/><meta property="twitter:description" content="Documentation for ParticleFilters.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ParticleFilters.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../bootstrap/">Bootstrap Filter</a></li><li><a class="tocitem" href="../beliefs/">Beliefs</a></li><li><a class="tocitem" href="../basic/">Basic Particle Filter</a></li><li><a class="tocitem" href="../depletion/">Handling Particle Depletion</a></li><li><a class="tocitem" href="../sampling/">Sampling</a></li><li class="is-active"><a class="tocitem" href>Example: Filtering Preexisting Data</a><ul class="internal"><li><a class="tocitem" href="#Model"><span>Model</span></a></li><li><a class="tocitem" href="#Data"><span>Data</span></a></li><li><a class="tocitem" href="#Filtering"><span>Filtering</span></a></li><li><a class="tocitem" href="#Plotting-the-Results"><span>Plotting the Results</span></a></li><li><a class="tocitem" href="#Appendix"><span>Appendix</span></a></li></ul></li><li><a class="tocitem" href="../example-feedback/">Example: Feedback Control</a></li><li><a class="tocitem" href="../example-pomdps/">Example: Use with POMDPs.jl</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl/blob/master/docs/src/example-filtering.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-Filtering-Preexisting-Data"><a class="docs-heading-anchor" href="#Example:-Filtering-Preexisting-Data">Example: Filtering Preexisting Data</a><a id="Example:-Filtering-Preexisting-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Filtering-Preexisting-Data" title="Permalink"></a></h1><p>In some cases, there is no need to perform control based on the particle belief and instead the goal is to filter a previously-generated sequence of measurements to remove noise or reconstruct hidden state variables. This tutorial will illustrate use of the <code>runfilter</code> function for that purpose.</p><p>First, we import the packages we will use. </p><pre><code class="language-julia hljs">using Distributions
using Random
using DelimitedFiles
using ParticleFilters
using VegaLite</code></pre><h2 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h2><p>We will use <a href="https://en.wikipedia.org/wiki/Euler_method">Euler-integrated</a> <a href="https://en.wikipedia.org/wiki/Van_der_Pol_oscillator">Van Der Pol Oscillator Equations</a> with noise added as the dynamics (<code>f</code>), and measurements of the position with gaussian noise added (the pdf is encoded in <code>g</code>).</p><p>This model is implemented below. For more information on defining models for particle filters, see the <a href="https://juliapomdp.github.io/ParticleFilters.jl/latest/models/">documentation</a>.</p><pre><code class="language-julia hljs">const dt = 0.2
const mu = 0.8
const sigma = 1.0

function f(x, u, rng)
    xdot = [x[2], mu * (1 - x[1]^2) * x[2] - x[1] + u + 0.1 * randn(rng)]
    return x + dt * xdot
end

g(x1, u, x2, y) = pdf(Normal(sigma), y - x2[1])</code></pre><h2 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h2><p>Suppose that the data we would like to filter are contained in text files. <a href="../u.txt"><code>u.txt</code></a> contains the control inputs, and <a href="../y.txt"><code>y.txt</code></a> contains the measurements. The code that generated this data can be found in the <a href="#Appendix">appendix below</a>.</p><pre><code class="language-julia hljs">ys = vec(readdlm(&quot;y.txt&quot;));
us = vec(readdlm(&quot;u.txt&quot;));</code></pre><h2 id="Filtering"><a class="docs-heading-anchor" href="#Filtering">Filtering</a><a id="Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering" title="Permalink"></a></h2><p>We can use an SIR particle filter to get a better estimate of the state. Note that we start with an initial belief consisting of particles with zero velocity and position uniformly distributed in <span>$[-5, 5]$</span>.</p><pre><code class="language-julia hljs">n = 10_000

fil = BootstrapFilter(f, g, n)

# construct initial belief
b0 = ParticleCollection([[10.0 * (rand() - 0.5), 0.0] for i in 1:n])

bs = runfilter(fil, b0, us, ys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100-element Vector{Any}:
 WeightedParticleBelief{Vector{Float64}}([[1.8725444254198265, -0.33266769961507203], [0.20987286883817236, -0.04400411102652761], [-0.4096789689599656, 0.07239108724595149], [-0.8664894441311854, 0.20952076360157967], [-3.1112523536958236, 0.5916183619420893], [-3.016845924630951, 0.5989486403328214], [1.0588655200858732, -0.18268960994236402], [1.206787596172293, -0.23384375936099697], [3.832454467502332, -0.7763810699415012], [1.7031506056650558, -0.32704378667635475]  …  [-1.174406041200854, 0.23525940275044796], [-4.137981029711657, 0.8399031174953606], [3.2607081264130224, -0.6522738969702566], [-2.751217940900801, 0.586155781712425], [-2.530405116083889, 0.5237135186824147], [-4.144528689067689, 0.8331565687538328], [-1.9964183308770134, 0.4376119228865853], [0.500304786080904, -0.06963106319468029], [-1.559640399272434, 0.27620734339046693], [0.006595580999445572, 6.768491215891799e-5]], [0.3503183975192611, 0.037670919774476536, 0.008092806005414963, 0.00203641016742908, 1.1152417278222441e-7, 1.8649805261780567e-7, 0.16615985763564517, 0.19989439939251688, 0.13941873956888487, 0.3167553200483411  …  0.0007141919467379195, 2.3379028321851503e-10, 0.2712661987011464, 7.554634651104239e-7, 2.2904877356782286e-6, 2.2401429002427707e-10, 2.737320714718283e-5, 0.06787604252651085, 0.00016846814224736242, 0.02372674770345576], 1021.5505357646707, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.806010885496812, -0.582090478705194], [1.806010885496812, -0.5502848658249897], [1.806010885496812, -0.5900286728459287], [1.806010885496812, -0.5832135250106685], [1.0223275980974005, -0.3563321433617581], [1.0223275980974005, -0.3790147101379717], [1.1600188443000936, -0.46621727739497654], [1.1600188443000936, -0.4568934086520082], [3.677178253514032, 0.15205889589384824], [1.637741848329785, -0.5514348601025159]  …  [4.112609773883103, 0.6706010777727985], [1.0648197394895318, -0.420668464341689], [1.0648197394895318, -0.36915880128972556], [1.1008458413096054, -0.42946309604206134], [1.1008458413096054, -0.4429066330677471], [1.0699972374105764, -0.48032815711629073], [4.339019747526256, 1.0353868664269288], [3.130253347018971, -0.31024484315047435], [3.130253347018971, -0.3066904252775839], [0.48637857344196794, -0.16785413707721733]], [0.39810729871895, 0.39810729871895, 0.39810729871895, 0.39810729871895, 0.27835899482706533, 0.27835899482706533, 0.30990062705077787, 0.30990062705077787, 0.07803943081211327, 0.3882586596270215  …  0.03232482348161077, 0.288316796559545, 0.288316796559545, 0.2966180338475527, 0.2966180338475527, 0.2895184805601384, 0.018965545420688137, 0.18048266446361969, 0.18048266446361969, 0.15302220735677566], 2780.141486403055, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.6895927897557732, -0.7528567948951144], [1.6895927897557732, -0.7194684491934815], [1.6959539123318141, -0.6991905549412926], [1.6880051509276262, -0.7260250951074602], [1.6893681804946783, -0.74597953802105], [1.6893681804946783, -0.7276591338680413], [0.9510611694250488, -0.546935342232957], [0.9465246560698062, -0.6018632986989676], [1.0667753888210982, -0.6697144183195388], [1.068640162569692, -0.6737785455391074]  …  [2.871399588572587, -0.5058382404731592], [2.873228282317488, -0.5180865198339643], [2.8767810510674856, -0.5167284425840142], [0.980686046621194, -0.5860701362452996], [0.9909879792315867, -0.5682991661090335], [1.0149532221011932, -0.6113907290889902], [1.012264514696056, -0.6736475168550844], [0.9739316059873182, -0.6799480908331339], [3.0682043783888764, -0.4581925250486608], [3.068915261963454, -0.5229675474985188]], [0.3662407120565145, 0.3662407120565145, 0.367198079381468, 0.36599984789122775, 0.3662066825263154, 0.3662066825263154, 0.20543533518469925, 0.20436230734715805, 0.23316645702440444, 0.23361711677523256  …  0.2970004830666989, 0.29658304079709935, 0.29577088697480414, 0.2124748836537739, 0.21493476166265812, 0.22067725759966234, 0.22003172299849127, 0.2108652232749057, 0.25042959311124996, 0.2502577885523468], 3251.9301375900845, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.5390214307767502, -0.8356046144017716], [1.545699099917077, -0.815156818886751], [1.5561158013435556, -0.8286134188471539], [1.5428001319061342, -0.8539045921294343], [1.5401722728904683, -0.8533774872399408], [1.54383635372107, -0.8388704991938409], [0.8416741009784574, -0.7273004943817927], [0.8261519963300127, -0.7669807823451943], [0.9328325051571904, -0.8527975247430515], [0.9338844534618704, -0.8857355753705486]  …  [2.770231940477955, -0.5059176713621246], [2.7696109783506953, -0.4896718328146676], [2.773435362550683, -0.4889345954382914], [0.863472019372134, -0.7785417667353001], [0.8773281460097799, -0.7605398257142926], [0.8926750762833952, -0.7965928100419641], [0.8775350113250392, -0.8675433663329895], [0.8379419878206914, -0.8586489691636153], [2.976565873379144, -0.4445174812027233], [2.9643217524637504, -0.4362810710103071]], [0.04237611761672523, 0.041780162405235265, 0.04086356554438024, 0.04203807748473309, 0.04227294108773506, 0.04194574516220848, 0.14550049673656956, 0.1487259276450673, 0.12730064508228156, 0.12709832954508019  …  0.0014642833221464116, 0.001467331212191815, 0.0014486512650549656, 0.14103134499369885, 0.1382279555029829, 0.13515764845388006, 0.13818632621049845, 0.14627278751120684, 0.0007182730003209994, 0.0007501739067472474], 447.30898111790043, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.371900507896396, -0.9898828407927188], [1.3826677361397268, -0.9358072517997131], [1.3903931175741249, -0.9204187908770083], [1.3720192134802474, -0.9849547512972934], [1.3694967754424803, -0.9905960402389], [1.3760622538823017, -0.9467993008887892], [0.6962140021020988, -0.9113073388499542], [0.6962140021020988, -0.9457263358711995], [0.6962140021020988, -0.9790903461496648], [0.6727558398609739, -0.9496741026741324]  …  [0.7252201808669214, -0.977880548841008], [0.7333565142750023, -1.0048898990789084], [0.7333565142750023, -1.0197182699890524], [0.7333565142750023, -1.0422078016212906], [0.7040263380584413, -1.0793846925096107], [0.7040263380584413, -1.0552463106171042], [0.7040263380584413, -1.0859135805811546], [0.6662121939879684, -1.0424336970669428], [0.6662121939879684, -1.0741660702101699], [0.6662121939879684, -1.1039626051081464]], [0.32202223947646746, 0.3242808545306168, 0.32588786365961636, 0.322047257633466, 0.3215150767373504, 0.3228978058338525, 0.16469516783385957, 0.16469516783385957, 0.16469516783385957, 0.1595914367872233  …  0.17110197673083608, 0.17291732805880347, 0.17291732805880347, 0.17291732805880347, 0.16641052482772856, 0.16641052482772856, 0.16641052482772856, 0.15818065062548395, 0.15818065062548395, 0.15818065062548395], 2213.220023767751, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.1739239397378523, -1.1423252172474814], [1.1739239397378523, -1.1200151820261701], [1.1955062857797842, -1.0763013282987812], [1.2063093593987233, -1.0894334047759577], [1.2063093593987233, -1.0348036110379655], [1.1750282632207887, -1.1180843878363673], [1.1713775673947002, -1.129399390435344], [1.1713775673947002, -1.1139632299340745], [1.186702393704544, -1.0588603244445964], [0.513952534332108, -1.1278672225278743]  …  [0.5111747187245208, -1.2286175828476442], [0.5330314724568043, -1.1559130858761273], [0.5364662606122759, -1.1915797599015654], [0.5296440710987198, -1.2227362147418814], [0.5294128602771918, -1.2177119312390112], [0.5249149539507442, -1.2562930890711956], [0.48814939955651915, -1.3118940448742007], [0.49297707593502044, -1.2548750395578576], [0.4577254545745798, -1.2725261091670115], [0.4513789799459344, -1.311364550556834]], [0.1761642511826086, 0.1761642511826086, 0.181051032932243, 0.1835156896662704, 0.1835156896662704, 0.17641305973725516, 0.17559106364636487, 0.17559106364636487, 0.17905152286336415, 0.060934584537400305  …  0.060607101442365544, 0.06321898491034869, 0.0636367909415109, 0.06280890391489627, 0.06278098429552187, 0.06223964477476101, 0.057942258202110734, 0.05849367587104045, 0.05455559919477173, 0.0538681997858562], 1456.5773831844826, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.945458896288356, -1.3401295044721444], [0.9499209033326182, -1.28312410275017], [0.980246020120028, -1.245227113267653], [0.9884226784435317, -1.2554793016571528], [0.9884226784435317, -1.2472326538529381], [0.9993486371911302, -1.1950506164829946], [0.9514113856535152, -1.242940052292381], [0.9454976893076315, -1.289900439395935], [0.9485849214078853, -1.2876458207614516], [0.9485849214078853, -1.25478314134559]  …  [1.1254847577190086, -1.1802616912998776], [1.1226250347737383, -1.170863707340767], [1.1226250347737383, -1.2005876571110172], [1.6884129763202638, -0.8636055520021026], [1.6884129763202638, -0.8532215989398755], [0.25168141036263775, -1.5324261678301683], [0.3018488552815788, -1.4254060772531354], [0.2858704740293896, -1.4664392137978681], [0.22577059058167898, -1.5596354565447963], [0.18910606983456757, -1.5893125206891416]], [0.397374360865661, 0.3972130832687904, 0.39590984347915076, 0.3954969199880585, 0.3954969199880585, 0.39490461492372775, 0.3971574631109127, 0.3973729925167439, 0.3972621945205137, 0.3972621945205137  …  0.3847899352826299, 0.3850842290336012, 0.3850842290336012, 0.2822954317461899, 0.2822954317461899, 0.3322159653504723, 0.34202360257222025, 0.3389614099988849, 0.32693870633526073, 0.3192477265659499], 3464.1512533457853, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.6774329953939271, -1.5632127996641392], [0.6932960827825843, -1.4966236316849417], [0.7312005974664975, -1.4285619626747255], [0.7373268181121011, -1.4257103387190129], [0.7389761476729441, -1.4227757605985656], [0.7603385138945313, -1.4461477410040318], [0.702823375195039, -1.4254351293852907], [0.6875176014284444, -1.5028004828084351], [0.691055757255595, -1.4913394740286066], [0.6976282931387673, -1.4500224709752176]  …  [0.8894324194590331, -1.3878040562874694], [0.888452293305585, -1.3608325457420962], [0.8825075033515348, -1.3641601423915766], [1.5156918659198433, -0.9657847983685748], [1.5177686565322888, -0.9572770214046749], [-0.05480382320339594, -1.7903491599427752], [0.016767639830951697, -1.6791933295297659], [-0.00741736873018406, -1.762915690331241], [-0.08615650072728032, -1.8341879211834475], [-0.12875643430326078, -1.8677569655775899]], [0.34577307753772785, 0.3486753711291311, 0.3553470853367553, 0.35638923449882853, 0.356668041511426, 0.36021041364252754, 0.35038778825835926, 0.34762546489514035, 0.3482693254202329, 0.3494569266951908  …  0.37868299497833174, 0.37856300258876213, 0.3778282460852893, 0.3809961531804083, 0.38075533827038915, 0.17876248939553066, 0.19523116284422387, 0.18961168553590121, 0.17171564577840834, 0.1623279922769485], 3235.10679354722, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.36479043546109924, -1.8379773022548886], [0.3939713564455959, -1.7663453552814306], [0.44548820493155233, -1.6511560038862438], [0.4521847503682985, -1.6464792757761169], [0.45442099555323096, -1.6783867058063755], [0.47110896569372496, -1.7093660529890324], [0.41773634931798087, -1.6797619385561326], [0.3869575048667574, -1.7659562477819186], [0.3927878624498737, -1.7586825516818152], [0.40762379894372375, -1.740606851623411]  …  [0.6118716082015392, -1.5912825373105373], [0.6162857841571656, -1.5597149475741419], [0.6096754748732195, -1.575902144441253], [1.3225349062461282, -1.080353849440011], [1.3263132522513539, -1.0459411697902348], [-0.412873655191951, -2.0806517911721087], [-0.3190710260750015, -1.9295900915286621], [-0.3600005067964323, -2.0313238813270376], [-0.45299408496396987, -2.0557684228554263], [-0.5023078274187788, -2.1198141494329974]], [0.24221109223445497, 0.23515195717633572, 0.22272458350759136, 0.22111507010670559, 0.22057798061772965, 0.21657673026389082, 0.22941088979065408, 0.23684807201713126, 0.23543811201092332, 0.23185251667155354  …  0.18354306866693754, 0.18253449216323786, 0.1840455920926105, 0.05881396468604646, 0.05838032315221, 0.38928841169277906, 0.3796153521613392, 0.3842216599834153, 0.39244485097426857, 0.3954865732559557], 2082.325102028547, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.002805024989878502, -2.17107112978089], [0.040702285389309756, -2.1047603682578444], [0.11525700415430357, -1.9326216133500835], [0.12288889521307511, -1.9411126691909153], [0.11874365439195583, -1.9794356148422902], [0.12923575509591845, -2.0150998078145745], [0.08178396160675433, -1.990031775308593], [0.08178396160675433, -2.0040835032996753], [0.03376625531037364, -2.0659364658770576], [0.04105135211351063, -2.0891555199279392]  …  [1.117125018293307, -1.218391525999315], [-0.8290040134263728, -2.2771733708236397], [-0.704989044380734, -2.1744396050183212], [-0.704989044380734, -2.140143672664924], [-0.7662652830618398, -2.2706877334127427], [-0.7662652830618398, -2.223244291435085], [-0.8641477695350551, -2.210967657526092], [-0.8641477695350551, -2.233623338873026], [-0.9262706573053783, -2.2456238333549803], [-0.9262706573053783, -2.2736462139683122]], [0.3867120523346299, 0.3905636525629355, 0.3955087242466974, 0.395894272668943, 0.39568767591552406, 0.3961976140724627, 0.39355132239584467, 0.39355132239584467, 0.38999652159577436, 0.39059171948143534  …  0.27315291815890674, 0.22367722773624882, 0.25364168438363066, 0.25364168438363066, 0.23882398346836842, 0.23882398346836842, 0.2152458439532128, 0.2152458439532128, 0.20050509284161216, 0.20050509284161216], 3198.02911361026, nothing, nothing)
 ⋮
 WeightedParticleBelief{Vector{Float64}}([[1.0478912243652683, -1.244458742306811], [1.1409038311248598, -1.2123791179042394], [1.086719872789398, -1.1966935966067611], [1.1578912150454894, -1.1499823823385633], [1.2531737083107068, -1.0807477906070577], [1.0581267539975694, -1.239293167884226], [1.08134797119798, -1.1921834466045553], [1.0467221344928779, -1.249569030188422], [1.1292550681902993, -1.1527473389032732], [1.0473202548335465, -1.219078885769514]  …  [1.0520483753472663, -1.223360180159114], [1.0733883227849614, -1.2489934266566363], [1.0342940266949407, -1.249004847479391], [1.035012481706803, -1.2541430612743145], [1.0031075208467453, -1.2184418834488082], [1.185600905172849, -1.0988676364121983], [1.1951388089581296, -1.1141511587121347], [1.2115769793940794, -1.101890168778614], [1.210878389754725, -1.0932236696557134], [0.740990305004952, -1.5032479856199668]], [0.3880603179293162, 0.3949306858720735, 0.39132517519590626, 0.39582853290702014, 0.3987639627037445, 0.3889752219146271, 0.3909069802678508, 0.3879533694207977, 0.39425042071182037, 0.38800814812616136  …  0.3884365531631405, 0.39026744740806707, 0.386785582527901, 0.38685462242285024, 0.38360966834946525, 0.39705151791013804, 0.39740275529552316, 0.3979238616627665, 0.3979038893510399, 0.34442909478045264], 3950.4596329002206, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.7989994759039061, -1.4352896231515324], [0.898428007544012, -1.3641890172685727], [0.8473811534680459, -1.3834786374113561], [0.9278947385777767, -1.2979020615026382], [1.0370241501892954, -1.2388317092708743], [0.8102681204207242, -1.4336072165575264], [0.842911281877069, -1.3972217806602993], [0.7968083284551934, -1.4610137745413718], [0.8987056004096446, -1.353536252264517], [0.8035044776796437, -1.4244695396170628]  …  [0.8073763393154434, -1.4129889453573694], [0.8235896374536342, -1.4145753622327255], [0.7844930571990626, -1.4280855192860962], [0.7841838694519401, -1.4144790816068935], [0.7594191441569836, -1.3925428813340124], [0.9658273778904094, -1.2481878691882877], [0.9723085772157027, -1.2663413133429813], [0.9911989456383565, -1.2527966302699134], [0.9922336558235824, -1.2326696603591043], [0.44034070788095864, -1.7790786364118791]], [0.3937869552000838, 0.3981797462469929, 0.3964075979663851, 0.39873304866611714, 0.3977693800273271, 0.3944782603518482, 0.396203634930734, 0.393646869313441, 0.39818656826616466, 0.39406918476091335  …  0.3943055164390405, 0.395232329948551, 0.3928253571267086, 0.39280398765974817, 0.39097474080389233, 0.39893615578219344, 0.39891345042843457, 0.3987517118842268, 0.3987387442773932, 0.3485023879745669], 3939.0855229522103, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.5119415512735996, -1.6898850161111054], [0.6255902040902974, -1.5679290122273213], [0.5706854259857747, -1.6187140850997443], [0.6683143262772491, -1.5100799374495502], [0.7892578083351205, -1.443132601820381], [0.5235466771092189, -1.683037617843142], [0.5634669257450091, -1.618408988620293], [0.504605573546919, -1.7157178250208331], [0.6279983499567412, -1.5619324558891794], [0.5186105697562311, -1.6705790497087005]  …  [0.5247785502439695, -1.6573424788868654], [0.5406745650070891, -1.6497583108202991], [0.49887595334184337, -1.6752938732875424], [0.5012880531305614, -1.6458330254035507], [0.48091056789018116, -1.6443747779745024], [0.7161898040527519, -1.4762612777492081], [0.7190403145471065, -1.4191448997899787], [0.7406396195843739, -1.477035668836187], [0.7456997237517615, -1.4366543583244822], [0.08452498059858277, -2.097295590010999]], [0.1602292335678149, 0.18561118327184828, 0.1731617494759189, 0.1955065410583182, 0.22424242028975772, 0.1627496842763135, 0.17154986824343638, 0.15864512656080249, 0.1861644089303746, 0.16167549096174116  …  0.16301825558578392, 0.166501235311067, 0.15741289959512778, 0.15793111311695585, 0.15357823659725697, 0.20677419655098342, 0.20745019852393543, 0.21258869437771513, 0.21379636377761313, 0.08210068926471205], 2183.6818707238704, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.1739645480513785, -1.9888376124052036], [0.3120044016448331, -1.869118803402366], [0.24694260896582576, -1.9150391528182695], [0.36629833878733903, -1.7662049498085988], [0.5006312879710443, -1.6700374861984373], [0.18693915354059043, -1.9289409241900797], [0.23978512802095048, -1.9476248803519338], [0.1614620085427524, -2.0366530477733313], [0.3156118587789053, -1.8374797276004058], [0.18449475981449098, -1.9666215106887832]  …  [0.19331005446659638, -1.952662057864126], [0.21072290284302925, -1.934050193192077], [0.16381717868433487, -1.9681921001505718], [0.1721214480498512, -1.98282109951014], [0.15203561229528068, -1.9590581131276414], [0.42093754850291026, -1.750097655707577], [0.4352113345891107, -1.668231647760444], [0.4452324858171364, -1.7237183838181762], [0.45836885208686506, -1.6926207661947479], [-0.33493413740361705, -2.4199890793897065]], [0.15434792785368054, 0.12639934970624597, 0.13920865171418695, 0.11623966430376394, 0.09328578761362737, 0.15159986638872464, 0.14065843311755769, 0.15701811319344036, 0.12570907997613023, 0.15211578698787379  …  0.1502591952971634, 0.14662470752233683, 0.15651347904922228, 0.1547402090984888, 0.15904538353732983, 0.10652216159232139, 0.10406908450352578, 0.10236822872199501, 0.1001654332355289, 0.27342951277597805], 1019.0895104326503, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.22380297442966224, -2.307003316003011], [-0.22380297442966224, -2.34695244756089], [-0.06181935903564012, -2.194995901032045], [-0.1360652215978282, -2.2325850978766373], [-0.1360652215978282, -2.2304542587487126], [0.013057348825619264, -2.103840225796564], [0.1666237907313568, -1.9556157580554825], [-0.19884903129742554, -2.2434518266026164], [-0.1497398480494363, -2.265160280434883], [-0.1497398480494363, -2.271869528686195]  …  [-0.22982124134577953, -2.29599410139811], [-0.22444277185217687, -2.315896604175716], [-0.23977601033024765, -2.2800550560152755], [-0.23977601033024765, -2.288227217905102], [0.07091801736139486, -2.073213402956357], [0.10156500503702187, -1.953996312211818], [0.10048880905350116, -2.040072220374118], [0.11984469884791549, -1.9917489769889904], [-0.8189319532815584, -2.6662336015448296], [-0.8189319532815584, -2.693591635083208]], [0.2414053715860288, 0.2414053715860288, 0.20255189623224007, 0.22023295122527456, 0.22023295122527456, 0.18512150936759747, 0.1512481780079028, 0.235368874841327, 0.2235195126709425, 0.2235195126709425  …  0.2428616109346579, 0.2415601831975091, 0.24527017240553126, 0.24527017240553126, 0.17202464205065018, 0.16524301552768184, 0.16547919928253005, 0.1612538945427727, 0.36720041210563026, 0.36720041210563026], 1810.7522292451977, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.6852036376302644, -2.6066981108549316], [-0.6931934639418402, -2.6935464398910085], [-0.5008185392420492, -2.5511119235572584], [-0.5825822411731556, -2.5158313711996687], [-0.5821560733475708, -2.5713340934124016], [-0.40771069633369356, -2.470777760625559], [-0.2244993608797397, -2.263567477605775], [-0.6475393966179488, -2.5361772923110095], [-0.602771904136413, -2.602939416067416], [-0.6041137537866753, -2.587209897678846]  …  [-0.6890200616254016, -2.6304717979950283], [-0.6876220926873201, -2.628683077571633], [-0.6957870215333027, -2.6040667728961555], [-0.6974214539112681, -2.568452501727172], [-0.3437246632298766, -2.404538475256596], [-0.28923425740534175, -2.2757155594945493], [-0.30752563502132246, -2.378436183521317], [-0.27850509654988265, -2.3443493262068937], [-1.3521786735905243, -2.62830809189647], [-1.3576502802982, -2.6550564346852483]], [0.38540367843188217, 0.38458308530631746, 0.3977184047343292, 0.39385865428596745, 0.3938855012596883, 0.3988990758667755, 0.3912038650494917, 0.3889610606383403, 0.39250718140881496, 0.392411855223479  …  0.38501456149777197, 0.3851577018148121, 0.3843118159748541, 0.3841396359502952, 0.39770861596453294, 0.3954191820198772, 0.3963174126755705, 0.3948317816741218, 0.25894063959764535, 0.25762283794924223], 3812.6503354621273, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.2065432598012507, -2.696564116625237], [-1.231902751920042, -2.7673199194821887], [-1.0110409239535008, -2.764317809539533], [-1.0857485154130893, -2.657164842550247], [-1.0964228920300512, -2.7485179569424125], [-0.9018662484588054, -2.734098289000437], [-0.6772128564008948, -2.5856861114673766], [-1.1547748550801509, -2.6639450778469165], [-1.1233597873498962, -2.7541185346128945], [-1.1215557333224444, -2.726707929503151]  …  [-1.2151144212244072, -2.720992195274939], [-1.2133587082016468, -2.7156540000841414], [-1.216600376112534, -2.6625179167081616], [-1.2111119542567024, -2.6298368951743227], [-0.8246323582811959, -2.682110815919001], [-0.7443773693042517, -2.5483460072784343], [-0.783212871725586, -2.648967109312843], [-0.7473749617912614, -2.6500841146308693], [-1.8778402919698185, -2.011543298533431], [-1.8886615672352498, -2.0383166079653394]], [0.07556681966902593, 0.07911921655413931, 0.05189783478993347, 0.06018188357077173, 0.06144089726385902, 0.04138093892632873, 0.025011429981322327, 0.06866522607020059, 0.06470359031357402, 0.06448122488118757  …  0.07675479216005678, 0.07651039469667076, 0.07696206346165654, 0.07619843587122731, 0.03500247004593995, 0.029228642672772708, 0.03191850947152376, 0.029429517129402026, 0.20525597273259635, 0.2078205280846418], 454.59778816386364, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.7458560831262981, -2.2593835399615285], [-1.7458560831262981, -2.2701663297461883], [-1.78536673581648, -2.3275991534015006], [-1.78536673581648, -2.331374822280432], [-1.5639044858614075, -2.563232091756996], [-1.6171814839231389, -2.3418003655116713], [-1.6461264834185338, -2.424776624755757], [-1.4486859062588926, -2.6513601128505204], [-1.1943500786943702, -2.6560155480431744], [-1.6875638706495342, -2.295474688411908]  …  [-1.3130062935881546, -2.640773599105894], [-2.2801489516765048, -0.7688348395047742], [-2.2801489516765048, -0.850798345738244], [-2.2801489516765048, -0.8033638363239093], [-2.2801489516765048, -0.8125395705737051], [-2.2801489516765048, -0.8812716220788432], [-2.296324888828318, -0.8340844827540657], [-2.296324888828318, -0.8594615950415101], [-2.296324888828318, -0.8397432406441259], [-2.296324888828318, -0.8277799028114159]], [0.11961472040341377, 0.11961472040341377, 0.1270804954909362, 0.1270804954909362, 0.08870459628226261, 0.09715218871819044, 0.10195284937283457, 0.07215932976342791, 0.043649510145610707, 0.10908204628970718  …  0.05563212977697392, 0.23765713275318778, 0.23765713275318778, 0.23765713275318778, 0.23765713275318778, 0.23765713275318778, 0.24157078131239104, 0.24157078131239104, 0.24157078131239104, 0.24157078131239104], 1066.2561271774873, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-2.1977327911186038, -1.1900606492989505], [-2.199889349075536, -1.1672387954548216], [-2.199889349075536, -1.1717027673944849], [-2.25088656649678, -1.1182527843791386], [-2.2516417002725664, -1.1584637468098264], [-2.076550904212807, -1.6369126163123204], [-2.085541557025473, -1.4145362129676322], [-2.1310818083696854, -1.4176832127148595], [-1.725553188303005, -2.2437381250773107], [-2.1466588083319156, -1.2907449379024833]  …  [-2.4564032760922734, 0.19140516524170792], [-2.463141785379131, 0.19511247427636635], [-2.463141785379131, 0.15086445261121206], [-2.46821720783662, 0.18284819736762903], [-2.46821720783662, 0.17408461803264386], [-2.46821720783662, 0.19827863926847789], [-2.464273536957143, 0.16892824686891816], [-2.464273536957143, 0.187135794275058], [-2.461880869390601, 0.18586598598727866], [-2.461880869390601, 0.21330038611652635]], [0.11957070152445935, 0.11917080068243638, 0.11917080068243638, 0.10994513280617642, 0.1098118873420963, 0.1432631405988404, 0.14142583604044298, 0.13231069450123942, 0.22261041121561592, 0.1292681218350186  …  0.07739353347633762, 0.07645305474143779, 0.07645305474143779, 0.07574997160723497, 0.07574997160723497, 0.07574997160723497, 0.07629588362494745, 0.07629588362494745, 0.07662842921433942, 0.07662842921433942], 1223.0471913170113, nothing, nothing)</code></pre><h2 id="Plotting-the-Results"><a class="docs-heading-anchor" href="#Plotting-the-Results">Plotting the Results</a><a id="Plotting-the-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-the-Results" title="Permalink"></a></h2><p>We can now plot the observations, the smoothed estimate of the position (the mean of the belief at every time step), and the true state. Note that the estimated position is much closer to the true position than the noisy measurements.</p><pre><code class="language-julia hljs">xmat = readdlm(&quot;x.txt&quot;);

plot_data = [(; t, x1=x[1], x2=x[2], y, b_mean=mean(b)[1]) for (t, (x, y, b)) in enumerate(zip(eachslice(xmat; dims=1), ys, bs))]

plot_data |&gt; @vlplot(x = :t, width = 700) +
             @vlplot(:line, y = :x1, color = {datum = &quot;True State&quot;}) +
             @vlplot(:point, y = :y, color = {datum = &quot;Observation&quot;}) +
             @vlplot(:line, y = :b_mean, color = {datum = &quot;Mean Belief&quot;})</code></pre><img src="b3864d79.svg" alt="Example block output"/><h2 id="Appendix"><a class="docs-heading-anchor" href="#Appendix">Appendix</a><a id="Appendix-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix" title="Permalink"></a></h2><h3 id="Code-for-Generating-Data"><a class="docs-heading-anchor" href="#Code-for-Generating-Data">Code for Generating Data</a><a id="Code-for-Generating-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Code-for-Generating-Data" title="Permalink"></a></h3><p>The following code can be used to generate the data in the text files:</p><pre><code class="language-julia hljs">rng = MersenneTwister(1)

k = 100
h(x, rng) = x[1] + sigma*randn(rng)

x = [3.0, 0.0]
xs = Array{typeof(x)}(undef, k)
us = zeros(k)
ys = zeros(k)
for t in 1:k
    x = f(x, us[t], rng)
    ys[t] = h(x, rng)
    xs[t] = x
end

using DelimitedFiles
writedlm(&quot;x.txt&quot;, xs)
writedlm(&quot;y.txt&quot;, ys)
writedlm(&quot;u.txt&quot;, us)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sampling/">« Sampling</a><a class="docs-footer-nextpage" href="../example-feedback/">Example: Feedback Control »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 10 February 2025 20:18">Monday 10 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
