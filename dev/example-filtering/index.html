<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example: Filtering Preexisting Data · ParticleFilters.jl</title><meta name="title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="og:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="twitter:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta name="description" content="Documentation for ParticleFilters.jl."/><meta property="og:description" content="Documentation for ParticleFilters.jl."/><meta property="twitter:description" content="Documentation for ParticleFilters.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ParticleFilters.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../bootstrap/">Bootstrap Filter</a></li><li><a class="tocitem" href="../beliefs/">Beliefs</a></li><li><a class="tocitem" href="../basic/">Basic Particle Filter</a></li><li><a class="tocitem" href="../depletion/">Handling Particle Depletion</a></li><li><a class="tocitem" href="../sampling/">Sampling</a></li><li class="is-active"><a class="tocitem" href>Example: Filtering Preexisting Data</a><ul class="internal"><li><a class="tocitem" href="#Model"><span>Model</span></a></li><li><a class="tocitem" href="#Data"><span>Data</span></a></li><li><a class="tocitem" href="#Filtering"><span>Filtering</span></a></li><li><a class="tocitem" href="#Plotting-the-Results"><span>Plotting the Results</span></a></li><li><a class="tocitem" href="#Appendix"><span>Appendix</span></a></li></ul></li><li><a class="tocitem" href="../example-feedback/">Example: Feedback Control</a></li><li><a class="tocitem" href="../example-pomdps/">Example: Use with POMDPs.jl</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl/blob/master/docs/src/example-filtering.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-Filtering-Preexisting-Data"><a class="docs-heading-anchor" href="#Example:-Filtering-Preexisting-Data">Example: Filtering Preexisting Data</a><a id="Example:-Filtering-Preexisting-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Filtering-Preexisting-Data" title="Permalink"></a></h1><p>In some cases, there is no need to perform control based on the particle belief and instead the goal is to filter a previously-generated sequence of measurements to remove noise or reconstruct hidden state variables. This tutorial will illustrate use of the <code>runfilter</code> function for that purpose.</p><p>First, we import the packages we will use. </p><pre><code class="language-julia hljs">using Distributions
using Random
using DelimitedFiles
using ParticleFilters
using VegaLite</code></pre><h2 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h2><p>We will use <a href="https://en.wikipedia.org/wiki/Euler_method">Euler-integrated</a> <a href="https://en.wikipedia.org/wiki/Van_der_Pol_oscillator">Van Der Pol Oscillator Equations</a> with noise added as the dynamics (<code>f</code>), and measurements of the position with gaussian noise added (the pdf is encoded in <code>g</code>).</p><p>This model is implemented below. For more information on defining models for particle filters, see the <a href="https://juliapomdp.github.io/ParticleFilters.jl/latest/models/">documentation</a>.</p><pre><code class="language-julia hljs">const dt = 0.2
const mu = 0.8
const sigma = 1.0

function f(x, u, rng)
    xdot = [x[2], mu * (1 - x[1]^2) * x[2] - x[1] + u + 0.1 * randn(rng)]
    return x + dt * xdot
end

g(x1, u, x2, y) = pdf(Normal(sigma), y - x2[1])</code></pre><h2 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h2><p>Suppose that the data we would like to filter are contained in text files. <a href="../u.txt"><code>u.txt</code></a> contains the control inputs, and <a href="../y.txt"><code>y.txt</code></a> contains the measurements. The code that generated this data can be found in the <a href="#Appendix">appendix below</a>.</p><pre><code class="language-julia hljs">ys = vec(readdlm(&quot;y.txt&quot;));
us = vec(readdlm(&quot;u.txt&quot;));</code></pre><h2 id="Filtering"><a class="docs-heading-anchor" href="#Filtering">Filtering</a><a id="Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering" title="Permalink"></a></h2><p>We can use an SIR particle filter to get a better estimate of the state. Note that we start with an initial belief consisting of particles with zero velocity and position uniformly distributed in <span>$[-5, 5]$</span>.</p><pre><code class="language-julia hljs">n = 10_000

fil = BootstrapFilter(f, g, n)

# construct initial belief
b0 = ParticleCollection([[10.0 * (rand() - 0.5), 0.0] for i in 1:n])

bs = runfilter(fil, b0, us, ys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100-element Vector{Any}:
 WeightedParticleBelief{Vector{Float64}}([[-1.0352562699533818, 0.22123584863086354], [-3.60094252725729, 0.7070993739008029], [2.8801324366979095, -0.579057227550357], [1.670141906358511, -0.36281663823876026], [-3.8593842092031028, 0.7614027476851345], [2.5848250472165315, -0.5033844197663964], [0.4669723384171309, -0.11664394964253176], [-0.23397318409605572, 0.06270325013025667], [1.9778344534938341, -0.3814706179789484], [4.985048788990682, -1.0066043484821565]  …  [-1.1481776944235589, 0.23375074319223355], [-0.8348877522792553, 0.17220308855511215], [-0.9553024070752592, 0.15545342544409743], [-4.31286327991973, 0.8642043057158711], [-0.8338054840227338, 0.18343216558673137], [-2.249685662231359, 0.4745122932540149], [-0.8557232625825428, 0.15140465028708633], [-3.5210982378089053, 0.7202083312328219], [2.6808510953845155, -0.5533743250341366], [-3.73236160876809, 0.7260597537972884]], [0.0011602590935647, 6.713749116089116e-9, 0.3524631047989518, 0.3095636798736364, 1.383224565018791e-9, 0.39085161226446546, 0.06371327284560598, 0.013015266001451373, 0.36759498077640324, 0.013489557828080338  …  0.0007837552830040418, 0.0022554724835141243, 0.0015199866090537819, 7.361393821295238e-11, 0.002263338320711169, 8.744998274572814e-6, 0.0021087780799713437, 1.079092373581182e-8, 0.3815641597542748, 3.0319233699596724e-9], 990.4679725249848, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[2.764320991187838, -0.45913483474186734], [2.764320991187838, -0.45410321292318745], [2.764320991187838, -0.47219030032870835], [1.597578578710759, -0.6198100699726317], [1.597578578710759, -0.5933367685872], [1.597578578710759, -0.6102976102665346], [1.597578578710759, -0.6060543305344738], [2.484148163263252, -0.5426202114783331], [2.484148163263252, -0.5456975203959133], [2.484148163263252, -0.5606163207128627]  …  [2.494985433720514, -0.5572446066436647], [2.494985433720514, -0.5694469445975215], [4.157410115570896, 0.791081186029384], [0.8757596273969462, -0.36510498412152703], [0.15485795765293356, -0.0226478733230878], [0.5792915568913554, -0.30534785568898004], [2.570176230377688, -0.5294913298678529], [2.570176230377688, -0.5484227150742875], [2.570176230377688, -0.5447875174889579], [2.570176230377688, -0.5092127042690877]], [0.2676223228115975, 0.2676223228115975, 0.2676223228115975, 0.38433212875948314, 0.38433212875948314, 0.38433212875948314, 0.38433212875948314, 0.3305256794823784, 0.3305256794823784, 0.3305256794823784  …  0.328316474381429, 0.328316474381429, 0.029206625135913693, 0.24318437175456992, 0.09153161664288906, 0.17327711938876916, 0.312377989236872, 0.312377989236872, 0.312377989236872, 0.312377989236872], 2766.3222733361927, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[2.6724940242394646, -0.49799311501936894], [2.6735003486032007, -0.5433698838823984], [2.6698829311220966, -0.5273537727177546], [1.4736165647162327, -0.8086719484060988], [1.478911224993319, -0.7890830599984486], [1.478911224993319, -0.7554790342853401], [1.475519056657452, -0.7968031266241146], [1.4763677126038643, -0.7944705475671476], [2.3756241209675855, -0.5862685341386064], [2.3756241209675855, -0.5903473081056919]  …  [2.388322924661443, -0.6221459499157687], [2.383536512391781, -0.5764495905205815], [2.3810960448010094, -0.6069310694308584], [2.3810960448010094, -0.5917683174961689], [0.8027386305726408, -0.5541659463889499], [2.4642779644041175, -0.5958587969447506], [2.4642779644041175, -0.5641989907727413], [2.4604916873628304, -0.5707863469443635], [2.4612187268798964, -0.5572816667399904], [2.4683336895238703, -0.5574599273085655]], [0.3392562776477624, 0.3390617957397384, 0.3397598124231339, 0.3272235515634056, 0.3283115066565054, 0.3283115066565054, 0.3276151201250723, 0.3277895578878646, 0.3844074378627376, 0.3844074378627376  …  0.383048894819575, 0.38356765309193563, 0.38382904005501695, 0.38382904005501695, 0.17127094606643953, 0.3737622084478873, 0.3737622084478873, 0.37427089346268116, 0.37417357839347565, 0.3732121550218495], 3230.930824890818, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[2.572895401235591, -0.586300676471315], [2.564826371826721, -0.5163436681960464], [2.5644121765785455, -0.5584482002703299], [1.311882175035013, -0.9483799420546404], [1.3210946129936292, -0.9506017781875619], [1.327815418136251, -0.9410322983875], [1.316158431332629, -0.956061897251219], [1.3174736030904348, -0.8914032004304258], [2.2583704141398644, -0.6230726048482503], [2.257554659346447, -0.6259926527035857]  …  [2.2638937346782892, -0.612690353643258], [2.2682465942876644, -0.596804128989108], [2.259709830914838, -0.611073930009943], [2.2627423813017757, -0.637133304134869], [0.6919054412948509, -0.7199236041876603], [2.3451062050151674, -0.619232117318519], [2.351438166249569, -0.6071140889288239], [2.346334417973958, -0.5945813461202498], [2.3497623935318983, -0.5756600154638737], [2.356841704062157, -0.5747992199291766]], [0.0027808277651267073, 0.0028523575637818626, 0.0028560735249309253, 0.06680590324830642, 0.06564968175410546, 0.06481535039565167, 0.06626739355644147, 0.06610240514184676, 0.007131491031787165, 0.007148012174343435  …  0.0070205067099465375, 0.006934110613108784, 0.007104436907360524, 0.007043516069543167, 0.17798188639341342, 0.005554947553939124, 0.005452945528764348, 0.005535031472399505, 0.0054797783726762556, 0.0053672118921856615], 450.3287611004663, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.122206186624085, -1.0851802356604536], [1.1309742573561168, -1.1177457651707228], [1.1309742573561168, -1.0832410630031755], [1.139608958458751, -1.064342198891818], [1.1249460518823853, -1.1059205071330767], [1.1249460518823853, -1.1401049587582872], [1.1391929630043496, -1.0576733755729293], [2.13268589564667, -0.6609615141465766], [0.25685854313486667, -0.5279960348467767], [0.25685854313486667, -0.5692693753702512]  …  [1.2334827822480738, -0.9983634820874491], [1.224311271893845, -0.9999137104443964], [1.2314881823723332, -0.9854226524198901], [1.2314881823723332, -1.0034463442221127], [2.148885768489843, -0.6699883047034223], [0.5479207204573188, -0.9169797228232368], [0.5479207204573188, -0.8983905904054491], [0.5479207204573188, -0.9261138795136419], [0.5479207204573188, -0.9324761749013215], [2.241881860076322, -0.6338610354568335]], [0.26507633706247946, 0.2671759944855986, 0.2671759944855986, 0.2692397376934786, 0.26573285833274013, 0.26573285833274013, 0.2691404079634294, 0.3966959990430537, 0.08335825077209746, 0.08335825077209746  …  0.29132635872709256, 0.28920323628011435, 0.29086538627922076, 0.29086538627922076, 0.39596169892788746, 0.13373237908700264, 0.13373237908700264, 0.13373237908700264, 0.13373237908700264, 0.38978849213491684], 2221.06482970209, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.9051701394919942, -1.282508022476755], [0.9074251043219722, -1.2569216188736674], [0.9143260447554817, -1.2711368245000654], [0.9143260447554817, -1.2234240165566448], [0.9267405186803874, -1.232717996242035], [0.9037619504557699, -1.2946510360303565], [0.8969250601307278, -1.3300365938684369], [0.9276582878897637, -1.2384679602370978], [2.000493592817355, -0.7167548247913589], [2.000493592817355, -0.7032749610864119]  …  [1.0243285298049656, -1.1842414256019544], [1.034403651888355, -1.1403200811892735], [1.034403651888355, -1.135744719040563], [1.0307989135279105, -1.1825716506577404], [2.0148881075491585, -0.712267616192532], [2.0148881075491585, -0.7183163500327643], [0.36824260237622897, -1.085020970864676], [0.36269794455459037, -1.1652376084598395], [2.1151096529849553, -0.6612161593876907], [2.1151096529849553, -0.6547579820013548]], [0.12050313794844222, 0.12092402594969463, 0.12221737706032268, 0.12221737706032268, 0.12456404592577541, 0.12024073346787213, 0.11897148069916454, 0.12473854392441654, 0.3601981239044663, 0.3601981239044663  …  0.14387656986914663, 0.145954392995545, 0.145954392995545, 0.14520924511865343, 0.3625118918789432, 0.3625118918789432, 0.0454547413154915, 0.04493177262401986, 0.37686797634710184, 0.37686797634710184], 1440.0683759693757, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.6486685349966432, -1.500075397765584], [0.6560407805472388, -1.461157508654474], [0.6600986798554687, -1.4935895361348048], [0.6696412414441528, -1.4298189905317367], [0.6801969194319805, -1.4443142192121075], [0.6448317432496986, -1.5137196697870903], [0.6799646958423441, -1.4799547522743945], [1.857142627859083, -0.7703217310762946], [1.857142627859083, -0.7599441620621961], [1.857142627859083, -0.7839898652004276]  …  [1.872434584310652, -0.7965486481360052], [1.872434584310652, -0.7813860506630523], [1.8712248375426057, -0.7764179155085372], [1.8712248375426057, -0.7590478628649354], [1.8712248375426057, -0.7401411724597813], [1.9828664211074172, -0.7152638915036673], [1.9828664211074172, -0.729406905521724], [1.9828664211074172, -0.712589762390496], [1.9841580565846844, -0.7251147360330286], [1.9841580565846844, -0.7218437927628729]], [0.39040143802377886, 0.39099005168007506, 0.3913053454845327, 0.39202235336415714, 0.39277534924270274, 0.39008706390691644, 0.39275923866869034, 0.24186671839763907, 0.24186671839763907, 0.24186671839763907  …  0.23816682480064394, 0.23816682480064394, 0.23845948151487556, 0.23845948151487556, 0.23845948151487556, 0.21160170442524812, 0.21160170442524812, 0.21160170442524812, 0.21129396031595699, 0.21129396031595699], 3491.5665149488696, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.3486534554435264, -1.768369676073676], [0.363809278816344, -1.7250195798478307], [0.3613807726285077, -1.754110178904348], [0.38367744333780546, -1.7274900341227328], [0.39133407558955896, -1.7101518777524778], [0.34208780929228055, -1.7704529300749818], [0.38397374538746515, -1.8006360316157095], [1.7030782816438241, -0.8528133847793499], [1.7051537954466438, -0.8449938306140439], [1.7003446548189975, -0.8174281555757854]  …  [1.713124854683451, -0.8800234998092383], [1.7161573741780416, -0.8127534646298465], [1.7159412544408983, -0.8236666665018982], [1.7194152649696186, -0.8333053264352333], [1.7231966030506494, -0.8043539541053332], [1.8398136428066838, -0.7713136079655756], [1.8369850400030723, -0.7656213746684126], [1.840348468629318, -0.749425452309924], [1.8391351093780786, -0.8362605466527642], [1.8397892980321098, -0.7592588674531712]], [0.2747566774630839, 0.27834465561045746, 0.2777708890151269, 0.283020808541171, 0.2848137519394044, 0.27319724274937823, 0.2830902914905757, 0.3536749826815666, 0.3533141356784265, 0.35414848315560865  …  0.3519176217598419, 0.3513819183385288, 0.3514201764701458, 0.3508037164023411, 0.3501291474757905, 0.3276419727224069, 0.32822274901000786, 0.32753198184338267, 0.32778143635876444, 0.3276469780537623], 3224.6675554390863, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.005020479771208841, -2.102377504681675], [0.018805362846777862, -2.0086915540946952], [0.010558736847638084, -2.066066530971785], [0.03817943651325889, -2.001339130153983], [0.04930370003906337, -2.0393012947408957], [-0.012002776722715824, -2.1097507113785716], [0.023846539064323213, -2.1196142885832785], [1.5325156046879542, -0.9202139489649735], [1.536155029323835, -0.8975071076059208], [1.5368590237038404, -0.9162315751552222]  …  [1.5371201547216033, -0.957518712389473], [1.5536066812520724, -0.907664161369008], [1.5512079211405188, -0.8960064007748052], [1.552754199682572, -0.9443155202744109], [1.5623258122295827, -0.9103454595262075], [1.6855509212135686, -0.8361620490769051], [1.6838607650693898, -0.8177257766876205], [1.690463378167333, -0.8406018169023662], [1.6718830000475258, -0.8870694180712436], [1.6879375245414756, -0.8274742077256315]], [0.32729867247478944, 0.3223371902011038, 0.3240667111679548, 0.318225040543095, 0.31583408442391137, 0.32873172104334497, 0.32127371957336603, 0.03814724014257786, 0.03784735639055332, 0.037789563103546815  …  0.037768143658800137, 0.03643508885836131, 0.036626699725411896, 0.03650309331121019, 0.03574528470774354, 0.02706271696519676, 0.027168993093093764, 0.026755744574414885, 0.0279319169272336, 0.026913225258233], 2129.29512931062, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.42549598070754385, -2.4462853531671565], [-0.3829329479721612, -2.3262017525679597], [-0.3829329479721612, -2.313920966459687], [-0.40265456934671895, -2.392188492703843], [-0.3620883895175377, -2.333738023170652], [-0.3620883895175377, -2.3301580833785533], [-0.3585565589091158, -2.3517698024227736], [-0.4339529189984302, -2.3935551290987385], [-0.4339529189984302, -2.4545736080780864], [-0.4000763186523325, -2.459115454378883]  …  [-0.20813922193558926, -2.1983860004442413], [-0.20813922193558926, -2.229801200064009], [-0.17698808439011143, -2.2329304415721634], [-0.18885658000049566, -2.2200929474487783], [-0.1309780071786657, -2.067682776838898], [-0.1309780071786657, -2.1485491897316313], [-0.13604095095650698, -2.1925310009509706], [-0.19448717720812475, -2.241841869318705], [1.3456164122437086, -1.0797058993775872], [1.5223430147868597, -0.9349580905231076]], [0.3182591802269015, 0.3272003527115285, 0.3272003527115285, 0.3230994073000238, 0.3314512338270422, 0.3314512338270422, 0.3321626416051644, 0.3164436751608377, 0.3164436751608377, 0.3236397507966817  …  0.35973194420443977, 0.35973194420443977, 0.3646886463241616, 0.36283366978301224, 0.37147488883349256, 0.37147488883349256, 0.3707604199684281, 0.36193911176072024, 0.21812147938896279, 0.17683822405034008], 3218.0538744531877, nothing, nothing)
 ⋮
 WeightedParticleBelief{Vector{Float64}}([[0.659417111718108, -1.6410350493824155], [0.8103577309810619, -1.44602968835357], [0.5182773735284182, -1.6484220699151821], [1.2594277037643136, -1.0851222626040062], [1.1249184540684425, -1.1824519500106336], [1.1405348243044788, -1.148717365304593], [1.0203831037763407, -1.2395698065396732], [1.0507869207377203, -1.2058432951081721], [1.196475692720843, -1.1744403276613684], [1.1120291007674252, -1.1858274161399835]  …  [0.9813723986194927, -1.3131649303305526], [0.8604490464651775, -1.43159740891915], [1.0278611676602327, -1.291632034560171], [1.0784167852785354, -1.1125702439110308], [0.9621075748692274, -1.291206596111835], [0.824473066518551, -1.396028297204389], [0.877750052190558, -1.3132439055807315], [0.9269161470486559, -1.353432239422677], [0.8779495649967385, -1.377783527479845], [0.9615740658010054, -1.2766805056285133]], [0.3284358336371754, 0.3567678977631048, 0.2977809681960454, 0.3988307425592742, 0.39398381408490746, 0.3949099404652038, 0.38541202013808973, 0.38832305825193136, 0.3974491222998335, 0.3931488172885009  …  0.3811923823274463, 0.3648586208288706, 0.38615908366718554, 0.3906742259635673, 0.3789128961068656, 0.35912064153239914, 0.3674811955562832, 0.37442510435735993, 0.36751090681520615, 0.3788479628487448], 3880.9166452846607, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.3312101018416249, -1.9417666450774027], [0.5211517933103479, -1.6614645691215701], [0.18859295954538174, -1.9612160769985976], [1.0424032512435124, -1.2329131880081976], [0.8884280640663158, -1.3476556969285565], [0.9107913512435603, -1.3033745558598828], [0.772469142468406, -1.4141646875123364], [0.8096182617160859, -1.3791770458312844], [0.9615876271885694, -1.3535220722616887], [0.8748636175394285, -1.3532698128034446]  …  [0.7187394125533821, -1.4983450297998717], [0.5741295646813475, -1.6385792276396298], [0.7695347607481985, -1.4406608747409722], [0.8559027364963292, -1.2801107734861514], [0.7038662556468603, -1.523075364859336], [0.5452674070776733, -1.6226318691329131], [0.6151012710744117, -1.5397757518300128], [0.6562296991641206, -1.5729061610140835], [0.6023928595007695, -1.6248653636314758], [0.7062379646753028, -1.4344138448139425]], [0.3273233007595646, 0.3622726941835693, 0.29620788088049876, 0.3975994699597881, 0.397913621009395, 0.39845392687556214, 0.3919675751980542, 0.3944397210297773, 0.39894194256082016, 0.3974893876429467  …  0.38747228269201117, 0.3702795525450038, 0.3917499242077578, 0.3967747704420492, 0.3860400609240206, 0.36602309836591784, 0.3758689044340198, 0.3809208323325669, 0.37419345386904046, 0.386273817553477], 3930.5498019120705, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.05714322717385567, -2.2944184389417615], [0.18885887948603386, -1.9699990204740114], [-0.20365025585433777, -2.308475851873104], [0.7958206136418728, -1.4185005133183062], [0.6188969246806044, -1.551496234532376], [0.6501164400715838, -1.5153090677857888], [0.48963620496593874, -1.6597337340872567], [0.5337828525498289, -1.6561205308864724], [0.6908832127362317, -1.5589530364762973], [0.6042096549787397, -1.5866893230980808]  …  [0.4190704065934078, -1.7844462379268335], [0.24641371915342147, -1.9454027385679746], [0.48140258580000406, -1.6675837000320766], [0.5998805817990989, -1.5406086005888802], [0.3992511826749931, -1.762819428640605], [0.22074103325109062, -1.942586094640893], [0.30714612070840913, -1.8274082679558081], [0.3416484669613038, -1.8834662812268685], [0.2774197867744743, -1.916807965965488], [0.41935519571251423, -1.6891078915425912]], [0.06318122632846726, 0.09829986964971228, 0.04718194750633874, 0.2258228068268779, 0.1840765426253458, 0.19127148550755563, 0.15543515576919575, 0.16498726396632973, 0.20079692270863195, 0.18072497832056328  …  0.14073107779933855, 0.10806159584623361, 0.1536826624634054, 0.1797414003967855, 0.1367348602808189, 0.1036353657115121, 0.11898712587398985, 0.12547276788331624, 0.11356029678979494, 0.14078894088489563], 1666.1028958501238, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.516026914962208, -2.688777722171654], [-0.20514092460876843, -2.3379333623767162], [-0.6653454262289586, -2.648459829845639], [0.5121205109782117, -1.6747883602605762], [0.3085976777741292, -1.8159766316741175], [0.347054626514426, -1.7749441781596227], [0.1576894581484874, -1.9682166460089876], [0.20255874637253446, -1.9562737012109597], [0.3790926054409722, -1.8148948277878267], [0.2868717903591235, -1.8883289879031508]  …  [0.062181159008041054, -2.1079625723682893], [-0.1426668285601735, -2.3033415627542073], [0.1478858457935887, -1.9844733098111735], [0.2917588616813228, -1.7875020411593088], [0.04668729694687207, -2.0574377376406296], [-0.16777618567708802, -2.3070145504453508], [-0.058335532882752505, -2.17408892095842], [-0.035044789284069955, -2.208627722928158], [-0.10594180641862327, -2.231679459334223], [0.08153361740399595, -1.9981941886969043]], [0.3148373882491503, 0.24220917072178513, 0.3450393964993675, 0.09147036954075016, 0.12705317151451676, 0.11978402537698608, 0.15782801288651505, 0.14832328862955504, 0.11391806701630612, 0.13126728264574467  …  0.17893318915513548, 0.22711072102627766, 0.1599416176041008, 0.13031269021916872, 0.18245670403433012, 0.23317184510561595, 0.20692678985150129, 0.20142293069621986, 0.218280317782324, 0.1745687252500971], 1486.94240104436, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.0537824593965388, -2.928503964579762], [-0.6727275970841117, -2.6687194254159095], [-1.1950373921980866, -2.745332134577237], [0.1771628389260964, -1.9673365471859416], [-0.05459764856069432, -2.138458857657278], [-0.007934209117498592, -2.1101320434294197], [-0.23595387105331017, -2.3273048702570462], [-0.18869599386965752, -2.3236975824181942], [0.016113639883406805, -2.132953208876512], [-0.09079400722150666, -2.2554037351947787]  …  [-0.3594113554656168, -2.461757522121785], [-0.603335141111015, -2.6744774182475175], [-0.249008816168646, -2.296348979118014], [-0.06574154655053899, -2.1117556311834225], [-0.36480025058125387, -2.394890683975768], [-0.6291790957661583, -2.661603265930692], [-0.49315331707443655, -2.5037450592688075], [-0.4767703338697016, -2.5359483751452365], [-0.5522776982854678, -2.5546670958528193], [-0.31810522033538496, -2.3541816218671454]], [0.3930603974100153, 0.3422989291416869, 0.3987493712857988, 0.14903603407389115, 0.20085066513409114, 0.18995833622920574, 0.2443454553817562, 0.23291470269879833, 0.18442085483723056, 0.20941378573604116  …  0.27402188289399254, 0.3286108271380557, 0.24750347617792223, 0.20347743643647126, 0.27530075493470213, 0.33383134994655467, 0.3049605501773352, 0.3012798973833423, 0.3179111460263401, 0.26415965717781253], 2311.9240578704703, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.6394832523124911, -2.64416952709194], [-1.2064714821672937, -2.761668574946904], [-1.7441038191135338, -2.3508700918712844], [-0.21630447051109192, -2.281350080877407], [-0.48228942009215, -2.4866989299443705], [-0.42996061780338257, -2.4624239378549477], [-0.7014148451047195, -2.6181345386410912], [-0.6534355103532964, -2.6714551386509657], [-0.4104770018918957, -2.5173612188073635], [-0.5418747542604624, -2.586916332267954]  …  [-0.8517628598899738, -2.717807367754401], [-1.1382306247605185, -2.8332015903203467], [-0.7082786119922488, -2.60447015634867], [-0.4880926727872235, -2.403843329634611], [-0.8437783873764075, -2.6589995984465618], [-1.1614997489522967, -2.8154960506137177], [-0.9939023289281981, -2.6646807218638515], [-0.9839600088987489, -2.7809007860679507], [-1.0632111174560317, -2.708838571600417], [-0.7889415447088141, -2.643784732913876]], [0.19022457309698781, 0.2933759437556903, 0.16656799840726977, 0.3905567300805027, 0.3982281441179478, 0.39893096333224937, 0.38371496290363416, 0.38843839063623253, 0.3989137903677367, 0.3961064606584496  …  0.3638176036706326, 0.30878036904801637, 0.38297186939524125, 0.39808312460243245, 0.36505527757177236, 0.3035976862877283, 0.33883912901934776, 0.34075297529431076, 0.32489934306158563, 0.37302698304743714], 3832.054220115287, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-2.168317157730879, -1.6048108494863882], [-1.7588051971566747, -2.3481792210704824], [-2.2142778374877907, -1.220647556456683], [-0.6725744866865734, -2.552464626996717], [-0.9796292060810241, -2.6884650947746187], [-0.9224454053743721, -2.71878751750895], [-1.2250417528329378, -2.6802537007225773], [-1.1877265380834896, -2.7584359181051044], [-0.9139492456533684, -2.7960548775019705], [-1.0592580207140532, -2.7887508364829827]  …  [-1.395324333440854, -2.6667645432583935], [-1.7048709428245878, -2.496615417691431], [-1.229172643261983, -2.6761159815598243], [-0.9688613387141457, -2.580986048362401], [-1.37557830706572, -2.598567959804379], [-1.7245989590750401, -2.4347259316846834], [-1.5268384733009683, -2.5078813036169763], [-1.540140166112339, -2.5787922349309245], [-1.6049788317761151, -2.4463880200729644], [-1.3176984912915892, -2.660570238489405]], [0.2750499136704683, 0.17767228167476065, 0.2858687355033826, 0.02473961373714917, 0.04868360504812859, 0.04322497717700424, 0.07814691699559033, 0.07300408115417742, 0.04245608401729888, 0.05713960012058947  …  0.10474900482791097, 0.16565160771539642, 0.0787313251278575, 0.04761741420008388, 0.10140066587580653, 0.17000850927234148, 0.1287658887492005, 0.13135604833133407, 0.14438110339195476, 0.09198317429220748], 723.0176630350396, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-2.489279327628157, -0.2224230960318987], [-2.489279327628157, -0.18813561469465045], [-2.489279327628157, -0.19958459669150574], [-2.489279327628157, -0.19921862415492608], [-2.2284410413707714, -1.2087247724112797], [-2.2284410413707714, -1.1890197899445116], [-2.458407348779127, -0.006470468365834758], [-2.458407348779127, -0.05038376515236331], [-2.458407348779127, -0.015342699734383736], [-2.458407348779127, -0.034942101146111515]  …  [-1.8952918990265957, -1.9421289113123519], [-2.2115441454119766, -1.3529516505221417], [-2.2115441454119766, -1.3406261715059717], [-2.0284147340243637, -1.6604351969998885], [-2.0284147340243637, -1.6882449232272836], [-2.055898613098524, -1.6765880337438936], [-2.055898613098524, -1.6846841320800885], [-2.094256435790708, -1.5044178071904537], [-2.094256435790708, -1.5024850787444528], [-1.8498125389894704, -2.1060231579853714]], [0.2876717801810431, 0.2876717801810431, 0.2876717801810431, 0.2876717801810431, 0.225171506328753, 0.225171506328753, 0.2804449693504313, 0.2804449693504313, 0.2804449693504313, 0.2804449693504313  …  0.1491649812489596, 0.22110722374696065, 0.22110722374696065, 0.17820269214226606, 0.17820269214226606, 0.18446070447036989, 0.18446070447036989, 0.19331949734363887, 0.19331949734363887, 0.13980177259793394], 1277.1415394666528, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-2.5337639468345365, 0.4903395334675207], [-2.526906450567087, 0.43792125364747336], [-2.529196246966458, 0.4688434829597816], [-2.529123052459142, 0.48177005827334607], [-2.4701859958530274, -0.016880746895237886], [-2.466244999359674, 0.005849293900992647], [-2.4597014424522943, 0.48910807776121], [-2.4684841018096, 0.468469170228872], [-2.461475888726004, 0.46249892204775733], [-2.4653957690083494, 0.4633475780707179]  …  [-2.2837176812890663, -0.7577461621785195], [-2.482134475516405, -0.07157388573481271], [-2.479669379713171, -0.06899815519545283], [-2.3605017734243416, -0.4203102486973891], [-2.3660637186698206, -0.44645100731092], [-2.3912162198473026, -0.3899483226709306], [-2.392835439514542, -0.3896919138125132], [-2.395139997228799, -0.2663518752880023], [-2.3947534515395987, -0.28234055694461335], [-2.2710171705865445, -0.9307856873148836]], [0.06707480266051585, 0.06794744703107589, 0.06765515960372757, 0.06766448872716954, 0.07547846166873025, 0.07602263702943741, 0.07693221546499102, 0.07571312506823924, 0.07668481538192672, 0.07614025727390414  …  0.10424373264243747, 0.07384528989299004, 0.07418017860269026, 0.0916507456343947, 0.09077920100577672, 0.08690662107683043, 0.08666117788851536, 0.08631265500770866, 0.08637104711812713, 0.10642695595671714], 1199.684016965601, nothing, nothing)</code></pre><h2 id="Plotting-the-Results"><a class="docs-heading-anchor" href="#Plotting-the-Results">Plotting the Results</a><a id="Plotting-the-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-the-Results" title="Permalink"></a></h2><p>We can now plot the observations, the smoothed estimate of the position (the mean of the belief at every time step), and the true state. Note that the estimated position is much closer to the true position than the noisy measurements.</p><pre><code class="language-julia hljs">xmat = readdlm(&quot;x.txt&quot;);

plot_data = [(; t, x1=x[1], x2=x[2], y, b_mean=mean(b)[1]) for (t, (x, y, b)) in enumerate(zip(eachslice(xmat; dims=1), ys, bs))]

plot_data |&gt; @vlplot(x = :t, width = 700) +
             @vlplot(:line, y = :x1, color = {datum = &quot;True State&quot;}) +
             @vlplot(:point, y = :y, color = {datum = &quot;Observation&quot;}) +
             @vlplot(:line, y = :b_mean, color = {datum = &quot;Mean Belief&quot;})</code></pre><img src="027d7875.svg" alt="Example block output"/><h2 id="Appendix"><a class="docs-heading-anchor" href="#Appendix">Appendix</a><a id="Appendix-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix" title="Permalink"></a></h2><h3 id="Code-for-Generating-Data"><a class="docs-heading-anchor" href="#Code-for-Generating-Data">Code for Generating Data</a><a id="Code-for-Generating-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Code-for-Generating-Data" title="Permalink"></a></h3><p>The following code can be used to generate the data in the text files:</p><pre><code class="language-julia hljs">rng = MersenneTwister(1)

k = 100
h(x, rng) = x[1] + sigma*randn(rng)

x = [3.0, 0.0]
xs = Array{typeof(x)}(undef, k)
us = zeros(k)
ys = zeros(k)
for t in 1:k
    x = f(x, us[t], rng)
    ys[t] = h(x, rng)
    xs[t] = x
end

using DelimitedFiles
writedlm(&quot;x.txt&quot;, xs)
writedlm(&quot;y.txt&quot;, ys)
writedlm(&quot;u.txt&quot;, us)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sampling/">« Sampling</a><a class="docs-footer-nextpage" href="../example-feedback/">Example: Feedback Control »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Friday 28 March 2025 22:00">Friday 28 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
