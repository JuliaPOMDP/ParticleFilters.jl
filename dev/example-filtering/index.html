<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example: Filtering Preexisting Data · ParticleFilters.jl</title><meta name="title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="og:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="twitter:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta name="description" content="Documentation for ParticleFilters.jl."/><meta property="og:description" content="Documentation for ParticleFilters.jl."/><meta property="twitter:description" content="Documentation for ParticleFilters.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ParticleFilters.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../bootstrap/">Bootstrap Filter</a></li><li><a class="tocitem" href="../beliefs/">Beliefs</a></li><li><a class="tocitem" href="../basic/">Basic Particle Filter</a></li><li><a class="tocitem" href="../depletion/">Handling Particle Depletion</a></li><li><a class="tocitem" href="../sampling/">Sampling</a></li><li class="is-active"><a class="tocitem" href>Example: Filtering Preexisting Data</a><ul class="internal"><li><a class="tocitem" href="#Model"><span>Model</span></a></li><li><a class="tocitem" href="#Data"><span>Data</span></a></li><li><a class="tocitem" href="#Filtering"><span>Filtering</span></a></li><li><a class="tocitem" href="#Plotting-the-Results"><span>Plotting the Results</span></a></li><li><a class="tocitem" href="#Appendix"><span>Appendix</span></a></li></ul></li><li><a class="tocitem" href="../example-feedback/">Example: Feedback Control</a></li><li><a class="tocitem" href="../example-pomdps/">Example: Use with POMDPs.jl</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl/blob/master/docs/src/example-filtering.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-Filtering-Preexisting-Data"><a class="docs-heading-anchor" href="#Example:-Filtering-Preexisting-Data">Example: Filtering Preexisting Data</a><a id="Example:-Filtering-Preexisting-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Filtering-Preexisting-Data" title="Permalink"></a></h1><p>In some cases, there is no need to perform control based on the particle belief and instead the goal is to filter a previously-generated sequence of measurements to remove noise or reconstruct hidden state variables. This tutorial will illustrate use of the <code>runfilter</code> function for that purpose.</p><p>First, we import the packages we will use. </p><pre><code class="language-julia hljs">using Distributions
using Random
using DelimitedFiles
using ParticleFilters
using VegaLite</code></pre><h2 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h2><p>We will use <a href="https://en.wikipedia.org/wiki/Euler_method">Euler-integrated</a> <a href="https://en.wikipedia.org/wiki/Van_der_Pol_oscillator">Van Der Pol Oscillator Equations</a> with noise added as the dynamics (<code>f</code>), and measurements of the position with gaussian noise added (the pdf is encoded in <code>g</code>).</p><p>This model is implemented below. For more information on defining models for particle filters, see the <a href="https://juliapomdp.github.io/ParticleFilters.jl/latest/models/">documentation</a>.</p><pre><code class="language-julia hljs">const dt = 0.2
const mu = 0.8
const sigma = 1.0

function f(x, u, rng)
    xdot = [x[2], mu * (1 - x[1]^2) * x[2] - x[1] + u + 0.1 * randn(rng)]
    return x + dt * xdot
end

g(x1, u, x2, y) = pdf(Normal(sigma), y - x2[1])</code></pre><h2 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h2><p>Suppose that the data we would like to filter are contained in text files. <a href="../u.txt"><code>u.txt</code></a> contains the control inputs, and <a href="../y.txt"><code>y.txt</code></a> contains the measurements. The code that generated this data can be found in the <a href="#Appendix">appendix below</a>.</p><pre><code class="language-julia hljs">ys = vec(readdlm(&quot;y.txt&quot;));
us = vec(readdlm(&quot;u.txt&quot;));</code></pre><h2 id="Filtering"><a class="docs-heading-anchor" href="#Filtering">Filtering</a><a id="Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering" title="Permalink"></a></h2><p>We can use an SIR particle filter to get a better estimate of the state. Note that we start with an initial belief consisting of particles with zero velocity and position uniformly distributed in <span>$[-5, 5]$</span>.</p><pre><code class="language-julia hljs">n = 10_000

fil = BootstrapFilter(f, g, n)

# construct initial belief
b0 = ParticleCollection([[10.0 * (rand() - 0.5), 0.0] for i in 1:n])

bs = runfilter(fil, b0, us, ys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100-element Vector{Any}:
 WeightedParticleBelief{Vector{Float64}}([[3.5113968341715616, -0.6688370501213339], [4.789249079441347, -0.9376127591696316], [-2.888012900290221, 0.5491753121278555], [-1.4584659494537122, 0.265745323296688], [1.5304246682730482, -0.3556193865618458], [-2.96499586798629, 0.6192309515270059], [-4.724985171332746, 0.9397759003742042], [1.573434219438783, -0.3370820274060745], [-3.7559374721044483, 0.7479171254983611], [-4.031147887617077, 0.8171147634375544]  …  [-3.4524200741704303, 0.6661991679800494], [-4.001453812695685, 0.7773780293148684], [-1.0346099527386032, 0.20606811372352973], [4.448583969393818, -0.88998777680195], [-2.7446589423874466, 0.5337569873968384], [-0.3372313807838456, 0.10103842440264908], [-3.6108743557768417, 0.7630187088573996], [-0.5478053781189718, 0.1310326721995729], [3.3370379184862795, -0.6458290181381008], [0.8137819756736298, -0.15778419971144605]], [0.2109234491967872, 0.022028692215351423, 3.708221195017503e-7, 0.00024975036802240126, 0.27751894418137296, 2.464175811232128e-7, 4.2829809651372846e-12, 0.287610516223665, 2.6241540936578966e-9, 4.665243378547741e-10  …  1.6147870477219367e-8, 5.641462761890109e-10, 0.0011628245651176658, 0.04719322370877445, 7.813172503167039e-7, 0.009881163699957922, 6.326092317137502e-9, 0.005450878465369185, 0.25293843489094225, 0.11657581310769005], 965.4128803862693, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[3.377629424147295, -0.1522482486392377], [3.377629424147295, -0.16066677557118114], [4.60172652760742, 1.3711124489195297], [1.459300790960679, -0.5801246903866789], [1.459300790960679, -0.5993347068575223], [1.459300790960679, -0.5752442929334162], [1.506017813957568, -0.5789087222608298], [1.506017813957568, -0.5498697946071376], [1.506017813957568, -0.5758201163088379], [3.3776672486619277, -0.12572129115885622]  …  [1.5603531133013544, -0.6326796811836976], [1.5603531133013544, -0.5917311344675465], [2.588685905325764, -0.5221019941946676], [2.588685905325764, -0.5368380507062166], [2.588685905325764, -0.5198136473327674], [2.588685905325764, -0.5603812395960794], [3.2078721148586595, -0.24493101606704043], [3.2078721148586595, -0.24371327751895194], [3.2078721148586595, -0.2681263174576549], [0.7822251357313406, -0.3112243211941461]], [0.12818374794320025, 0.12818374794320025, 0.009580058606655034, 0.3665643283955275, 0.3665643283955275, 0.3665643283955275, 0.3732708084372004, 0.3732708084372004, 0.3732708084372004, 0.12817644194329897  …  0.38018026555569506, 0.38018026555569506, 0.30830710782167964, 0.30830710782167964, 0.30830710782167964, 0.30830710782167964, 0.16318113215546798, 0.16318113215546798, 0.16318113215546798, 0.22060641534612122], 2730.9033541954727, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[3.3471797744194474, -0.5885945495731689], [1.3432758528833433, -0.7955132833995363], [1.3432758528833433, -0.7647902687580225], [1.3394338495891744, -0.7813072258365988], [1.3442519323739957, -0.787533224311658], [1.390236069505402, -0.7733453640408268], [1.390236069505402, -0.7503765264525932], [1.3960438550361405, -0.7342445258007475], [1.3908537906958003, -0.7856784565760913], [3.3525229904301566, -0.596694944807497]  …  [1.4338171770646149, -0.7952432956419929], [1.4338171770646149, -0.8065553056007462], [1.442006886407845, -0.7707746414485186], [2.4842655064868304, -0.5576971984953074], [2.4813182951845207, -0.5971606340421872], [2.4847231758592105, -0.587056406667791], [2.4847231758592105, -0.5741401044035327], [2.476609657406548, -0.5523781035135648], [3.1591294593548693, -0.5200354384175634], [3.1542468513671285, -0.49066938304432706]], [0.18402015358044413, 0.2988948611766166, 0.2988948611766166, 0.29802129793293614, 0.29911649839382526, 0.3094121997556625, 0.3094121997556625, 0.3106907705157671, 0.3095484354416995, 0.1827984228715815  …  0.3188738168923428, 0.3188738168923428, 0.3206158869791883, 0.37100016860691093, 0.3714154778643329, 0.3709354283185927, 0.3709354283185927, 0.3720732588322892, 0.22844578947365624, 0.2296239151372365], 3226.874301566934, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[3.2294608645048135, -0.2828002660573279], [1.184173196203436, -0.9552558771345993], [1.1903177991317389, -0.9261765192609304], [1.1831724044218546, -0.9270697440856333], [1.186745287511664, -0.9678195475015761], [1.2355669966972365, -0.9787173122242852], [1.2401607642148833, -0.9583222830041382], [1.249194949875991, -0.8662490161105137], [1.233718099380582, -0.9620969006108504], [3.2331840014686573, -0.29301454046124076]  …  [1.2747685179362163, -0.9206865546105149], [1.2725061159444655, -0.9512476659631356], [1.2878519581181413, -0.9155101064772678], [2.3727260667877688, -0.560914285711244], [2.3618861683760835, -0.6211936230657792], [2.367311894525652, -0.574114254021057], [2.369895154978504, -0.6058747083795141], [2.3661340367038353, -0.6230139318689167], [3.0551223716713567, -0.34722897923760676], [3.056112974758263, -0.42061443425288886]], [0.0002830941692428711, 0.08435824229873712, 0.08344785056903092, 0.08450715637634665, 0.08397634158148859, 0.07694989594329034, 0.07631045395031416, 0.07506375387842332, 0.07720830815019726, 0.0002791068286653138  …  0.07161228932956469, 0.07191301615812305, 0.06989067472594819, 0.00512204748769199, 0.0052882530144937635, 0.005204474691059173, 0.00516500097570653, 0.005222561469728546, 0.0005415742209329775, 0.0005396280045835809], 448.5136818076958, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.9931220207765162, -1.1198248884178714], [0.9931220207765162, -1.1583812523906742], [1.0050824952795527, -1.1087129991947462], [1.0050824952795527, -1.0947091488374314], [0.9977584556047279, -1.1128475631491976], [0.9977584556047279, -1.1039156552167793], [0.9931813780113488, -1.1384612308854298], [0.9931813780113488, -1.2194460311232203], [1.0398235342523794, -1.1306186772757694], [1.0484963076140557, -1.1308461069384137]  …  [1.4334778291567125, -0.9484099798521028], [1.4031118973575245, -1.0078039217110517], [1.4333697301240078, -0.9741659915105797], [1.117065927651224, -1.0795176776084419], [1.117065927651224, -1.0534065808710282], [1.0906312070141133, -1.1298175893309979], [1.0822565827518384, -1.1082031303291804], [1.0822565827518384, -1.0689603008400674], [1.1047499368226879, -1.0301829694684672], [1.1047499368226879, -1.0689383968522859]], [0.23391718597321137, 0.23391718597321137, 0.23680909787657373, 0.23680909787657373, 0.23503800035771252, 0.23503800035771252, 0.23393153297307223, 0.23393153297307223, 0.24521443822706637, 0.24731231762066683  …  0.3346308952948854, 0.32850823756708925, 0.3346094454629228, 0.26384366726936065, 0.26384366726936065, 0.2574869169294609, 0.2554679563777557, 0.2554679563777557, 0.26088543196157793, 0.26088543196157793], 2217.9021500655845, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.769157043092942, -1.3167638727804623], [0.7614457702983813, -1.3324733823278252], [0.7833398954406035, -1.26894178948011], [0.7861406655120664, -1.279156139280874], [0.7751889429748884, -1.311100509644115], [0.7751889429748884, -1.3225676639707655], [0.776975324561372, -1.275895557289241], [0.7654891318342628, -1.3555429147800209], [0.7492921717867047, -1.4103331613077545], [0.8136997987972255, -1.3353275816668857]  …  [1.2015511130153143, -1.1213258038782772], [1.238536531821892, -1.0918326185543477], [0.9011623921295356, -1.254633712738843], [0.9063846114770184, -1.2193834192402435], [0.8646676891479137, -1.3378342073432594], [0.8646676891479137, -1.339215902644088], [0.8606159566860023, -1.301222943744956], [0.868464522583825, -1.2611927365485975], [0.8987133429289944, -1.2010819268337172], [0.8909622574522307, -1.2272115327056645]], [0.09673415950413185, 0.0954837440617951, 0.0990614990379405, 0.099525303506227, 0.09771961030251036, 0.09771961030251036, 0.09801269495383881, 0.09613807613634806, 0.09353442586246358, 0.10416290308137095  …  0.18242864007580653, 0.19093682517809735, 0.11975720336706791, 0.12072971243324317, 0.11309003092075384, 0.11309003092075384, 0.11236387477061843, 0.11377306723931048, 0.11930271009632455, 0.11787094527901407], 1443.7984387154263, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.49495109383281627, -1.5940154641145416], [0.5295515375445814, -1.5076524253111172], [0.5129688410460653, -1.5291151160826564], [0.5106754101807353, -1.5486624011347305], [0.4943805488782586, -1.6151131304098933], [0.4672255395251538, -1.689292070875302], [0.5587488343105691, -1.5793257185501928], [0.5649398768192537, -1.5466197479850148], [0.62439558127506, -1.432436100689595], [0.5400036168134863, -1.5728930291135623]  …  [0.9704767516533627, -1.3005021603401892], [0.9772859522396589, -1.262563006272427], [1.0201700081110223, -1.2386945499371182], [0.650235649581767, -1.4921114243611535], [0.6625079276289697, -1.4342437108567012], [0.5971008476792619, -1.538568515289064], [0.6003713679370111, -1.5462963289696585], [0.6162259752741055, -1.4660646082244841], [0.658496957562251, -1.4183998726712883], [0.6455199509110978, -1.4287049253657074]], [0.37367296147144946, 0.3781532362779707, 0.37605551984200075, 0.37575818396028066, 0.37359578203292093, 0.3698015769721913, 0.38162005140631555, 0.38231735152648716, 0.3883205277644462, 0.3794278244720506  …  0.39636901256197954, 0.3960529058939031, 0.39364819962840547, 0.39052826150393793, 0.3914896114570046, 0.38572225478598315, 0.3860478329213393, 0.3875712836614583, 0.39118163273946405, 0.390143857442478], 3485.0794380552097, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.1761480010099079, -1.8709390389737144], [0.22802105248235793, -1.7720458749128487], [0.207145817829534, -1.8146046231273776], [0.20094292995378915, -1.8329492060624224], [0.17135792279627993, -1.8898351556321895], [0.12936712535009331, -2.019862485756169], [0.2428836906005305, -1.835526854392044], [0.25561592722225074, -1.8293364253574624], [0.337908361137141, -1.6785379079542648], [0.22542501099077383, -1.8699328503868118]  …  [0.7103763195853248, -1.5227543610275427], [0.7247733509851735, -1.4734508810734077], [0.7724310981235987, -1.4528924030252905], [0.35181336470953634, -1.762768762215582], [0.37565918545762944, -1.7353272853475243], [0.28938714462144904, -1.8290048956578628], [0.29111210214307937, -1.8715155566222088], [0.3230130536292087, -1.7624443006687105], [0.3748169830279933, -1.673722277150455], [0.3597789658379563, -1.6914625298427433]], [0.23323008457487163, 0.24577775744631827, 0.2407268881697368, 0.239226077343204, 0.2320727262660434, 0.22195169574428794, 0.24937206841124035, 0.2524485941258384, 0.27220306542858164, 0.24514972330843887  …  0.3517286259589276, 0.3542427121852135, 0.3621579506684861, 0.2755061374101526, 0.2811376136066583, 0.2605892247793272, 0.26100401496334363, 0.26865104000489737, 0.28093949154008285, 0.2773921931403135], 3230.04499101119, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.19803980678483502, -2.197798132922072], [-0.1263881225002118, -2.0777689140621822], [-0.15577510679594153, -2.1248625741015923], [-0.16564691125869535, -2.174453922492223], [-0.206609108330158, -2.2256621888177617], [-0.2746053718011405, -2.3861534375833684], [-0.12422168027787833, -2.1570390187232427], [-0.11025135784924178, -2.164641620597293], [0.002200779546288001, -1.973084282144527], [-0.14856155908658852, -2.164639628302767]  …  [0.4058254473798162, -1.7896312580667066], [0.4300831747704919, -1.7598566560209197], [0.4818526175185405, -1.6703617367182049], [-0.0007403877335800946, -2.071672505926994], [0.028593728388124573, -2.025755671685195], [-0.07641383451012357, -2.1614510111068257], [-0.08319100918136241, -2.2110816172802004], [-0.029475806504533464, -2.070117248554907], [0.04007252759790231, -1.9913530469567509], [0.02148645986940767, -2.0180147210029578]], [0.3627419963011815, 0.35067927987418274, 0.35579823380129744, 0.35746525255049305, 0.36408699562472807, 0.3739629677674937, 0.35029285959303913, 0.3477720281642872, 0.3258064413482654, 0.354563173989751  …  0.23228694586876528, 0.22643324510756765, 0.21400769136094355, 0.3264154479899862, 0.32026803432788126, 0.34146494116233433, 0.34275036089118543, 0.3322744488720335, 0.31781965812594226, 0.3217721749446179], 2115.116646633145, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.6375994333692494, -2.4967178455382446], [-0.6375994333692494, -2.4902322265047308], [-0.5419419053126483, -2.3732524822000256], [-0.58074762161626, -2.4392150410398825], [-0.58074762161626, -2.4047598180802665], [-0.60053769575714, -2.4615375439343414], [-0.60053769575714, -2.4602802168231253], [-0.6517415460937104, -2.5360154537367317], [-0.7518360593178142, -2.6745477022677333], [-0.7518360593178142, -2.6746285739120776]  …  [-0.4150748889189789, -2.4013865965729577], [-0.3765574059489145, -2.351549551175938], [-0.5087040367314888, -2.479878194309981], [-0.5087040367314888, -2.4780305559757405], [-0.5254073326374025, -2.5161159519495477], [-0.4434992562155149, -2.3888852431897356], [-0.4434992562155149, -2.4109398572077376], [-0.35819808179344786, -2.2939198810932226], [-0.3821164843311839, -2.336757449504554], [-0.3821164843311839, -2.2959166342618818]], [0.2698290352092693, 0.2698290352092693, 0.2923077268111363, 0.2832836790320272, 0.2832836790320272, 0.2786278243609968, 0.2786278243609968, 0.2664488057640291, 0.24231525611762256, 0.24231525611762256  …  0.32047914919489795, 0.3285098643052149, 0.29990592334381105, 0.29990592334381105, 0.2961040550560034, 0.3143797257515846, 0.3143797257515846, 0.33223470238712277, 0.32736850222679964, 0.32736850222679964], 3221.449210151216, nothing, nothing)
 ⋮
 WeightedParticleBelief{Vector{Float64}}([[0.7523339654830846, -1.4684553772794355], [1.0042741482200694, -1.240627754275294], [0.9051922680635884, -1.3825484612801586], [0.9720932018323917, -1.2795637868639984], [1.0191633314110538, -1.2607394000731353], [1.0111788356473999, -1.2934960698324125], [1.046159979583404, -1.2493654157079388], [1.057599756392415, -1.2147020721323991], [0.9073434630546489, -1.2958115361811444], [0.8866139701164719, -1.3086826593447567]  …  [0.6354456278846025, -1.581239009948331], [0.7826925396458428, -1.4744807287931698], [0.7802876195134134, -1.3837091513968858], [0.8397936212093119, -1.3935632849367792], [0.7648665528415867, -1.4072048611511905], [0.5949853273117893, -1.5652602493480001], [0.5682958867979434, -1.6315223286780847], [0.9209596566582072, -1.3310772612154058], [0.554883875692118, -1.6241129468322304], [0.7900834439525481, -1.4234234717411012]], [0.34653129996534826, 0.3837347218814057, 0.37145163071151244, 0.38011033602782746, 0.3852882574034738, 0.384464973399045, 0.3879017651454023, 0.3889290584987782, 0.3717528469946946, 0.3687893600103801  …  0.3234692775198799, 0.3519977905972287, 0.3515734407063909, 0.3616102859682499, 0.348816566100926, 0.3148455809533456, 0.30900621159162184, 0.3736249891062578, 0.30603050849243624, 0.35329234007199917], 3762.82592010603, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.4586428900271975, -1.683383642204344], [0.7561485973650106, -1.415562994330497], [0.6286825758075567, -1.5925974537270042], [0.7161804444595921, -1.5241174828701003], [0.7670154513964267, -1.4751011823050837], [0.7524796216809173, -1.497733392655043], [0.7962868964418163, -1.4178458513417898], [0.8146593419659353, -1.3923438232343932], [0.64818115581842, -1.5011412870450649], [0.6248774382475206, -1.5291971593006486]  …  [0.3191978258949362, -1.8377463685115816], [0.48779639388720886, -1.746894633377332], [0.5035457892340363, -1.645118357848729], [0.5610809642219561, -1.6374562942005038], [0.48342558061134855, -1.6812278698729934], [0.28193327744218927, -1.8495280571236061], [0.24199142106232646, -1.941506126238909], [0.654744204415126, -1.558753032005249], [0.23006128632567185, -1.894729743179919], [0.505398749604328, -1.6620129026406685]], [0.35177569230592187, 0.39071588654895856, 0.37760031184152504, 0.38723158812934605, 0.3915604667390109, 0.3904207315007127, 0.39361326175023215, 0.39473440770403145, 0.3799774705121213, 0.3771214270055209  …  0.3248357229191412, 0.356806433562538, 0.3594269073766063, 0.3683871160268241, 0.3560669286671325, 0.31694726199709056, 0.3082290090851167, 0.38074839891415774, 0.30557722377670055, 0.3597306094373554], 3827.1891943623054, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.12196616158632867, -1.9715699020219941], [0.4730359984989112, -1.657994741269917], [0.31016308506215584, -1.8972029973651228], [0.411356947885572, -1.8207636511636525], [0.4719952149354099, -1.7049690549399117], [0.45293294314990873, -1.7514385940219095], [0.5127177261734583, -1.6483745127770049], [0.5361905773190566, -1.6378464257240526], [0.34795289840940696, -1.7795012403415273], [0.3190380063873909, -1.8189218706978285]  …  [-0.0483514478073801, -2.156609457418776], [0.13841746721174242, -2.073615386549431], [0.17452211766429043, -1.9339047990412497], [0.2335897053818553, -1.9149172738974292], [0.14718000663674985, -1.9535003136760785], [-0.08797233398253196, -2.1669306917910385], [-0.14630980418545536, -2.273056150335582], [0.34299359801407625, -1.8210089072188231], [-0.148884662310312, -2.2404722549330263], [0.17299616907619425, -1.979450093246218]], [0.08769112690525657, 0.1519115566934187, 0.1195462899896912, 0.13916858682818095, 0.15169192502979684, 0.14769670281055242, 0.16039725584561604, 0.1655155153557375, 0.12667920480283643, 0.12120005259229553  …  0.06425419322975062, 0.09022639156749444, 0.09595920338355166, 0.10583618655704813, 0.09159642733105783, 0.059522022679960346, 0.053029595980833434, 0.12572962805584384, 0.052755818113214926, 0.09571221900266944], 1354.9802919972526, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.2723478188180702, -2.3354172402989866], [0.1414370502449278, -1.9416474299853514], [-0.06927751441086871, -2.23160295740794], [0.04720421765284144, -2.129505702945059], [0.13100140394742754, -2.0117930192696707], [0.10264522434552681, -1.9848062205969446], [0.18304282361805735, -1.9468285940688923], [0.20862129217424608, -1.9156063078330077], [-0.00794734965889854, -2.091546825239115], [-0.04474636775217483, -2.192510128056462]  …  [-0.47967333929113537, -2.5083927735350438], [-0.2763056100981438, -2.4725869477308144], [-0.21225884214395951, -2.284020443067641], [-0.14939374939763056, -2.2970374960545645], [-0.2435200560984659, -2.2962937907647265], [-0.5213584723407396, -2.4700432269098274], [-0.6009210342525718, -2.59281310458518], [-0.021208183429688388, -2.1560603910621396], [-0.5969791132969173, -2.5614230940170426], [-0.22289384957304936, -2.298163980620596]], [0.25844527710716875, 0.16133889705596938, 0.2095249312414917, 0.1823387437568912, 0.16361151058517684, 0.16985628412688988, 0.15242263637378245, 0.1470610236313301, 0.19507025740128756, 0.20371093204666205  …  0.3068562976869589, 0.2593981255564925, 0.24393145545790093, 0.22873304492357976, 0.25149082987857385, 0.31599009304888304, 0.33257681014126184, 0.19817184939260085, 0.3317843366529736, 0.2465043257727452], 1871.546835750995, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.7394312668778675, -2.614784747519253], [-0.24689243575214248, -2.2643266185718085], [-0.5155981058924568, -2.509468630479651], [-0.3786969229361704, -2.4548061551614437], [-0.27135719990650664, -2.3417636950378378], [-0.2943160197738621, -2.2614416522469214], [-0.2063228951957211, -2.306610683964939], [-0.17449996939235546, -2.239957048358569], [-0.42625671470672155, -2.422165435051402], [-0.4832483933634672, -2.515677022715935]  …  [-0.981351893998144, -2.718209189401134], [-0.7708229996443068, -2.8053976152220748], [-0.6690629307574878, -2.5874374669404885], [-0.6088012486085435, -2.6238358311917667], [-0.7027788142514112, -2.5878704401045147], [-1.015367117722705, -2.656995522073161], [-1.119483655169608, -2.709644047043729], [-0.45242026164211635, -2.5233892668475435], [-1.109263732100326, -2.699414864272642], [-0.6825266456971686, -2.571383593621967]], [0.35438161023307535, 0.24699161963370922, 0.3099410936100128, 0.27858893496402104, 0.2529045619019549, 0.25844148673860845, 0.23717632763524388, 0.22948644572344998, 0.28971873304580803, 0.30273965122411856  …  0.3871670589552591, 0.3596603880552811, 0.3416031326900223, 0.3297265024522719, 0.3478820823291907, 0.39017847469477823, 0.3966796462635072, 0.29574454843485803, 0.3962268026789055, 0.3441437045381464], 2796.9672400155405, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.2623882163817182, -2.655258065714452], [-0.6997577594665042, -2.5832347932569446], [-1.0174918319883872, -2.7068023912290022], [-0.8696581539684591, -2.729299931612997], [-0.7397099389140742, -2.630081331968304], [-0.7466043502232464, -2.5293299062057746], [-0.667645031988709, -2.6243914711086056], [-0.6224913790640694, -2.5254384736384754], [-0.910689801717002, -2.6533614008569084], [-0.9863837979066543, -2.7277832615258255]  …  [-1.524993731878371, -2.4980850800458754], [-1.3319025226887218, -2.8210313146380197], [-1.1865504241455855, -2.659001029334177], [-1.1335684148468967, -2.7965912212952206], [-1.2203529022723143, -2.6597324625043854], [-1.5467662221373373, -2.448964207887783], [-1.6614124645783537, -2.3782761330014806], [-0.9570981150116251, -2.781981727995476], [-1.6491467049548545, -2.3777914592842206], [-1.1968033644215619, -2.6339256005414886]], [0.2803532443195486, 0.38389187005052955, 0.33420896057985827, 0.36097527432675935, 0.37935897443521516, 0.3785210487008178, 0.38712634670495305, 0.39103775801455093, 0.35411335967232604, 0.34028851466643684  …  0.21723754957930747, 0.26381419351408264, 0.2979350223686171, 0.3098091916291805, 0.2901723018967074, 0.21203446601466147, 0.18517028029494617, 0.34580700392176666, 0.1879916775638377, 0.2955944332453537], 3544.1296674863265, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.7934398295246086, -2.1286520609819717], [-1.2164047181178932, -2.6729314035295815], [-1.5588523102341876, -2.5139687917822733], [-1.4155181402910586, -2.6668102576039394], [-1.2657262053077352, -2.666677167825272], [-1.2524703314644015, -2.5534044418061015], [-1.1925233262104302, -2.735277542573862], [-1.1275790737917646, -2.6513254506309387], [-1.4413620818883837, -2.5494398435491252], [-1.5319404502118195, -2.5217233382527975]  …  [-2.024610747887546, -1.706545998780188], [-1.8961087856163257, -2.20064592110674], [-1.718350630012421, -2.222618934678829], [-1.692886659105941, -2.465530878062426], [-1.7522993947731913, -2.21136687505977], [-2.036559063714894, -1.604252313608691], [-2.13706769117865, -1.380511405357295], [-1.5134944606107203, -2.618105398184489], [-2.1247049968116984, -1.4037395778189843], [-1.7235884845298597, -2.2103833748813413]], [0.1855627415472932, 0.0769347494727246, 0.13504773693014127, 0.10824399658270153, 0.08403436151155061, 0.08208386480302789, 0.0736514817575764, 0.06522582400900595, 0.11282037807475503, 0.129755986906311  …  0.24049393349728512, 0.20958979113799595, 0.16862341803676825, 0.16302861593043444, 0.17620441837421305, 0.24338504169575192, 0.26760576716679396, 0.12619636853093869, 0.2646453387125148, 0.16978419404147854], 1111.5157580120697, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-2.219170241721003, -1.0263718831430062], [-1.7509909988238095, -2.2344636545712175], [-2.061646068590642, -1.6477603923194923], [-1.9488801918118464, -1.902340875071972], [-1.7990616388727896, -2.1650632175745503], [-1.7631512198256218, -2.0670214749029565], [-1.7395788347252026, -2.2858519561527944], [-1.9512500505982087, -1.8289751185330179], [-2.036285117862379, -1.666276123664415], [-2.0580495616264134, -1.653566944687234]  …  [-2.357409526436632, -0.3985471777325884], [-2.357409526436632, -0.4157138416244499], [-2.4131699722501088, -0.1690460696156746], [-2.4131699722501088, -0.19188428197195617], [-2.4131699722501088, -0.1768637287959467], [-2.037115540247618, -1.7760324269814243], [-2.4054529123754955, -0.22100871399116073], [-2.4054529123754955, -0.18718384418674838], [-2.165665159506128, -1.170367325625586], [-2.165665159506128, -1.1636730018137915]], [0.22294027886197204, 0.1205702709611588, 0.185779174555403, 0.16057877586225267, 0.12972826511275623, 0.12285078756509799, 0.118452632991556, 0.16109254283749963, 0.179986635173888, 0.18495374964304762  …  0.2563343010137215, 0.2563343010137215, 0.2697172924975748, 0.2697172924975748, 0.2697172924975748, 0.1801752506762066, 0.26787392869895416, 0.26787392869895416, 0.21013513979141907, 0.21013513979141907], 1706.9496748582976, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-2.4244446183496042, 0.05230033676277346], [-2.197883729738053, -1.0977138277685559], [-2.3911981470545407, -0.3960102356591597], [-2.329348366826241, -0.6366486428325453], [-2.2320742823877, -1.0476319920650907], [-2.1765555148062132, -1.0205245025054566], [-2.1967492259557613, -1.2182109151466098], [-2.3170450743048123, -0.5896479761026086], [-2.369540342595262, -0.44731266495245636], [-2.3887629505638603, -0.3950926325626303]  …  [-2.43711896198315, 0.31580087441771854], [-2.440552294761522, 0.3880710590463905], [-2.4469791861732437, 0.4621199619972469], [-2.4515468286445, 0.4475041355879473], [-2.448542718009298, 0.4581632959171812], [-2.392322025643903, -0.49615146508016683], [-2.4496546551737275, 0.4297769915496428], [-2.4428896812128453, 0.43625265474185626], [-2.399738624631245, -0.052930728958641815], [-2.3983997598688864, -0.016225741885971923]], [0.08196322057837405, 0.1195426867269852, 0.08690936320486228, 0.09663412264919681, 0.11329645242099527, 0.12353917762175198, 0.11975334909614396, 0.09864964748610831, 0.09023721824253005, 0.08727937957875105  …  0.08012931324812107, 0.07963742890374964, 0.07872227295725961, 0.07807630410333202, 0.07850073885416224, 0.08673895123495032, 0.07834345331508659, 0.07930375168820109, 0.08562001976117076, 0.08582128839513745], 963.7832679001609, nothing, nothing)</code></pre><h2 id="Plotting-the-Results"><a class="docs-heading-anchor" href="#Plotting-the-Results">Plotting the Results</a><a id="Plotting-the-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-the-Results" title="Permalink"></a></h2><p>We can now plot the observations, the smoothed estimate of the position (the mean of the belief at every time step), and the true state. Note that the estimated position is much closer to the true position than the noisy measurements.</p><pre><code class="language-julia hljs">xmat = readdlm(&quot;x.txt&quot;);

plot_data = [(; t, x1=x[1], x2=x[2], y, b_mean=mean(b)[1]) for (t, (x, y, b)) in enumerate(zip(eachslice(xmat; dims=1), ys, bs))]

plot_data |&gt; @vlplot(x = :t, width = 700) +
             @vlplot(:line, y = :x1, color = {datum = &quot;True State&quot;}) +
             @vlplot(:point, y = :y, color = {datum = &quot;Observation&quot;}) +
             @vlplot(:line, y = :b_mean, color = {datum = &quot;Mean Belief&quot;})</code></pre><img src="9a560bc4.svg" alt="Example block output"/><h2 id="Appendix"><a class="docs-heading-anchor" href="#Appendix">Appendix</a><a id="Appendix-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix" title="Permalink"></a></h2><h3 id="Code-for-Generating-Data"><a class="docs-heading-anchor" href="#Code-for-Generating-Data">Code for Generating Data</a><a id="Code-for-Generating-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Code-for-Generating-Data" title="Permalink"></a></h3><p>The following code can be used to generate the data in the text files:</p><pre><code class="language-julia hljs">rng = MersenneTwister(1)

k = 100
h(x, rng) = x[1] + sigma*randn(rng)

x = [3.0, 0.0]
xs = Array{typeof(x)}(undef, k)
us = zeros(k)
ys = zeros(k)
for t in 1:k
    x = f(x, us[t], rng)
    ys[t] = h(x, rng)
    xs[t] = x
end

using DelimitedFiles
writedlm(&quot;x.txt&quot;, xs)
writedlm(&quot;y.txt&quot;, ys)
writedlm(&quot;u.txt&quot;, us)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sampling/">« Sampling</a><a class="docs-footer-nextpage" href="../example-feedback/">Example: Feedback Control »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Saturday 26 April 2025 16:12">Saturday 26 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
