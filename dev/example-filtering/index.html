<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example: Filtering Preexisting Data · ParticleFilters.jl</title><meta name="title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="og:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="twitter:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta name="description" content="Documentation for ParticleFilters.jl."/><meta property="og:description" content="Documentation for ParticleFilters.jl."/><meta property="twitter:description" content="Documentation for ParticleFilters.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ParticleFilters.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../bootstrap/">Bootstrap Filter</a></li><li><a class="tocitem" href="../beliefs/">Beliefs</a></li><li><a class="tocitem" href="../basic/">Basic Particle Filter</a></li><li><a class="tocitem" href="../depletion/">Handling Particle Depletion</a></li><li><a class="tocitem" href="../sampling/">Sampling</a></li><li class="is-active"><a class="tocitem" href>Example: Filtering Preexisting Data</a><ul class="internal"><li><a class="tocitem" href="#Model"><span>Model</span></a></li><li><a class="tocitem" href="#Data"><span>Data</span></a></li><li><a class="tocitem" href="#Filtering"><span>Filtering</span></a></li><li><a class="tocitem" href="#Plotting-the-Results"><span>Plotting the Results</span></a></li><li><a class="tocitem" href="#Appendix"><span>Appendix</span></a></li></ul></li><li><a class="tocitem" href="../example-feedback/">Example: Feedback Control</a></li><li><a class="tocitem" href="../example-pomdps/">Example: Use with POMDPs.jl</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl/blob/master/docs/src/example-filtering.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-Filtering-Preexisting-Data"><a class="docs-heading-anchor" href="#Example:-Filtering-Preexisting-Data">Example: Filtering Preexisting Data</a><a id="Example:-Filtering-Preexisting-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Filtering-Preexisting-Data" title="Permalink"></a></h1><p>In some cases, there is no need to perform control based on the particle belief and instead the goal is to filter a previously-generated sequence of measurements to remove noise or reconstruct hidden state variables. This tutorial will illustrate use of the <code>runfilter</code> function for that purpose.</p><p>First, we import the packages we will use. </p><pre><code class="language-julia hljs">using Distributions
using Random
using DelimitedFiles
using ParticleFilters
using VegaLite</code></pre><h2 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h2><p>We will use <a href="https://en.wikipedia.org/wiki/Euler_method">Euler-integrated</a> <a href="https://en.wikipedia.org/wiki/Van_der_Pol_oscillator">Van Der Pol Oscillator Equations</a> with noise added as the dynamics (<code>f</code>), and measurements of the position with gaussian noise added (the pdf is encoded in <code>g</code>).</p><p>This model is implemented below. For more information on defining models for particle filters, see the <a href="https://juliapomdp.github.io/ParticleFilters.jl/latest/models/">documentation</a>.</p><pre><code class="language-julia hljs">const dt = 0.2
const mu = 0.8
const sigma = 1.0

function f(x, u, rng)
    xdot = [x[2], mu * (1 - x[1]^2) * x[2] - x[1] + u + 0.1 * randn(rng)]
    return x + dt * xdot
end

g(x1, u, x2, y) = pdf(Normal(sigma), y - x2[1])</code></pre><h2 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h2><p>Suppose that the data we would like to filter are contained in text files. <a href="../u.txt"><code>u.txt</code></a> contains the control inputs, and <a href="../y.txt"><code>y.txt</code></a> contains the measurements. The code that generated this data can be found in the <a href="#Appendix">appendix below</a>.</p><pre><code class="language-julia hljs">ys = vec(readdlm(&quot;y.txt&quot;));
us = vec(readdlm(&quot;u.txt&quot;));</code></pre><h2 id="Filtering"><a class="docs-heading-anchor" href="#Filtering">Filtering</a><a id="Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering" title="Permalink"></a></h2><p>We can use an SIR particle filter to get a better estimate of the state. Note that we start with an initial belief consisting of particles with zero velocity and position uniformly distributed in <span>$[-5, 5]$</span>.</p><pre><code class="language-julia hljs">n = 10_000

fil = BootstrapFilter(f, g, n)

# construct initial belief
b0 = ParticleCollection([[10.0 * (rand() - 0.5), 0.0] for i in 1:n])

bs = runfilter(fil, b0, us, ys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100-element Vector{Any}:
 WeightedParticleBelief{Vector{Float64}}([[0.5406983004969657, -0.07270924987001122], [-4.923561220684189, 0.9799176305159416], [3.2593142268165876, -0.6497448947233218], [-4.9226934154782604, 1.001039293614219], [-4.4870629457600035, 0.9125090015288511], [-4.044246765274413, 0.8199807635676433], [0.13626493828467034, -0.03763437662336717], [3.58856112636769, -0.6806669525099491], [-1.9554074291612822, 0.3764367093928023], [0.11875796536327754, -0.008386818798088483]  …  [2.8558663116741267, -0.563483472487276], [3.7293026845190824, -0.7918916917751277], [-2.327336259925593, 0.48408603152189217], [1.1666454604662235, -0.2469380357230783], [0.13743983381385494, 6.839000341263835e-5], [2.944662036299188, -0.576044121097479], [-3.574068711254755, 0.7163048119203226], [3.5608693928160706, -0.6881780327237085], [0.2946978155749336, -0.0717294146533091], [-1.9522224189369208, 0.4079462858369645]], [0.0731777634579124, 1.0238575061771344e-12, 0.2715982437277299, 1.030369147794552e-12, 2.2586439413604015e-11, 4.288958748477643e-10, 0.032016917818433174, 0.19275106753946106, 3.273035286216105e-5, 0.030777633550671268  …  0.3566409960510174, 0.1610537071263712, 6.084735125263596e-6, 0.19052665342037856, 0.032101498909235075, 0.3406124020340601, 7.882077942420728e-9, 0.19922143385421884, 0.045131252129190384, 3.318552362638105e-5], 1005.8939164010014, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.5261564505229634, -0.24492806134826772], [3.1293652478719234, -0.30088503562798813], [3.1293652478719234, -0.29273790782794645], [3.1293652478719234, -0.2973723502370721], [3.4524277358657, -0.11141797302468504], [3.4524277358657, -0.13435093649069785], [4.016988436108214, 0.5444745599828777], [0.7734572603681454, -0.33224632464958204], [0.9705550675805776, -0.41672719831477933], [0.9705550675805776, -0.4110922675156708]  …  [2.7431696171766715, -0.5185060783891009], [3.5709243461640567, 0.08966600868182506], [1.1172578533216078, -0.4584792899940374], [1.1172578533216078, -0.4606540351570537], [0.13745351181453747, -0.0052567566891078615], [2.8294532120796925, -0.4843584674000129], [2.8294532120796925, -0.4548539670835136], [2.8294532120796925, -0.4313081203160663], [3.423233786271329, -0.10497563777777219], [3.423233786271329, -0.10610372221802411]], [0.1615571631314987, 0.18068458852090638, 0.18068458852090638, 0.18068458852090638, 0.11420040904042442, 0.11420040904042442, 0.03987039055512625, 0.21850256487151398, 0.26604002628019174, 0.26604002628019174  …  0.27266759052195494, 0.0940202310859114, 0.30034929949774125, 0.30034929949774125, 0.0888250716221108, 0.2519561287875205, 0.2519561287875205, 0.2519561287875205, 0.11954637048363656, 0.11954637048363656], 2795.6803309170823, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.4771708382533099, -0.36672364725482964], [3.070817666306334, -0.5180024028114723], [3.069890777824509, -0.49670040681938055], [3.4255575485675607, -0.5777891216998019], [0.8872096279176218, -0.6048944610652388], [0.8883366140774435, -0.6400173828106048], [0.8949524287635, -0.6093659281123822], [1.6389066450732575, -0.7162240212682263], [1.6389066450732575, -0.718084901004497], [1.6313889816080007, -0.7973598247110251]  …  [2.643792885920151, -0.5022443117280269], [2.6420557053282776, -0.5509524002304809], [2.642293718505011, -0.5272474488035681], [2.6394684014988514, -0.5141479641639057], [1.0255619953228003, -0.6808387617198288], [1.025127046290197, -0.6896559941544018], [0.13640216047671588, -0.059966802361608486], [2.73258151859969, -0.49346830226557664], [2.743191588016479, -0.5049669889949313], [3.402238658715775, -0.5962895782490281]], [0.10636416691170465, 0.2497979788394076, 0.2500220144986026, 0.1664128210372067, 0.1904764248744339, 0.19073750745587484, 0.1922724642291533, 0.3581827278576045, 0.3581827278576045, 0.3569246815077997  …  0.34470327424735364, 0.3450266328965618, 0.34498237276574406, 0.3455068629208818, 0.22322711529274486, 0.22312249045836957, 0.057668732609146886, 0.3272556649652333, 0.32505922709176044, 0.17157768472407453], 3247.26111900423, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.403826108802344, -0.5310158475710376], [2.9672171857440395, -0.4395106720571937], [2.9705506964606325, -0.4429956672437843], [3.3099997242276005, -0.29127528733424185], [0.766230735704574, -0.8155542727472194], [0.7603331375153225, -0.8502978543572264], [0.7730792431410236, -0.7886390270865725], [1.4956618408196123, -0.8454011209632633], [1.4952896648723581, -0.8403490700471802], [1.4719170166657958, -0.9215665468766098]  …  [2.5433440235745457, -0.5314924919699711], [2.5318652252821816, -0.5319380650708295], [2.5368442287442976, -0.5702544315989168], [2.53663880866607, -0.5439043045566658], [0.8893942429788346, -0.9069003625213139], [0.8871958474593166, -0.902810660535683], [0.1244088000043942, -0.1267502244328642], [2.633887858146575, -0.532122811397686], [2.642198190217493, -0.5281093302700004], [3.2829807430659694, -0.23963559798661782]], [0.2462144796392183, 0.0007425145542544831, 0.0007337855236604972, 0.00020764642242732134, 0.16149698222059453, 0.16278015307467933, 0.16001262059645732, 0.046407708392608944, 0.04644354589612427, 0.04873694911401211  …  0.0030509225730458315, 0.0031620314974376467, 0.0031133991991691267, 0.0031153922897904406, 0.13581091679092192, 0.13624959899746317, 0.31158815748386465, 0.0022902685756666474, 0.002229856960614036, 0.00023056634317800327], 455.6913529090468, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.29762293928813643, -0.6738233288117284], [0.29762293928813643, -0.7055740190583042], [0.29762293928813643, -0.6953447843676722], [0.29762293928813643, -0.689344388082074], [0.29762293928813643, -0.6820796938610518], [0.29762293928813643, -0.7130657799027316], [0.6031198811551302, -0.9926851479984451], [0.6031198811551302, -1.0317040701028302], [0.6031198811551302, -0.9647097192099424], [0.5902735666438772, -1.0984527855029071]  …  [0.70663371535218, -1.1037462285425366], [0.70663371535218, -1.134305034039194], [0.70663371535218, -1.1268291350994073], [0.09905875511782135, -0.15707080793983613], [0.09905875511782135, -0.19039771866985974], [0.09905875511782135, -0.1698444260532668], [0.09905875511782135, -0.16587971908823035], [0.09905875511782135, -0.13779020252674976], [0.09905875511782135, -0.1508069381192653], [0.09905875511782135, -0.1670497335391845]], [0.08951907411850123, 0.08951907411850123, 0.08951907411850123, 0.08951907411850123, 0.08951907411850123, 0.08951907411850123, 0.1448833491874304, 0.1448833491874304, 0.1448833491874304, 0.1422466168649512  …  0.1669847264070993, 0.1669847264070993, 0.1669847264070993, 0.06226884407457594, 0.06226884407457594, 0.06226884407457594, 0.06226884407457594, 0.06226884407457594, 0.06226884407457594, 0.06226884407457594], 2224.0708688183536, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.1565081354764756, -0.8726361584738009], [0.15975406167172163, -0.8620444755003859], [0.40458285155544116, -1.2217024999743495], [0.3967790671345641, -1.240324958249979], [0.37058300954329576, -1.3220181654816656], [0.38091677958867565, -1.3077264794997494], [0.3774332960611235, -1.2904589913304036], [0.41544195657680194, -1.2516107952721245], [0.4209851463834253, -1.1796617883285858], [1.1308680951004937, -1.0947085326500596]  …  [1.485778935643878, -0.9167073831796656], [1.485778935643878, -0.9499375726082485], [0.23562077098253298, -1.1494122074154012], [0.24351531566802345, -1.0559510176632991], [0.4827008498124239, -1.3635268142853056], [0.4907820897610866, -1.314320801841588], [0.4858844696436727, -1.3190906331982264], [0.4812678883322985, -1.361946248412326], [0.060979211383849395, -0.2123953019735176], [0.06889736749396828, -0.1831584631920256]], [0.02858804694281153, 0.028801748533845546, 0.04899899922592656, 0.04822067103780657, 0.04567688842497545, 0.04666774676314255, 0.046331905455414234, 0.05009792772409982, 0.050666055715635226, 0.16657389149811722  …  0.250016178300453, 0.250016178300453, 0.034175280453936634, 0.03477757603863629, 0.05732456091800308, 0.05824248503732526, 0.057684888808989844, 0.05716292203464772, 0.02285318647830588, 0.02328934080105689], 1442.1271983677948, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.14871407548456833, -1.4754996640886324], [0.11934149779504277, -1.5429678510162856], [0.9119263885704818, -1.2765671858367464], [0.9119263885704818, -1.2484263387723287], [0.9135816325816435, -1.3284578260749345], [0.917052084461079, -1.278993405765821], [0.8379412269505112, -1.3753679836569672], [0.8419649769185735, -1.349666716789649], [0.8814287897038566, -1.3567273785098473], [0.8807791668193676, -1.3319985039969282]  …  [1.2775057335129087, -1.0927009629666595], [1.2775057335129087, -1.1084940978895026], [1.2818386775337496, -1.079079425848911], [1.2818386775337496, -1.0601391454894253], [1.3024374590079448, -1.037498464652311], [1.3024374590079448, -1.0237043932858456], [1.2957914211222283, -1.0728548100106892], [0.005738329499452743, -1.3862972352018574], [0.227917929392769, -1.5714499249656255], [0.01850015098914587, -0.2587100068325982]], [0.3105005429181474, 0.30397897208644054, 0.3983346477615119, 0.3983346477615119, 0.3982976992041683, 0.3982167006314732, 0.39887199856879446, 0.3988988981383211, 0.3988204460344208, 0.39882676542180084  …  0.36514093366507067, 0.36514093366507067, 0.36447236750247497, 0.36447236750247497, 0.36121794765405213, 0.36121794765405213, 0.36228157006589096, 0.2777545950882101, 0.327381203572316, 0.28076457999496246], 3479.7769123933904, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.14638585733315818, -1.741576584342393], [-0.1892520724082144, -1.8115004296944777], [0.6566129514031325, -1.5066717942013614], [0.662241120816016, -1.4395321651759814], [0.6478900673666566, -1.5326457779834581], [0.6612534033079147, -1.4912559500998446], [0.5628676302191178, -1.632254357300308], [0.5720316335606437, -1.5798690948592387], [0.6100833140018871, -1.576342307428654], [0.614379466019982, -1.576242045624965]  …  [1.0589655409195768, -1.219356654027136], [1.0558069139350081, -1.2250248651227036], [1.0660227923639674, -1.2182814933875505], [1.0698108484358646, -1.1786184632823165], [1.0949377660774826, -1.189254933026909], [1.0976965803507757, -1.1818055782427517], [1.0812204591200905, -1.200675032939958], [-0.27152111754091873, -1.6035973674689823], [-0.0863720556003561, -1.871839844663171], [-0.033241850377373774, -0.3313297799552086]], [0.15851064058085285, 0.1494051636614703, 0.3418699180363183, 0.3429353322627978, 0.34020391557264107, 0.3427489025917707, 0.32309436701870653, 0.3250092761519099, 0.33278363194396154, 0.33364263064013  …  0.3942807099818789, 0.3940878468275442, 0.3946977326969879, 0.3949136439083616, 0.396204862106898, 0.3963316430985441, 0.39553038769068777, 0.13268455084308614, 0.171667587766096, 0.18367108077316538], 3219.766639295776, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.4947011742016368, -1.971920899484826], [-0.5515521583471099, -2.049623147137424], [0.35527859256286015, -1.7655079213657787], [0.37433468778081974, -1.6826096788395652], [0.3413609117699649, -1.8105084047057525], [0.3630022132879458, -1.7295875456172116], [0.23641675875905616, -1.8926907891551699], [0.25605781458879595, -1.874109131119669], [0.29481485251615624, -1.8439835058599763], [0.2991310568949889, -1.867463249714088]  …  [0.8150942101141496, -1.3666359302523445], [0.8108019409104674, -1.3560190741523568], [0.8223664936864572, -1.4138461778049727], [0.8340871557794013, -1.3598064747186034], [0.8570867794721008, -1.3696662331071547], [0.8613354647022253, -1.3332042790193688], [0.8410854525320989, -1.3951323176938164], [-0.5922405910347153, -1.7598558940266065], [-0.46074002453299034, -2.1245876951824245], [-0.0995078063684155, -0.38036286518664086]], [0.3950785184756394, 0.39758155179262444, 0.2445125860773728, 0.2399017129845965, 0.24787916908090227, 0.24264378799127395, 0.2730939515628552, 0.26841192794237567, 0.25911381561709734, 0.2580744747401469  …  0.13957002257404252, 0.14043967650603936, 0.13810305612940194, 0.1357560316138851, 0.13121333024986992, 0.13038340398040338, 0.13436490614453156, 0.39859097682880007, 0.3929843369378955, 0.34579987734135575], 2121.057173731777, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.889085354098602, -2.0656497622037415], [-0.889085354098602, -2.1177723065114686], [-0.9614767877745947, -2.1891386797520895], [-0.9614767877745947, -2.1604498303602746], [0.0021770082897044074, -2.1026449346224956], [0.03781275201290668, -2.0065048614904506], [-0.020740769171185613, -2.1310577153433377], [0.017084704164503473, -2.0413209066289455], [-0.14212139907197785, -2.2319165180043385], [-0.14212139907197785, -2.2448652670770772]  …  [0.5417670240636807, -1.5868382793547944], [0.539598126079996, -1.5898825560567915], [0.5621258608356806, -1.5534546203856954], [0.5946946088983516, -1.5438043399986299], [0.5620589889933356, -1.6108270671188272], [-0.9442117698400365, -1.8122573288211279], [-0.9442117698400365, -1.8283178621667764], [-0.8856575635694752, -2.314253411177647], [-0.17558037940574367, -0.4093876450492764], [-0.17558037940574367, -0.4360786419351921]], [0.20929966602880423, 0.20929966602880423, 0.19227425074512, 0.19227425074512, 0.3871883228339703, 0.39032956897429494, 0.38492316486450534, 0.3885593593368077, 0.3698916480295003, 0.3698916480295003  …  0.3819525162439102, 0.38219610055777925, 0.379586556578019, 0.37550829811199493, 0.37959456145663883, 0.19629793618901137, 0.19629793618901137, 0.2101149013970432, 0.3649058806939404, 0.3649058806939404], 3213.8072101543776, nothing, nothing)
 ⋮
 WeightedParticleBelief{Vector{Float64}}([[1.0222910619682892, -1.1810712282725155], [0.8111010933809334, -1.4464201193985962], [0.886657140261943, -1.3417334104639314], [0.8534718629439937, -1.4012138970683004], [0.9759204769602354, -1.3006647328404324], [0.9004761526031462, -1.3807168208375593], [0.9559649124630532, -1.3533850977295006], [0.7450144187415192, -1.4090826702946233], [0.9202819370164813, -1.338081286695791], [0.7607118320863511, -1.4443741564691113]  …  [1.2238989620849539, -1.1055431392842485], [1.148717538306305, -1.193572718962825], [1.1665573526667334, -1.1579961841777842], [1.0809732418887354, -1.1725087570091497], [1.0225830673327694, -1.2807629709468729], [1.204724505250868, -1.1590902498283608], [1.1926787230633993, -1.1328141716983349], [1.176569984507358, -1.1029896441818958], [1.1941105301999344, -1.0913674760849745], [1.2046904256554065, -1.1050538918999908]], [0.38560453798628874, 0.35689318979989637, 0.36879567167131705, 0.36377547536051763, 0.3805602319362992, 0.37078611655500265, 0.37815943247609707, 0.3451784627766103, 0.3735332219887342, 0.3480633622757085  …  0.398244357223194, 0.3953575858678552, 0.3962433085570519, 0.39087740393852716, 0.3856338866904075, 0.39771961044712595, 0.39731559087890317, 0.3966859742812333, 0.3973666120804585, 0.3977185482305835], 3958.512708609215, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.7860768163137861, -1.3812408954513011], [0.5218170695012141, -1.6906046933457513], [0.6183104581691568, -1.5582105702498237], [0.5732290835303335, -1.6445034715991862], [0.7157875303921489, -1.5122343201592916], [0.6243327884356342, -1.6093965051974486], [0.6852878929171531, -1.5602218173371096], [0.46319788468259454, -1.6642469840692529], [0.6526656796773231, -1.5770492735974022], [0.4718370007925288, -1.7077720763179438]  …  [1.0027903342281042, -1.2247636696366861], [0.9100029945137401, -1.3429161219631913], [0.9349581158311766, -1.3152226384281356], [0.8464714904869055, -1.3447101372347907], [0.7664304731433949, -1.4895285600313468], [0.9729064552851958, -1.3173778359204933], [0.9661158887237323, -1.2915430049686267], [0.9559720556709789, -1.249033886870732], [0.9758370349829395, -1.2454301839362822], [0.9836796472754084, -1.2725205407456381]], [0.3929342476386928, 0.36237846585200423, 0.3762835711723592, 0.3701506687397763, 0.38719441963808293, 0.3770524847077526, 0.38413909291028603, 0.352576755049043, 0.3805058493296721, 0.3540809042069875  …  0.3985820784624404, 0.39843825584756276, 0.39881433770422375, 0.39636672280182034, 0.39151613274325353, 0.3989105117883546, 0.39893550140546497, 0.39893856787343707, 0.3988940455895782, 0.39883313418879157], 3970.677052267653, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.5098286372235259, -1.629051025612138], [0.18369613083206382, -2.0045805518913697], [0.30666834411919197, -1.832655398611019], [0.24432838921049627, -1.9157062710617279], [0.4133406663602906, -1.749547075486086], [0.30245348739614447, -1.8707612901909734], [0.37324352944973116, -1.7957702658398116], [0.13034848786874392, -1.9667298188336053], [0.3372558249578427, -1.8434938997460075], [0.13028258552894006, -1.9677570826104942]  …  [0.757837600300767, -1.4326244770794554], [0.6414197701211019, -1.5532919152559896], [0.6719135881455495, -1.5411011146854197], [0.5775294630399473, -1.5613075449089713], [0.4685247611371255, -1.692337937429194], [0.7094308881010971, -1.5143238993934558], [0.707807287730007, -1.4545863383525326], [0.7061652782968324, -1.4854199803492139], [0.726750998195683, -1.4501165088467671], [0.7291755391262806, -1.4823843927171796]], [0.15977224452908875, 0.09745278396895617, 0.11889871571249284, 0.10769776470935512, 0.13956955080657044, 0.11812044989407472, 0.13158405749466148, 0.08897688308653595, 0.12463604724567587, 0.08896672560997172  …  0.21669867035410448, 0.1892579613177885, 0.19634750984132604, 0.1746955914777444, 0.1509606818904425, 0.20517343942254893, 0.20478936781936694, 0.2044011246608858, 0.20928137013171383, 0.2098579173727741], 2044.7001932679561, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.18401843210109825, -1.8910452942333194], [-0.21721997954621014, -2.3639985986394443], [-0.05986273560301186, -2.185329613307943], [-0.1388128650018493, -2.270998827522237], [0.06343125126307336, -2.0959252404414848], [-0.07169877064205021, -2.1732905156150846], [0.01408947628176882, -2.0850815007746055], [-0.2629974758979772, -2.3034456822686935], [-0.03144295499135885, -2.184318183434971], [-0.2632688309931588, -2.305961735340275]  …  [0.47131270488487587, -1.6714559798144297], [0.3307613870699039, -1.8107043834654313], [0.3636933652084655, -1.8191954423738528], [0.26526795405815307, -1.8364707524890191], [0.13005717365128666, -2.033312931067988], [0.4065661082224059, -1.785466099499445], [0.4168900200595005, -1.7122555229911867], [0.40908128222698964, -1.751917648817882], [0.4367276964263296, -1.7109923143073886], [0.43269866058284473, -1.720748027746641]], [0.15221642038652283, 0.24513176803741712, 0.207288966177671, 0.2261818431055804, 0.17865001567689126, 0.21010084609538, 0.1899491389538069, 0.25619209696167766, 0.20057523247250533, 0.2562575242756582  …  0.09802474133612285, 0.12283375253532494, 0.11671577771554799, 0.13553285950903962, 0.16381783194026034, 0.10902799803788898, 0.10722425395480648, 0.10858684893837894, 0.10381058388195309, 0.10449831954049893], 1111.0220267960792, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.19419062674556564, -2.2265417497520996], [-0.690019699274099, -2.689587717548166], [-0.4969286582646005, -2.5377746755962476], [-0.5930126305062967, -2.5864527385282563], [-0.3557537968252236, -2.4422394183886937], [-0.5063568737650672, -2.5020962728246574], [-0.4029268238731523, -2.434439248726499], [-0.7236866123517158, -2.5859105068515302], [-0.4683065916783531, -2.5211206804233663], [-0.7244611780612138, -2.59078491056379]  …  [0.1370215089219899, -1.9623741733031936], [-0.03137948962318238, -2.151253551490808], [-0.0001457232663050756, -2.143496140121794], [-0.10202619643965077, -2.2038998021176317], [-0.27660541256231097, -2.399547979791575], [0.049472888322516895, -2.140883791965601], [0.07443891546126313, -2.005341722479043], [0.05869775246341319, -2.0528044244907733], [0.09452923356485182, -2.0090042176092844], [0.08854905503351651, -2.0098017555053382]], [0.23424265822886464, 0.3455386703443173, 0.30580344856614805, 0.32648760128163457, 0.2731527520839, 0.30789945390212164, 0.284284997682767, 0.35163275754811324, 0.2993643639447154, 0.35176952805311384  …  0.15754527423731013, 0.19540827498237215, 0.18815883266156205, 0.21208803847929325, 0.25417152139308213, 0.17683610653708956, 0.17123976840593264, 0.17475997350080155, 0.16678972473075762, 0.16810921186394512], 1778.7009352390405, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.6394989766959855, -2.5097328136363655], [-1.2279372427837323, -2.8019561962325668], [-1.00448359338385, -2.7750076670089716], [-1.110303178211948, -2.7486492173656503], [-0.8442016805029624, -2.7055712651223622], [-1.0067761283299987, -2.7042464567972844], [-0.8898146736184522, -2.6777242020844], [-1.2408687137220218, -2.6346790682262915], [-0.9725307277630264, -2.743401373422067], [-1.2426181601739716, -2.6386248371960592]  …  [-0.2554533257386489, -2.3028126850749153], [-0.461630199921344, -2.512408616822762], [-0.4288449512906639, -2.461609294079134], [-0.5428061568631771, -2.5266712731009577], [-0.756515008520626, -2.7111015481028136], [-0.37870387007060335, -2.4752286704641584], [-0.32662942903454545, -2.356273810073629], [-0.3518631324347415, -2.4008642241075857], [-0.3072716099570051, -2.338068896117589], [-0.31341129606755114, -2.3085486054745523]], [0.38965311756151666, 0.28841326452101684, 0.3367775250923082, 0.31489234077778394, 0.3649901413885283, 0.33632755104557766, 0.3576631863671607, 0.28540076074267473, 0.3429245293663725, 0.28499197516856445  …  0.39341948277052663, 0.3986358527213814, 0.3989340675162481, 0.39606222337816654, 0.37728835908602243, 0.39856110896886454, 0.39711584385902043, 0.3979502613720521, 0.3963058322854604, 0.3965786550690225], 3916.0001848760517, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.1414455394232585, -2.6572137326580982], [-1.7883284820302456, -2.3280113091181907], [-1.5594851267856444, -2.573018987314508], [-1.660033021685078, -2.427997119895335], [-1.3853159335274348, -2.64719818946696], [-1.5476254196894557, -2.472459825769919], [-1.4253595140353323, -2.6315629753350245], [-1.76780452736728, -2.145100311898584], [-1.5212110024474397, -2.570791985144707], [-1.7703431276131836, -2.1628694459670683]  …  [-0.7160158627536319, -2.6297661145367215], [-0.9641119232858965, -2.7766825281444625], [-0.9211668101064907, -2.760398805941047], [-1.0481404114833688, -2.7145025787789367], [-1.2987353181411887, -2.737113683062283], [-0.8737496041634351, -2.7200600567509046], [-0.7978841910492713, -2.613887106383469], [-0.8320359772562587, -2.6995389644232652], [-0.7748853891805229, -2.639014493548959], [-0.7751210171624616, -2.5616440864749475]], [0.06696359275224992, 0.1843905113732755, 0.13517355441506265, 0.1559341133919853, 0.10304330537825082, 0.13282611557760166, 0.10997303796860425, 0.17971038314338517, 0.12767871759591737, 0.180286882282702  …  0.02738246932494737, 0.047152860038800405, 0.04310858063303732, 0.05589739179597684, 0.08902717511065744, 0.038961307351194, 0.03298497842948184, 0.035577884143419766, 0.031325591265650356, 0.03134224551184797], 402.25123554039686, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.6728882859548784, -2.265336966362628], [-2.253930743853884, -1.1146108895265334], [-2.253930743853884, -1.1216532304552433], [-2.253930743853884, -1.1266603305528946], [-2.253930743853884, -1.151030748008827], [-2.253930743853884, -1.1528034867308847], [-2.074088924248546, -1.678399472837678], [-2.074088924248546, -1.677408303016247], [-2.074088924248546, -1.719275737695304], [-2.145632445664145, -1.4380125720051877]  …  [-1.519448428914789, -2.633807893057984], [-1.4732465712947, -2.622601874452715], [-1.5910409272391561, -2.453909931359762], [-1.8461580547536454, -2.198695895269114], [-1.8461580547536454, -2.1742373758844242], [-1.8461580547536454, -2.164539180355489], [-1.3206616123259654, -2.581966925699644], [-1.3719437701409118, -2.6644544133523915], [-1.3026882878903145, -2.649055074375164], [-1.2874498344574512, -2.570931056773439]], [0.10652278071334159, 0.23131945382722985, 0.23131945382722985, 0.23131945382722985, 0.23131945382722985, 0.23131945382722985, 0.1886445995400697, 0.1886445995400697, 0.1886445995400697, 0.2053810219552263  …  0.08204217760513673, 0.07548959346538882, 0.09294427225326542, 0.13906292585604, 0.13906292585604, 0.13906292585604, 0.05648229325153469, 0.062427963220480935, 0.05450141859733111, 0.05286309719546022], 837.7340280885971, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-2.125955679227404, -1.247608846072118], [-2.4768529217591904, 0.05091112093430139], [-2.4768529217591904, 0.06225442755383881], [-2.4768529217591904, 0.0753647837585032], [-2.4782613899449326, 0.04382595658138522], [-2.4782613899449326, 0.06269728702813993], [-2.4782613899449326, 0.0606733695419579], [-2.479262809964463, 0.08366026917373004], [-2.479262809964463, 0.061623913747639314], [-2.479262809964463, 0.05730930250934363]  …  [-1.997766946185243, -1.8330345898793596], [-2.0818229135111084, -1.5449505626553992], [-2.285897233807468, -0.9745750890820148], [-2.285897233807468, -0.9787744911595597], [-2.28100552993053, -0.9324018843473791], [-2.28100552993053, -0.9699530906474376], [-2.279065890824743, -0.954415120833664], [-1.837054997465894, -2.030235563139541], [-1.9048346528113902, -2.0652329105254474], [-1.8324993027653473, -2.105365266054825]], [0.13332045877210427, 0.0745641053092851, 0.0745641053092851, 0.0745641053092851, 0.07437193535141977, 0.07437193535141977, 0.07437193535141977, 0.07423551437915002, 0.07423551437915002, 0.07423551437915002  …  0.15986559137356512, 0.1421842864844204, 0.1038719103715299, 0.1038719103715299, 0.10470757852413441, 0.10470757852413441, 0.10504009687485742, 0.19612749814980063, 0.18049375530550296, 0.1971931107333011], 1450.571656427021, nothing, nothing)</code></pre><h2 id="Plotting-the-Results"><a class="docs-heading-anchor" href="#Plotting-the-Results">Plotting the Results</a><a id="Plotting-the-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-the-Results" title="Permalink"></a></h2><p>We can now plot the observations, the smoothed estimate of the position (the mean of the belief at every time step), and the true state. Note that the estimated position is much closer to the true position than the noisy measurements.</p><pre><code class="language-julia hljs">xmat = readdlm(&quot;x.txt&quot;);

plot_data = [(; t, x1=x[1], x2=x[2], y, b_mean=mean(b)[1]) for (t, (x, y, b)) in enumerate(zip(eachslice(xmat; dims=1), ys, bs))]

plot_data |&gt; @vlplot(x = :t, width = 700) +
             @vlplot(:line, y = :x1, color = {datum = &quot;True State&quot;}) +
             @vlplot(:point, y = :y, color = {datum = &quot;Observation&quot;}) +
             @vlplot(:line, y = :b_mean, color = {datum = &quot;Mean Belief&quot;})</code></pre><img src="35c5df11.svg" alt="Example block output"/><h2 id="Appendix"><a class="docs-heading-anchor" href="#Appendix">Appendix</a><a id="Appendix-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix" title="Permalink"></a></h2><h3 id="Code-for-Generating-Data"><a class="docs-heading-anchor" href="#Code-for-Generating-Data">Code for Generating Data</a><a id="Code-for-Generating-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Code-for-Generating-Data" title="Permalink"></a></h3><p>The following code can be used to generate the data in the text files:</p><pre><code class="language-julia hljs">rng = MersenneTwister(1)

k = 100
h(x, rng) = x[1] + sigma*randn(rng)

x = [3.0, 0.0]
xs = Array{typeof(x)}(undef, k)
us = zeros(k)
ys = zeros(k)
for t in 1:k
    x = f(x, us[t], rng)
    ys[t] = h(x, rng)
    xs[t] = x
end

using DelimitedFiles
writedlm(&quot;x.txt&quot;, xs)
writedlm(&quot;y.txt&quot;, ys)
writedlm(&quot;u.txt&quot;, us)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sampling/">« Sampling</a><a class="docs-footer-nextpage" href="../example-feedback/">Example: Feedback Control »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Saturday 26 April 2025 16:11">Saturday 26 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
