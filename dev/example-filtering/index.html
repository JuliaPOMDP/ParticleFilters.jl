<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example: Filtering Preexisting Data · ParticleFilters.jl</title><meta name="title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="og:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="twitter:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta name="description" content="Documentation for ParticleFilters.jl."/><meta property="og:description" content="Documentation for ParticleFilters.jl."/><meta property="twitter:description" content="Documentation for ParticleFilters.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ParticleFilters.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../bootstrap/">Bootstrap Filter</a></li><li><a class="tocitem" href="../beliefs/">Beliefs</a></li><li><a class="tocitem" href="../basic/">Basic Particle Filter</a></li><li><a class="tocitem" href="../depletion/">Handling Particle Depletion</a></li><li><a class="tocitem" href="../sampling/">Sampling</a></li><li class="is-active"><a class="tocitem" href>Example: Filtering Preexisting Data</a><ul class="internal"><li><a class="tocitem" href="#Model"><span>Model</span></a></li><li><a class="tocitem" href="#Data"><span>Data</span></a></li><li><a class="tocitem" href="#Filtering"><span>Filtering</span></a></li><li><a class="tocitem" href="#Plotting-the-Results"><span>Plotting the Results</span></a></li><li><a class="tocitem" href="#Appendix"><span>Appendix</span></a></li></ul></li><li><a class="tocitem" href="../example-feedback/">Example: Feedback Control</a></li><li><a class="tocitem" href="../example-pomdps/">Example: Use with POMDPs.jl</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl/blob/master/docs/src/example-filtering.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-Filtering-Preexisting-Data"><a class="docs-heading-anchor" href="#Example:-Filtering-Preexisting-Data">Example: Filtering Preexisting Data</a><a id="Example:-Filtering-Preexisting-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Filtering-Preexisting-Data" title="Permalink"></a></h1><p>In some cases, there is no need to perform control based on the particle belief and instead the goal is to filter a previously-generated sequence of measurements to remove noise or reconstruct hidden state variables. This tutorial will illustrate use of the <code>runfilter</code> function for that purpose.</p><p>First, we import the packages we will use. </p><pre><code class="language-julia hljs">using Distributions
using Random
using DelimitedFiles
using ParticleFilters
using VegaLite</code></pre><h2 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h2><p>We will use <a href="https://en.wikipedia.org/wiki/Euler_method">Euler-integrated</a> <a href="https://en.wikipedia.org/wiki/Van_der_Pol_oscillator">Van Der Pol Oscillator Equations</a> with noise added as the dynamics (<code>f</code>), and measurements of the position with gaussian noise added (the pdf is encoded in <code>g</code>).</p><p>This model is implemented below. For more information on defining models for particle filters, see the <a href="https://juliapomdp.github.io/ParticleFilters.jl/latest/models/">documentation</a>.</p><pre><code class="language-julia hljs">const dt = 0.2
const mu = 0.8
const sigma = 1.0

function f(x, u, rng)
    xdot = [x[2], mu * (1 - x[1]^2) * x[2] - x[1] + u + 0.1 * randn(rng)]
    return x + dt * xdot
end

g(x1, u, x2, y) = pdf(Normal(sigma), y - x2[1])</code></pre><h2 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h2><p>Suppose that the data we would like to filter are contained in text files. <a href="../u.txt"><code>u.txt</code></a> contains the control inputs, and <a href="../y.txt"><code>y.txt</code></a> contains the measurements. The code that generated this data can be found in the <a href="#Appendix">appendix below</a>.</p><pre><code class="language-julia hljs">ys = vec(readdlm(&quot;y.txt&quot;));
us = vec(readdlm(&quot;u.txt&quot;));</code></pre><h2 id="Filtering"><a class="docs-heading-anchor" href="#Filtering">Filtering</a><a id="Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering" title="Permalink"></a></h2><p>We can use an SIR particle filter to get a better estimate of the state. Note that we start with an initial belief consisting of particles with zero velocity and position uniformly distributed in <span>$[-5, 5]$</span>.</p><pre><code class="language-julia hljs">n = 10_000

fil = BootstrapFilter(f, g, n)

# construct initial belief
b0 = ParticleCollection([[10.0 * (rand() - 0.5), 0.0] for i in 1:n])

bs = runfilter(fil, b0, us, ys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100-element Vector{Any}:
 WeightedParticleBelief{Vector{Float64}}([[2.8569394649900692, -0.5519949412936799], [0.5826216755873692, -0.12036855645708583], [-0.15869658700005784, 0.06442894182350228], [-3.7035457079580016, 0.7513156223164587], [-0.571102827696528, 0.1516267899705559], [4.5957217279771285, -0.9017645111117271], [-1.6892930838277953, 0.36670981985157525], [3.359409272469991, -0.654201104058], [3.9354690308329596, -0.8080476135591032], [-2.9960405132888637, 0.6659866064694419]  …  [-1.3341739692147325, 0.2803658355136388], [-1.615662348300958, 0.3249516047626701], [-4.612508357126596, 0.9185117869172443], [-4.281080345067599, 0.8535518180279742], [4.861384511840972, -0.9491806886389208], [2.1319833573923983, -0.439916889178161], [-2.3899267616589004, 0.4559150745795013], [2.8687599721515, -0.5235042288928948], [1.3977010293189085, -0.28344357812073295], [-3.257142293057751, 0.6616731466755423]], [0.3564596252946534, 0.07898223820495288, 0.015803652113886162, 3.614611075207192e-9, 0.0050898032638143085, 0.03444663398485313, 0.00010020781285591868, 0.24753184663832264, 0.1194381633819746, 2.0862488134591533e-7  …  0.0003994649299247206, 0.00013487344243834858, 9.466311378467305e-12, 9.102409909828208e-11, 0.01846957243922196, 0.38662820012731647, 4.522386800809014e-6, 0.3544409549439485, 0.24567381108403893, 4.950785807451565e-8], 1012.6154236330627, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[2.746540476731333, -0.5200890437663083], [2.746540476731333, -0.505467456337363], [2.746540476731333, -0.5044892387219408], [2.746540476731333, -0.5025613479555349], [0.5585479642959521, -0.26832944447802376], [3.2285690516583907, -0.24228208512199972], [3.2285690516583907, -0.22508514340746116], [3.2285690516583907, -0.23721711322181838], [3.773859508121139, 0.2883846041901291], [2.7835579915544737, -0.47790549820349254]  …  [4.671548374113188, 1.5320142640804462], [2.0439999795567663, -0.5772078190189085], [2.0439999795567663, -0.5927262115431383], [2.0439999795567663, -0.5827850059770876], [2.764059126372921, -0.47196023518729463], [2.764059126372921, -0.4850571553782841], [2.764059126372921, -0.5071829667254046], [2.764059126372921, -0.4690131070598842], [1.3410123136947618, -0.5142383540304892], [1.3410123136947618, -0.4865934911228831]], [0.27186535633559117, 0.27186535633559117, 0.27186535633559117, 0.27186535633559117, 0.1686604714410847, 0.15869310573299086, 0.15869310573299086, 0.15869310573299086, 0.06522822348034861, 0.26301260783674274  …  0.007897639482336887, 0.39299933214478355, 0.39299933214478355, 0.39299933214478355, 0.2676849436203814, 0.2676849436203814, 0.2676849436203814, 0.2676849436203814, 0.34671702770604135, 0.34671702770604135], 2767.9621465347295, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[2.6425226679780716, -0.4974838502185325], [2.6454469854638605, -0.5501554226700491], [2.645642628986945, -0.5370357389938462], [2.646028207140226, -0.5553900919177011], [3.180112634633991, -0.5281372255899471], [3.181125629014027, -0.5020176700750503], [2.687976891913775, -0.5142535211126644], [2.679191642449965, -0.5105704497190121], [2.6846288455975738, -0.5042162173502575], [1.4860141387870405, -0.8030634383255866]  …  [1.9254547372481385, -0.6977281491582297], [1.9254547372481385, -0.7072379755486402], [1.9274429783613487, -0.7189829267931971], [2.669667079335462, -0.5334119697051691], [2.6670476952972644, -0.5406492502622726], [2.6626225330278404, -0.5005256583895468], [2.6702565049609444, -0.5014956240410694], [1.238164642888664, -0.7039935816837719], [1.2436936154701852, -0.6798514035264647], [1.2436936154701852, -0.6902051401661661]], [0.3449397850094244, 0.3443946960144798, 0.3443581539735786, 0.3442861089632551, 0.22339054318369697, 0.2231468581843592, 0.3362386861224917, 0.3379575533699908, 0.3368957770417009, 0.32976218835554627  …  0.3926914331993077, 0.3926914331993077, 0.392829440628995, 0.3398013679949265, 0.34030479081693477, 0.34115164595100195, 0.3396878669681126, 0.274429271702033, 0.27574069417595876, 0.27574069417595876], 3246.6281669277287, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[2.543025897934365, -0.5888393273996767], [2.5354159009298507, -0.5343143725009519], [2.5382354811881758, -0.5170707502773896], [2.534950188756686, -0.5862760393504542], [3.0744851895160017, -0.381399609142404], [3.080722094999017, -0.4237041996131149], [2.5851261876912424, -0.5336601677053368], [2.5770775525061627, -0.5316927576385483], [2.5837856021275223, -0.542230286319577], [1.3254014511219232, -0.9253393223558679]  …  [1.7859091074164926, -0.8013241715712194], [1.7840071421384105, -0.8020670757009649], [1.7836463930027093, -0.7806799461237612], [2.5629846853944285, -0.532954061147211], [2.55891784524481, -0.5647082544743545], [2.562517401349931, -0.5329697250897367], [2.5699573801527307, -0.547872582642833], [1.0973659265519096, -0.8730514395591963], [1.1077233347648923, -0.8837789603550524], [1.105652587436952, -0.8757019077992807]], [0.0030539540426449707, 0.0031272812699294538, 0.0030999306342955183, 0.003131819562893939, 0.0005046842088050286, 0.0004933058155879506, 0.002675478289210051, 0.002744392457857732, 0.002686847454736213, 0.06511413518598724  …  0.024368351026120276, 0.024478144813278025, 0.02449901534158032, 0.0028689136521622086, 0.002905779341534637, 0.0028731280775047903, 0.002806683630893784, 0.09793747154601383, 0.09624688205953623, 0.096583358484294], 438.1692036378744, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.1403335866507496, -1.0543175965358471], [1.1403335866507496, -1.0684065980081132], [1.1673514878428306, -1.0715903893509715], [1.1691488642417232, -1.0230871787880618], [1.1691488642417232, -1.083894587395221], [1.1500116331404735, -1.053695080551025], [1.7443898691298798, -0.8114914841781227], [1.7398356738625205, -0.8126157273218516], [0.5625467642467465, -0.9280097404199887], [0.5625467642467465, -0.9418096513762653]  …  [0.38342386080321994, -0.7853451691612722], [1.6256442731022487, -0.8724154289791656], [1.627510403777957, -0.830498261274966], [0.9227556386400703, -1.0823029597643414], [0.9227556386400703, -1.0645237601441397], [0.9309675426938817, -1.0634565333664705], [0.9309675426938817, -1.077535636991377], [0.9309675426938817, -1.0703663256206495], [0.9305122058770959, -1.0893158616561898], [0.9305122058770959, -1.0753173660773472]], [0.2694127377277667, 0.2694127377277667, 0.27583964052173165, 0.27626543750794025, 0.27626543750794025, 0.2717203118684951, 0.38338779677020834, 0.38289171572837116, 0.13664116110387278, 0.13664116110387278  …  0.1034515072656213, 0.36815617023053393, 0.36843097382027185, 0.2169750088000168, 0.2169750088000168, 0.2189430447439548, 0.2189430447439548, 0.2189430447439548, 0.21883384080187185, 0.21883384080187185], 2219.4870136216796, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.9294700673435802, -1.2226327330054896], [0.926652267049127, -1.2582843038049154], [0.926652267049127, -1.2374097683543308], [0.9530334099726363, -1.2188056662047693], [0.9645314284841108, -1.2066817401516794], [0.9523699467626789, -1.2637976577843608], [0.9392726170302685, -1.2487202814446843], [0.9392726170302685, -1.2600370183257963], [1.5820915722942552, -0.9091571156893444], [1.5773125283981502, -0.8889371421328384]  …  [1.4511611873064156, -0.9512011778843764], [1.4511611873064156, -0.9598501519720578], [1.461410751522964, -0.9028672916682722], [0.706295046687202, -1.2740486145568077], [0.7098508866112423, -1.2782884463464017], [0.7182762360205877, -1.284710512647949], [0.7154604152956063, -1.2843732326099833], [0.7168942775697518, -1.265525637373717], [0.712649033545858, -1.3173649422397444], [0.7154487326616265, -1.3097369006888486]], [0.12508343120816126, 0.12454727374067112, 0.12454727374067112, 0.129617968794608, 0.13186338292413627, 0.12948905370761254, 0.12695880468629617, 0.12695880468629617, 0.273143321985225, 0.2720063539265698  …  0.24164268921005838, 0.24164268921005838, 0.24412272661972423, 0.08684903814866293, 0.08738943383749051, 0.08867885362812061, 0.0882465130154565, 0.08846649158846738, 0.08781626215982026, 0.08824472220628032], 1455.689021725033, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.6849435207424822, -1.438585134322441], [0.6749954062881438, -1.4212520840663325], [0.6791703133782607, -1.50667752367264], [0.7092722767316825, -1.4521636258390442], [0.7231950804537749, -1.3980765931147578], [0.6895285607413317, -1.4612073281510818], [0.6872652133651093, -1.444785764934652], [1.4002601491563864, -1.013707302217929], [1.4002601491563864, -0.9721491552639888], [1.3995250999715825, -1.0202904753384652]  …  [0.03020278577031385, -1.1848150469078353], [1.2609209517295403, -1.0715933444488208], [1.2609209517295403, -1.0870196732505872], [1.259191156912004, -1.0920777428201578], [1.2808372931893095, -1.0560212476879582], [1.2808372931893095, -1.0219043900781546], [0.45148532377584044, -1.5008895151464627], [0.46133413349099783, -1.538175414568661], [0.4637891500950084, -1.4867886053907766], [0.44917604509790904, -1.5670311511208912]], [0.3931001458258081, 0.39240957968983425, 0.39270397303929444, 0.39462951657747647, 0.39540211323216984, 0.39340572603748636, 0.3932558837677705, 0.34415594548893663, 0.34415594548893663, 0.3442933819648233  …  0.28351282074405415, 0.36764751158991277, 0.36764751158991277, 0.36790410915726507, 0.3646273788506137, 0.3646273788506137, 0.3674958744680654, 0.368947589993824, 0.3693047740426826, 0.3671511599035759], 3458.7987802704165, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.397226493877994, -1.7013727466493151], [0.3907449894748773, -1.6791096846926825], [0.3778348086437327, -1.7264505286309257], [0.4188395515638736, -1.6725726885126324], [0.4435797618308233, -1.6667632581992384], [0.3972870951111154, -1.752978150756869], [0.39830806037817884, -1.6904047747277384], [1.1975186887128006, -1.1124185561138318], [1.2058303181035885, -1.1216256816195906], [1.1954670049038894, -1.131754972536639]  …  [-0.20676022361125324, -1.378794907036816], [1.046602282839776, -1.1780275371467865], [1.0435170170794228, -1.2074101119860745], [1.0407756083479724, -1.258595510166507], [1.0696330436517179, -1.205817404915723], [1.0764564151736786, -1.1595204612656043], [0.15130742074654785, -1.7517964112089082], [0.15369905057726563, -1.8343308228179973], [0.16643142901685304, -1.773186140408661], [0.1357698148737308, -1.8400651068841987]], [0.28618987762413084, 0.28467599662312326, 0.28164913560146804, 0.29120802399799295, 0.2968900509328995, 0.2862040134045149, 0.28644210954164406, 0.39889878161272563, 0.3989339665786643, 0.3988858562325199  …  0.14576128090816493, 0.3935039666567043, 0.39330099510782995, 0.3931175931506651, 0.394903633517375, 0.39527900856732634, 0.22723361968374275, 0.22781029853513066, 0.23088287226535736, 0.22349138546417124], 3226.566176615821, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.05695194454813096, -2.039909095165385], [0.05492305253634078, -2.0061984968584845], [0.03254470291754752, -2.062549854669503], [0.08432501386134711, -1.9509431720693535], [0.11022711019097559, -1.9902091557255797], [0.04669146495974158, -2.068274340976793], [0.060227105432631156, -2.006643721257901], [0.9750349774900343, -1.2875455723048794], [0.9815051817796704, -1.2994755228401882], [0.9691160103965616, -1.316593004543541]  …  [-0.48251920501861645, -1.5501591318891954], [0.8109967754104188, -1.3844256800818289], [0.8020349946822078, -1.4014193555253447], [0.7890565063146711, -1.4410924235387534], [0.8284695626685732, -1.3742321599827778], [0.8445523229205578, -1.3187800512841794], [-0.1990518614952338, -2.0630401855235996], [-0.21316711398633387, -2.1497581522019065], [-0.18820579906487922, -2.1022982564085853], [-0.23224320650310898, -2.16901782796311]], [0.3141781090432025, 0.3146183442403836, 0.3194279380183535, 0.30817444905197244, 0.30239038038660215, 0.31639743503814644, 0.313466031325423, 0.10928641399539388, 0.10815214348410264, 0.11033041927296941  …  0.39437836206304333, 0.14040014010650345, 0.1422246734233214, 0.1448884539311615, 0.1368782632911789, 0.13367862384355406, 0.3629019725788165, 0.3651015682258539, 0.3611719323329802, 0.36797890252901966], 2086.2082425792705, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.3510298744849461, -2.3827479110349428], [-0.3510298744849461, -2.357306696234041], [-0.3463166468353561, -2.356296671220462], [-0.3799652680163531, -2.384744112163455], [-0.3799652680163531, -2.434316008223388], [-0.30586362055252364, -2.310464630551427], [-0.28781472095414035, -2.3280330719818316], [-0.28781472095414035, -2.3564824689836996], [-0.3669634032356171, -2.426311904706986], [-0.34110163881894906, -2.3318744974167847]  …  [0.5217511235771388, -1.671840474577337], [0.5008380216069204, -1.6751764566814], [0.5807963126637219, -1.570118804639004], [-0.6116598985999537, -2.366066322075623], [-0.6116598985999537, -2.3227442720395803], [-0.6431187444267152, -2.4490986354687134], [-0.6431187444267152, -2.43564876442717], [-0.6086654503465962, -2.3722485435399645], [-0.666046772095731, -2.446445653415541], [-0.666046772095731, -2.480283742019169]], [0.33366993460963923, 0.33366993460963923, 0.3346076338912002, 0.32781090964699067, 0.32781090964699067, 0.3424519373971942, 0.3458282714179863, 0.3458282714179863, 0.3304650025199367, 0.33563954477654134  …  0.38413774899637393, 0.3862689407774156, 0.3772922037717263, 0.2759974099454416, 0.2759974099454416, 0.2685111336621771, 0.2685111336621771, 0.2767065151416045, 0.2630191449974047, 0.2630191449974047], 3205.088299834574, nothing, nothing)
 ⋮
 WeightedParticleBelief{Vector{Float64}}([[0.748166066583061, -1.4631942983838517], [1.0879646507243939, -1.175384557059741], [1.0229193759842456, -1.2761968075862553], [1.1166611065228234, -1.209573691748925], [1.1054121357360698, -1.2028760051654046], [1.032846692628147, -1.2497967090918756], [1.082121711348787, -1.1912326416877779], [1.2190731016227816, -1.085955052918251], [1.1884048113848318, -1.1094559685051848], [1.1512018866116047, -1.1711936907408]  …  [1.0908540587829294, -1.2234181442644836], [0.9545172207953283, -1.2862964311107274], [0.9610873864790133, -1.311085839978158], [1.1113328984167283, -1.1831741834371226], [0.983242105728927, -1.3043134221561081], [0.7200488270100562, -1.5391952107484184], [0.932551293204655, -1.295333483470332], [0.9746363733582502, -1.2521925616525937], [0.8646302253896594, -1.3817719658706642], [0.8761422264376117, -1.340514230161751]], [0.345762589195288, 0.3914205312914032, 0.3856676502239563, 0.3934562079185159, 0.3926955014578751, 0.3866459324550948, 0.39096788277033345, 0.39812600662982023, 0.39715849018296145, 0.395488355184137  …  0.39163962455391965, 0.377979999070079, 0.3787886448976661, 0.3931019073443287, 0.38140680600656984, 0.34046655528167535, 0.37517137833572206, 0.38040984747671774, 0.36550073001597017, 0.3672413137395506], 3919.052538397586, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.4555272069062906, -1.7162822643545355], [0.8528877393124457, -1.3383174273056675], [0.7676800144669946, -1.444818120191544], [0.8747463681730383, -1.3985941008498541], [0.8648369347029888, -1.3943140574424056], [0.7828873508097719, -1.4319999277116784], [0.8438751830112315, -1.3884627863471537], [1.0018820910391315, -1.279584345145914], [0.9665136176837948, -1.2847789803600929], [0.9169631484634447, -1.334026518454211]  …  [0.8461704299300327, -1.4296802601582905], [0.6972579345731829, -1.5087667674367682], [0.6988702184833817, -1.5247377075642168], [0.8746980617293039, -1.3605624179767473], [0.7223794212977054, -1.4830404417319227], [0.4122097848603725, -1.7990050060467955], [0.6734845965105887, -1.4966130023314463], [0.7241978610277313, -1.4715065179741895], [0.5882758322155266, -1.6115867686804735], [0.6080393804052615, -1.5715412082910445]], [0.351224605082921, 0.3966481159559497, 0.3916106757578142, 0.3974854037783244, 0.39712911858569644, 0.39271398283438225, 0.39624827900699394, 0.39859730125119225, 0.39893454486876345, 0.39856807106570813  …  0.3963531235176409, 0.38537805306759726, 0.38554101630945786, 0.3974837608583241, 0.38781054152409966, 0.34330623455887627, 0.3828675713010738, 0.38797771062313785, 0.3722705536090742, 0.37494443089622337], 3954.819410068534, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.1122707540353835, -2.0222134733337143], [0.5852242538513122, -1.563143477627295], [0.4787163904286858, -1.7194419988069833], [0.5950275480030675, -1.631400317175903], [0.5859741232145077, -1.6095049314393932], [0.4964873652674362, -1.6599976857748475], [0.5661826257418008, -1.6141397683421275], [0.7459652220099486, -1.4647291513142122], [0.7095578216117763, -1.4537708091368762], [0.6501578447726025, -1.5817401919792708]  …  [0.5602343778983745, -1.6547152892291879], [0.3955045810858292, -1.7653936052610424], [0.39392267697053834, -1.748971940034691], [0.6025855781339544, -1.5714559387166476], [0.4257713329513208, -1.72033298988817], [0.052408783651013424, -2.1601838024967224], [0.3741619960442994, -1.772738802796933], [0.4298965574328934, -1.7241433782330788], [0.2659584784794319, -1.889553208908042], [0.2937311387470526, -1.858842473976347]], [0.08621955827579462, 0.17642646081575225, 0.15311295633086808, 0.1786411595172618, 0.17659549191946539, 0.15690051336126515, 0.17215556478158683, 0.21385976679429217, 0.2052034737855066, 0.19128108831797583  …  0.1708300314658724, 0.13598626944425338, 0.1356708566518713, 0.1803557502669653, 0.14209583320832445, 0.0775035672518261, 0.1317641285593889, 0.1429393856823941, 0.11150834299620119, 0.11651945076123257], 1823.7714479091478, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.2921719406313594, -2.3658501615991208], [0.27259555832585314, -1.8160156513380858], [0.13482799066728912, -2.005990610326609], [0.26874748456788683, -1.9257872924942647], [0.26407313692662904, -1.8866151536167242], [0.16448782811246665, -1.9701606005303285], [0.24335467207337524, -1.9135341512277149], [0.4530193917471062, -1.6752192166554463], [0.41880365978440104, -1.7270238552768724], [0.33380980637674834, -1.8453199363394388]  …  [0.22929132005253688, -1.9872026498695663], [0.0424258600336207, -2.07854297929176], [0.044128288963600104, -2.02658974953626], [0.2882943903906249, -1.8699969193147732], [0.08170473497368674, -2.059856092039564], [-0.37962797684833105, -2.511449221917929], [0.019614235484912756, -2.113762198639787], [0.08506788178627761, -2.0586848880823236], [-0.11195216330217655, -2.2365897760481905], [-0.07803735604821682, -2.2088255043742766]], [0.2632119887677011, 0.1340777581199875, 0.16277654403364394, 0.13484084529892273, 0.13577092560430487, 0.1563699195558828, 0.13993442371610898, 0.10105879246645014, 0.10689195356577645, 0.12225977925394009  …  0.1427981174760352, 0.1834302001380712, 0.18304106912782997, 0.13098900950225345, 0.17453032110223418, 0.2839771950017114, 0.18867209760935164, 0.17377620519700201, 0.2197219079839673, 0.21161016122726353], 1322.088193355643, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.7653419729511836, -2.643536122666732], [-0.09060757194176405, -2.1626586662679563], [-0.2663701313980327, -2.3632680872110994], [-0.11640997393096614, -2.2450080429566013], [-0.1132498937967158, -2.2288686726754223], [-0.22954429199359905, -2.298895739551032], [-0.13935215817216773, -2.2051993639674485], [0.11797554841601693, -1.9755711476341462], [0.07339888872902656, -2.0250012157725292], [-0.035254180891139464, -2.173517852029508]  …  [-0.16814920992137639, -2.3300691924656554], [-0.37328273582473126, -2.4454077546013635], [-0.36118966094365196, -2.3842156554562246], [-0.0857049934723298, -2.207556429877655], [-0.33026648343422604, -2.4033600877830756], [-0.8819178212319169, -2.7985646139188236], [-0.4031382042430447, -2.4320112860268157], [-0.32666909583018716, -2.381446887869315], [-0.5592701185118147, -2.584234632580128], [-0.5198024569230721, -2.5386068470684284]], [0.35875854921301936, 0.2093694604986309, 0.2517000729713934, 0.21552286638299803, 0.21476731480783662, 0.24279459814204832, 0.22102226834007965, 0.16165981299776003, 0.17147145750999357, 0.19631350701590827  …  0.2279542822469345, 0.2773095732139374, 0.2744441265250115, 0.20820462980521975, 0.2670731463266729, 0.37599373749157966, 0.28433446434734616, 0.26621208531948437, 0.3194048454560287, 0.3108656376905355], 2082.795329245797, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.2940491974845298, -2.6692504231053955], [-0.5231393051953553, -2.511054889676655], [-0.7390237488402526, -2.6787464007056756], [-0.5654115825222864, -2.5787902195041434], [-0.5590236283318003, -2.5717247516956863], [-0.6893234399038055, -2.6140725839977232], [-0.5803920309656574, -2.5593760841363657], [-0.27713868111081236, -2.297049893351291], [-0.33160135442547933, -2.373888298496907], [-0.46995775129704115, -2.519584838335316]  …  [-0.6341630484145075, -2.690589913793849], [-0.862364286745004, -2.692796670295345], [-0.8380327920348969, -2.6564993774316337], [-0.5272162794478608, -2.5386759720428573], [-0.8109385009908412, -2.6929151051207856], [-1.4416307440156815, -2.725724800482436], [-0.8895404614484079, -2.6686195616201416], [-0.8029584734040502, -2.670072610644044], [-1.0761170450278406, -2.744590354858568], [-1.0275238263367579, -2.7486704171760925]], [0.2728590141832135, 0.3969242236526555, 0.37944148643472514, 0.3948850195493991, 0.3952377966558194, 0.3849834057721974, 0.39399588764949584, 0.3947537736220347, 0.3973001263942772, 0.3984919193097059  …  0.39009915047991656, 0.3621450777907271, 0.36593407302275277, 0.3967579840858949, 0.3699421522857607, 0.23732485770206244, 0.35770901505693337, 0.37107905647499717, 0.32219670440453135, 0.33220306820112183], 3892.780762176938, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.827899282105609, -2.1396464313029684], [-1.0253502831306864, -2.7238786031344966], [-1.2747730289813877, -2.7379699308395145], [-1.0811696264231152, -2.751576143560482], [-1.0733685786709377, -2.7225488869873335], [-1.2121379567033501, -2.7224439740665676], [-1.0922672477929307, -2.732107840876738], [-0.7365486597810706, -2.5642314905078436], [-0.8063790141248608, -2.6389189335786547], [-0.9738747189641044, -2.7403863223015]  …  [-1.1722810311732774, -2.800036062031949], [-1.400923620804073, -2.644185877118263], [-1.3693326675212236, -2.5894845621937543], [-1.0349514738564323, -2.6979670888450493], [-1.3495215220149983, -2.684009226045991], [-1.9867757041121688, -1.9671992011307564], [-1.4232643737724362, -2.575551876749829], [-1.336972995532859, -2.6879761355290848], [-1.6250351159995542, -2.433011009126704], [-1.5772579097719763, -2.5335395985942437]], [0.19353049908100456, 0.05341410870682261, 0.08538345884590319, 0.059647671127127884, 0.058745596000965516, 0.07634078465366054, 0.060948474825000806, 0.02870925177198795, 0.033615379045369084, 0.048111576475115575  …  0.07094679204822502, 0.10571094116510359, 0.1003558904918975, 0.05444999225782526, 0.09708750301951732, 0.2313457069520496, 0.10960353073573464, 0.0950532673781129, 0.14853939028807078, 0.13873275223584988], 574.8799902273154, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-2.2558285683662027, -0.9429447939767794], [-2.2558285683662027, -1.03980718479549], [-2.2558285683662027, -0.9841438394657651], [-1.570126003757586, -2.47329170039133], [-1.8223670151492906, -2.2274224894649635], [-1.8223670151492906, -2.224979969261703], [-1.6314848551352117, -2.458044201629295], [-1.6178783560684045, -2.4295950289598807], [-1.7566267515166638, -2.2979642442929267], [-1.6386888159682784, -2.4254770656584417]  …  [-2.38021554433832, -0.6542193128038567], [-1.938374749122402, -1.8576417836202825], [-1.938374749122402, -1.8779460524270306], [-1.874568222638676, -2.086338205506358], [-1.874568222638676, -2.054222938132413], [-2.111637317824895, -1.4838933478575536], [-2.111637317824895, -1.4831306031841227], [-2.111637317824895, -1.4797392229561857], [-2.083965829490825, -1.660767134899772], [-2.083965829490825, -1.599337968670349]], [0.23177783133632152, 0.23177783133632152, 0.23177783133632152, 0.08966503739517027, 0.1343036428771726, 0.1343036428771726, 0.09950595230349286, 0.09726602613841095, 0.12162411917542286, 0.10070514245741415  …  0.26182412883987943, 0.15831022989657173, 0.15831022989657173, 0.14486023877774304, 0.14486023877774304, 0.19737686813833147, 0.19737686813833147, 0.19737686813833147, 0.19092950505522754, 0.19092950505522754], 1094.0090280071443, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-2.4444175271615585, 0.1025369393952622], [-2.4444175271615585, 0.1250907961958614], [-2.4637900053253006, 0.07929552574687482], [-2.4637900053253006, 0.09740870956667047], [-2.452657336259356, 0.12008894313247809], [-2.452657336259356, 0.10550849181320432], [-2.0647843438358517, -1.5592302338337016], [-2.267851513042283, -1.0347804485676766], [-2.267363009001631, -1.034346043495], [-2.123093695461071, -1.473827224278811]  …  [-2.2854128102651585, -0.8671922358029431], [-2.4084159873964057, -0.22015118265771338], [-2.408263438461719, -0.22550403958269394], [-2.408263438461719, -0.23540176147730985], [-2.407585162416132, -0.22717966290123748], [-2.407585162416132, -0.22688275321924944], [-2.4161192564707794, -0.39369104563925506], [-2.4161192564707794, -0.3125005349780785], [-2.403833423224895, -0.30903320258678546], [-2.403833423224895, -0.3032060404923054]], [0.0790861641371793, 0.0790861641371793, 0.07636300609783742, 0.07636300609783742, 0.07791981000142459, 0.07791981000142459, 0.1456860387583804, 0.10697552918978527, 0.10706033741960351, 0.1338860412670394  …  0.10395447882958926, 0.08432330036295622, 0.0843459811980722, 0.0843459811980722, 0.08444687674946981, 0.08444687674946981, 0.08318336333986937, 0.08318336333986937, 0.08500643657550812, 0.08500643657550812], 1234.0557533366948, nothing, nothing)</code></pre><h2 id="Plotting-the-Results"><a class="docs-heading-anchor" href="#Plotting-the-Results">Plotting the Results</a><a id="Plotting-the-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-the-Results" title="Permalink"></a></h2><p>We can now plot the observations, the smoothed estimate of the position (the mean of the belief at every time step), and the true state. Note that the estimated position is much closer to the true position than the noisy measurements.</p><pre><code class="language-julia hljs">xmat = readdlm(&quot;x.txt&quot;);

plot_data = [(; t, x1=x[1], x2=x[2], y, b_mean=mean(b)[1]) for (t, (x, y, b)) in enumerate(zip(eachslice(xmat; dims=1), ys, bs))]

plot_data |&gt; @vlplot(x = :t, width = 700) +
             @vlplot(:line, y = :x1, color = {datum = &quot;True State&quot;}) +
             @vlplot(:point, y = :y, color = {datum = &quot;Observation&quot;}) +
             @vlplot(:line, y = :b_mean, color = {datum = &quot;Mean Belief&quot;})</code></pre><img src="5ba7654d.svg" alt="Example block output"/><h2 id="Appendix"><a class="docs-heading-anchor" href="#Appendix">Appendix</a><a id="Appendix-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix" title="Permalink"></a></h2><h3 id="Code-for-Generating-Data"><a class="docs-heading-anchor" href="#Code-for-Generating-Data">Code for Generating Data</a><a id="Code-for-Generating-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Code-for-Generating-Data" title="Permalink"></a></h3><p>The following code can be used to generate the data in the text files:</p><pre><code class="language-julia hljs">rng = MersenneTwister(1)

k = 100
h(x, rng) = x[1] + sigma*randn(rng)

x = [3.0, 0.0]
xs = Array{typeof(x)}(undef, k)
us = zeros(k)
ys = zeros(k)
for t in 1:k
    x = f(x, us[t], rng)
    ys[t] = h(x, rng)
    xs[t] = x
end

using DelimitedFiles
writedlm(&quot;x.txt&quot;, xs)
writedlm(&quot;y.txt&quot;, ys)
writedlm(&quot;u.txt&quot;, us)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sampling/">« Sampling</a><a class="docs-footer-nextpage" href="../example-feedback/">Example: Feedback Control »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Saturday 26 April 2025 15:26">Saturday 26 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
