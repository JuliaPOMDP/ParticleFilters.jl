<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example: Filtering Preexisting Data · ParticleFilters.jl</title><meta name="title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="og:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta property="twitter:title" content="Example: Filtering Preexisting Data · ParticleFilters.jl"/><meta name="description" content="Documentation for ParticleFilters.jl."/><meta property="og:description" content="Documentation for ParticleFilters.jl."/><meta property="twitter:description" content="Documentation for ParticleFilters.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ParticleFilters.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../bootstrap/">Bootstrap Filter</a></li><li><a class="tocitem" href="../beliefs/">Beliefs</a></li><li><a class="tocitem" href="../basic/">Basic Particle Filter</a></li><li><a class="tocitem" href="../depletion/">Handling Particle Depletion</a></li><li><a class="tocitem" href="../sampling/">Sampling</a></li><li class="is-active"><a class="tocitem" href>Example: Filtering Preexisting Data</a><ul class="internal"><li><a class="tocitem" href="#Model"><span>Model</span></a></li><li><a class="tocitem" href="#Data"><span>Data</span></a></li><li><a class="tocitem" href="#Filtering"><span>Filtering</span></a></li><li><a class="tocitem" href="#Plotting-the-Results"><span>Plotting the Results</span></a></li><li><a class="tocitem" href="#Appendix"><span>Appendix</span></a></li></ul></li><li><a class="tocitem" href="../example-feedback/">Example: Feedback Control</a></li><li><a class="tocitem" href="../example-pomdps/">Example: Use with POMDPs.jl</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example: Filtering Preexisting Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPOMDP/ParticleFilters.jl/blob/master/docs/src/example-filtering.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-Filtering-Preexisting-Data"><a class="docs-heading-anchor" href="#Example:-Filtering-Preexisting-Data">Example: Filtering Preexisting Data</a><a id="Example:-Filtering-Preexisting-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Filtering-Preexisting-Data" title="Permalink"></a></h1><p>In some cases, there is no need to perform control based on the particle belief and instead the goal is to filter a previously-generated sequence of measurements to remove noise or reconstruct hidden state variables. This tutorial will illustrate use of the <code>runfilter</code> function for that purpose.</p><p>First, we import the packages we will use. </p><pre><code class="language-julia hljs">using Distributions
using Random
using DelimitedFiles
using ParticleFilters
using VegaLite</code></pre><h2 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h2><p>We will use <a href="https://en.wikipedia.org/wiki/Euler_method">Euler-integrated</a> <a href="https://en.wikipedia.org/wiki/Van_der_Pol_oscillator">Van Der Pol Oscillator Equations</a> with noise added as the dynamics (<code>f</code>), and measurements of the position with gaussian noise added (the pdf is encoded in <code>g</code>).</p><p>This model is implemented below. For more information on defining models for particle filters, see the <a href="https://juliapomdp.github.io/ParticleFilters.jl/latest/models/">documentation</a>.</p><pre><code class="language-julia hljs">const dt = 0.2
const mu = 0.8
const sigma = 1.0

function f(x, u, rng)
    xdot = [x[2], mu * (1 - x[1]^2) * x[2] - x[1] + u + 0.1 * randn(rng)]
    return x + dt * xdot
end

g(x1, u, x2, y) = pdf(Normal(sigma), y - x2[1])</code></pre><h2 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h2><p>Suppose that the data we would like to filter are contained in text files. <a href="../u.txt"><code>u.txt</code></a> contains the control inputs, and <a href="../y.txt"><code>y.txt</code></a> contains the measurements. The code that generated this data can be found in the <a href="#Appendix">appendix below</a>.</p><pre><code class="language-julia hljs">ys = vec(readdlm(&quot;y.txt&quot;));
us = vec(readdlm(&quot;u.txt&quot;));</code></pre><h2 id="Filtering"><a class="docs-heading-anchor" href="#Filtering">Filtering</a><a id="Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering" title="Permalink"></a></h2><p>We can use an SIR particle filter to get a better estimate of the state. Note that we start with an initial belief consisting of particles with zero velocity and position uniformly distributed in <span>$[-5, 5]$</span>.</p><pre><code class="language-julia hljs">n = 10_000

fil = BootstrapFilter(f, g, n)

# construct initial belief
b0 = ParticleCollection([[10.0 * (rand() - 0.5), 0.0] for i in 1:n])

bs = runfilter(fil, b0, us, ys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100-element Vector{Any}:
 WeightedParticleBelief{Vector{Float64}}([[2.6557820285422196, -0.4939214239167127], [4.787056935060371, -0.9767612464529608], [-4.39737890990787, 0.9145947261035124], [-1.1756332136198, 0.22748634786651142], [-0.5132248375117399, 0.07943459979734722], [1.379067450846786, -0.28997473167510607], [4.4966688193746185, -0.9324582328959077], [-0.5558243457477674, 0.11757256917335142], [-4.63635039255634, 0.904213559901447], [-0.13413457368162685, 0.0035602864439715585]  …  [-4.0967371236189365, 0.8153935056926424], [-4.328668098164934, 0.8888093702349921], [2.6779862175839497, -0.5284640651625625], [1.126622670856614, -0.2672608180003976], [-0.7369655237806161, 0.1622480916678059], [2.982912333393777, -0.5888544933465206], [-4.011996776169248, 0.8260606052068566], [3.662079607339388, -0.7425532516541208], [-1.0127331703414266, 0.26148963024600524], [-1.6516144252309595, 0.34720530057170634]], [0.38430894626226936, 0.022145173277484095, 4.1654478364420177e-11, 0.0007110808929898342, 0.006028551834184151, 0.241165323834555, 0.04268048970763735, 0.00532412000324669, 8.009932605760324e-12, 0.016816385907439863  …  3.05668069996688e-10, 6.621401411002811e-11, 0.3818889837414718, 0.1813326988388457, 0.0030759342868384378, 0.3331213350384521, 5.27396849744501e-10, 0.17591864381447145, 0.0012527809165266783, 0.00011674033381628288], 989.8487246937128, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[2.556997743758877, -0.5927890002603726], [2.556997743758877, -0.5421456308663326], [2.556997743758877, -0.5274927901276051], [2.556997743758877, -0.5490861343570496], [1.3210725045117648, -0.5349117520606692], [1.3210725045117648, -0.5458700894837993], [1.3210725045117648, -0.549569735163679], [-0.13342251639283254, 0.04862616106078875], [3.554369762338296, 0.05180742619098322], [0.8740520285899716, -0.43052750972636367]  …  [2.5722934045514374, -0.5424744365442519], [2.5722934045514374, -0.5205752023423121], [2.5722934045514374, -0.5355525603386708], [1.0731705072565345, -0.4847279786318398], [1.0731705072565345, -0.48202013145307654], [2.865141434724473, -0.4392340941334908], [2.865141434724473, -0.43101929673722306], [2.865141434724473, -0.4444204864646797], [3.5135689570085638, 0.02307119008539471], [3.5135689570085638, -0.019970058923648004]], [0.3152432558991601, 0.3152432558991601, 0.3152432558991601, 0.3152432558991601, 0.3430058218191089, 0.3430058218191089, 0.3430058218191089, 0.05354247257470758, 0.09669084617720505, 0.24277119010185924  …  0.31191505690468113, 0.31191505690468113, 0.31191505690468113, 0.29025361681919465, 0.29025361681919465, 0.24332634466431494, 0.24332634466431494, 0.24332634466431494, 0.10348013623005296, 0.10348013623005296], 2764.237559824557, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[2.4384399437068027, -0.5763746877426836], [2.4485686175856105, -0.5923318282063241], [2.451499185733356, -0.5651199033066728], [2.451499185733356, -0.5861784002759264], [2.4471805168874674, -0.5554670585651439], [1.214090154099631, -0.7063444219067803], [1.2118984866150049, -0.8000058163736554], [1.2111585574790291, -0.7288409699997231], [-0.12369728418067479, 0.07886353039454469], [0.7879465266446988, -0.6188989249662462]  …  [2.4655882557244233, -0.5492667868467156], [2.463798517242587, -0.5655903997235994], [2.468178364082975, -0.5774645671539849], [2.468178364082975, -0.5814838896721197], [2.4651828924837034, -0.5628009802967632], [0.9762249115301666, -0.7084422104632553], [0.9767664809659192, -0.6866536978835744], [2.7772946158977745, -0.4940137873963775], [2.7789375753770282, -0.5122664606756129], [3.518183195025643, -0.7091888597483751]], [0.3771398681557203, 0.37584208090375915, 0.37546023611050805, 0.37546023611050805, 0.37602195495291757, 0.26869557435452457, 0.26817186451825853, 0.2679949946910673, 0.033425939466775044, 0.16798944665927074  …  0.37358508493642584, 0.37382688010053416, 0.37323331901364154, 0.37323331901364154, 0.37363994098414494, 0.21141145370275014, 0.21154049129399666, 0.31785632070499403, 0.3175040459477423, 0.14659819333850727], 3254.4958984187824, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[2.323165006158266, -0.6122933280658998], [2.3301022519443455, -0.5977407534506352], [2.3384752050720214, -0.63054874079823], [2.3342635056781704, -0.5963050693651962], [2.3360871051744385, -0.5939231780267458], [1.0728212697182749, -0.8838864724418198], [1.0518973233402737, -0.9804474809572654], [1.0653903634790844, -0.9233430480535247], [-0.10792457810176584, 0.1213234769245844], [0.6641667416514495, -0.8269774871095139]  …  [2.35573489835508, -0.6214638804332799], [2.3506804372978674, -0.6060239698228755], [2.352685450652178, -0.5935291998916049], [2.3518815861485507, -0.6029469226846916], [2.352622696424351, -0.6414967619611724], [0.8345364694375155, -0.9180253591554207], [0.8394357413892043, -0.8836930465533678], [2.678491858418499, -0.5030906996158178], [2.676484283241906, -0.48752033832555075], [3.3763454230759677, -0.09922152296402953]], [0.005921552340671085, 0.005803400739408151, 0.005663569326077857, 0.00573353020931874, 0.005703145202697129, 0.10201958934662911, 0.10558337218477194, 0.1032764161644416, 0.3571061823654589, 0.18429544910897092  …  0.005384675029823567, 0.005465064040957574, 0.005433049159087195, 0.005445864842303734, 0.005434048664243235, 0.14697928552802794, 0.14596343647649274, 0.0019825482614928614, 0.0019955504506442047, 0.00016007488827822093], 435.1989769537979, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[2.2173024695690895, -0.6348293601767357], [0.8960439752299109, -1.0866283732221826], [0.8960439752299109, -1.0660360025201294], [0.8558078271488206, -1.1797622913707877], [0.8558078271488206, -1.1862847965195131], [0.8807217538683795, -1.1131707301190124], [0.8807217538683795, -1.1262027989120584], [0.8807217538683795, -1.1182303373002007], [-0.08365988271684896, 0.1688534303876878], [-0.08365988271684896, 0.13388972216366393]  …  [0.58994927866606, -0.9856171218270036], [0.58994927866606, -0.9595360003948457], [2.231442122268424, -0.6644508435574934], [0.6509313976064313, -1.1374479841074183], [0.6509313976064313, -1.1224359315947183], [0.6509313976064313, -1.121451733934211], [0.6626971320785308, -1.1082686582966412], [0.6626971320785308, -1.0616544781369164], [0.6626971320785308, -1.1206890585911966], [0.6626971320785308, -1.0806127026410022]], [0.39173993078133057, 0.21059666923143877, 0.21059666923143877, 0.20107006721421186, 0.20107006721421186, 0.20695628097638388, 0.20695628097638388, 0.20695628097638388, 0.043060401740061434, 0.043060401740061434  …  0.14218037712733675, 0.14218037712733675, 0.3906449781623013, 0.1549087089939974, 0.1549087089939974, 0.1549087089939974, 0.15742518903736588, 0.15742518903736588, 0.15742518903736588, 0.15742518903736588], 2235.032330821245, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[2.0903365975337422, -0.6799496947876431], [0.6787183005854743, -1.3119186935506426], [0.682836774725885, -1.257716594362504], [0.6198553688746631, -1.4212357850977573], [0.618550867844918, -1.4208415052867724], [0.658087607844577, -1.348189695269093], [0.6554811940859677, -1.3680606828362352], [0.6570756864083394, -1.321337286497487], [-0.05148547975952581, 0.18629759012724845], [0.30041532108849334, -1.1884258937345873]  …  [0.5038849219914168, -1.301233772860934], [0.3943093020774202, -1.2155221492392967], [0.39804207858709084, -1.164217003389688], [2.0985519535569255, -0.6971801475900383], [2.0985519535569255, -0.7015845579942229], [0.42644421128748755, -1.3523331162127614], [0.42664105081958903, -1.3718524762157636], [0.4503662364511475, -1.3052460296123014], [0.43855932036029144, -1.3509276250601745], [0.4465745915503303, -1.3063542133553223]], [0.37361635079788225, 0.08273444853209926, 0.08334035836926759, 0.07440273166013171, 0.07422500569308818, 0.07974456249332089, 0.07937219639844657, 0.07959985124044044, 0.0173536500557164, 0.03937165761146796  …  0.0597538432839638, 0.047976319698740715, 0.0483459962886475, 0.37471703386002253, 0.37471703386002253, 0.0512303196121122, 0.05125075391881901, 0.053759111352668865, 0.052499531199024105, 0.05335216370149024], 1471.320532921408, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.9543466585762137, -0.7086397558160835], [1.9543466585762137, -0.7066014463744533], [0.4163345618753458, -1.5862444332321037], [0.33560821185511164, -1.6930677309384132], [0.3884496687907584, -1.6081402223026995], [0.3818690575187207, -1.607159149472051], [0.044699966052698825, -1.4771312912735237], [0.10312580913632063, -1.4042523092312247], [1.010664286295918, -1.2161044592018204], [0.9994404985942755, -1.3028511596830032]  …  [0.2281727614684208, -1.587611473753625], [0.23347452958774045, -1.5884646662654018], [0.15120487222956086, -1.439680666757148], [1.9591159240389178, -0.7331535341391284], [1.9591159240389178, -0.740323487962586], [1.958235041958081, -0.7491539218871425], [1.958235041958081, -0.7268769300483017], [1.958235041958081, -0.7330501018333141], [0.15227055557643632, -1.6147094270636526], [0.18530374887926582, -1.571077909545501]], [0.2184193197506704, 0.2184193197506704, 0.36207459355511035, 0.34829218887086194, 0.35751651843079174, 0.3564088249364149, 0.2869001729382995, 0.30032645625575216, 0.3942425052340144, 0.3948994389635764  …  0.3274336557589722, 0.3285219898529039, 0.3110476229090245, 0.21727643137449335, 0.21727643137449335, 0.21748744382705437, 0.21748744382705437, 0.21748744382705437, 0.31128139463477333, 0.31843605634205024], 3463.2571090620586, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.812618707412997, -0.7634735913561204], [1.813026369301323, -0.7808402444940626], [0.09908567522892503, -1.8777579670935727], [-0.0030053343325710524, -2.0503591676921635], [0.06682162433021843, -1.8934951515469025], [0.060437227624310474, -1.9532268447582233], [-0.25072629220200593, -1.7061823534154203], [-0.17772465270992432, -1.621954632657707], [0.767443394455554, -1.4387077476697836], [0.7388702666576749, -1.5004619239889203]  …  [-0.08934953328230422, -1.8768593402621465], [-0.08421840366533995, -1.8871834613604457], [-0.13673126112186873, -1.6747053852445086], [1.8124852172110921, -0.7870499349990789], [1.8110512264464005, -0.7770240859992523], [1.8084042575806525, -0.8215078053179046], [1.8128596559484207, -0.7924151074534768], [1.8116250215914182, -0.771600111156432], [-0.17067132983629424, -1.8843940344467383], [-0.1289118330298344, -1.835550214690429]], [0.3331581322219238, 0.3330765798519416, 0.21469296232542678, 0.19063295202499947, 0.20701103043776986, 0.20549847187823414, 0.13681283401387478, 0.15182848797196924, 0.3613598002074636, 0.3566501656981871  …  0.1710043198797997, 0.17214799047143917, 0.1605961051833986, 0.3331848291140074, 0.33347137511033553, 0.3339991469070508, 0.33310993497589614, 0.3333567696835691, 0.15332055134566455, 0.16229416528349655], 3248.0337010815447, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[1.6599239891417727, -0.8358978714395315], [1.6568583204025105, -0.838263717851763], [-0.27646591818978955, -2.2079368527411614], [-0.4130771678710038, -2.391026174176716], [-0.3118774059791621, -2.2172866827683615], [-0.3302081413273342, -2.2787120959699427], [-0.5919627628850901, -1.9094758662583415], [-0.5021155792414658, -1.8508552106719924], [0.47970184492159723, -1.7265614377336873], [0.43877788185989075, -1.7584006074020055]  …  [-0.46472140133473355, -2.1637979287606846], [-0.4616550959374291, -2.167674197311128], [-0.4716723381707705, -1.9122321049899358], [1.6550752302112763, -0.8425005345102983], [1.65564640924655, -0.8326028304140407], [1.6441026965170715, -0.8922811728753395], [1.6543766344577253, -0.8600513436107119], [1.6573049993601319, -0.8771432846631839], [-0.5475501367256419, -2.1410163677809235], [-0.4960218759679202, -2.104509857776549]], [0.02871090934967364, 0.028913411173308038, 0.37421261217392704, 0.3893059399162069, 0.3787459259703615, 0.38092644519088203, 0.3985863131037135, 0.39547653687463447, 0.21452151848396647, 0.22433906887659028  …  0.393252737939157, 0.39304656087276063, 0.3937068095348651, 0.029031723465339002, 0.028993781800159803, 0.02976842516863893, 0.029078183640794054, 0.028883834171495412, 0.3974468615279304, 0.39515097683046957], 2065.776357343289, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.7180532887380218, -2.4958093887877846], [-0.7180532887380218, -2.4978102599233765], [-0.891282402706347, -2.6344944824644307], [-0.891282402706347, -2.628104967540169], [-0.7553347425328344, -2.4925360564509393], [-0.7859505605213228, -2.4935644902064817], [-0.7859505605213228, -2.504223312290795], [-0.9738579361367584, -1.9718467639208739], [-0.9738579361367584, -2.0128144696138355], [-0.8722866213758642, -1.9835670216870938]  …  [-0.8974809870868705, -2.3562167861847545], [-0.8951899353996547, -2.3421017414361827], [-0.8951899353996547, -2.3561170359862476], [-0.8541187591687577, -2.0808651488563212], [-0.8541187591687577, -2.0156526823946583], [1.4656464619420035, -0.9697107825673787], [-0.9757534102818266, -2.2651042291742076], [-0.9757534102818266, -2.2725648845127657], [-0.91692384752323, -2.267855122425178], [-0.91692384752323, -2.261639003101201]], [0.2504861477340159, 0.2504861477340159, 0.20877751357147128, 0.20877751357147128, 0.24146867815818215, 0.23406334011541555, 0.23406334011541555, 0.18940488708408357, 0.18940488708408357, 0.21330143712329125  …  0.20730596981067007, 0.2078495835546608, 0.2078495835546608, 0.21764638320730684, 0.21764638320730684, 0.1897961052506557, 0.18896684473702308, 0.18896684473702308, 0.20270665282646075, 0.20270665282646075], 3211.002356030074, nothing, nothing)
 ⋮
 WeightedParticleBelief{Vector{Float64}}([[0.931896145405493, -1.3216162205737279], [0.7925892048528608, -1.3812599419491505], [0.9224184200991552, -1.297625949534495], [0.7944252340620384, -1.496939666611517], [0.9423110654553858, -1.2972306505618922], [0.8860783163692663, -1.3990637215172321], [0.9087648063582566, -1.3238693586948995], [0.8460044304680643, -1.408776196404986], [0.9074083217885082, -1.3408855728847475], [0.9792156237694118, -1.3102342530975952]  …  [0.7762926414684364, -1.4618496805745187], [0.8497240309893862, -1.3897750072806023], [1.0235213035369282, -1.288540693316636], [0.9144750380289355, -1.295873769552547], [0.9726513043886906, -1.2321959437993821], [0.972564646482999, -1.2490872191936948], [0.9047546391613255, -1.3834074064517998], [0.9430453375885133, -1.338724785046809], [0.8700229164961217, -1.3185220501718513], [0.7349953996990289, -1.535814133793594]], [0.375085151294591, 0.35372792893640914, 0.3738220079880499, 0.35404602473247626, 0.376439124420614, 0.36871099695425247, 0.3719510570728273, 0.3626002288965203, 0.3717619057698448, 0.3809435324745015  …  0.3508651690016175, 0.3631876866765549, 0.38572797889046884, 0.37274084004854985, 0.38017625462509536, 0.38016602630445934, 0.37139017220017945, 0.3765332251369849, 0.36632110513819743, 0.34330543302915817], 3962.0250432678968, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.6675729012907474, -1.513377624647503], [0.5163372164630307, -1.6426082166031903], [0.6628932301922561, -1.5052699455342802], [0.49503730073973495, -1.776363904910665], [0.6828649353430074, -1.5052784921828066], [0.6062655720658199, -1.6383064644619627], [0.6439909346192767, -1.5752371102484668], [0.5642491911870671, -1.6632310099044452], [0.6392312072115587, -1.5436971131039199], [0.7171687731498928, -1.5317482613198323]  …  [0.4839227053535326, -1.6967271186667503], [0.5717690295332658, -1.624867055119211], [0.765813164873601, -1.4614785179667913], [0.6553002841184261, -1.5423520555825365], [0.7262121156288142, -1.4399400290046882], [0.7227472026442601, -1.4531287370914698], [0.6280731578709655, -1.6063798861384053], [0.6753003805791515, -1.5715241203179882], [0.6063185064617514, -1.533305991587965], [0.42783257294031013, -1.809181923397713]], [0.38221229669467777, 0.36150337968322765, 0.3816849205956058, 0.3580198641169777, 0.38388209589517636, 0.37470964240986976, 0.37947753343126034, 0.36885148560353553, 0.37890237563941176, 0.38732483245930865  …  0.356151303612269, 0.36994115238249786, 0.3914692087116029, 0.38081303685835766, 0.38816146678395075, 0.38784444930067746, 0.3775239420110806, 0.3830663775978852, 0.37471666396017944, 0.3462161555724691], 3963.1015765310567, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.3648973763612468, -1.7738631910216653], [0.18781557314239256, -1.9141317440736154], [0.36183924108540005, -1.7929156850504595], [0.13976451975760196, -2.1037111712357155], [0.3818092369064461, -1.7807543253883809], [0.27860427917342734, -1.941726278752571], [0.3289435125695833, -1.8505084838195707], [0.231602989206178, -1.9432187278685515], [0.33049178459077466, -1.8236652907803896], [0.4108191208859263, -1.8008942904319343]  …  [0.14457728162018252, -2.0177771893315106], [0.24679561850942355, -1.9219015208785715], [0.4735174612802427, -1.7259045277380274], [0.3468298730019188, -1.7740626166543636], [0.4382241098278765, -1.666789982209321], [0.43212145522596607, -1.7112065874452664], [0.30679718064328443, -1.8752748392542837], [0.3609955565155539, -1.8623315283982502], [0.2996573081441584, -1.7963394718678758], [0.06599618826076747, -2.111312504420751]], [0.12995395507540114, 0.09812830689972989, 0.12935947791690858, 0.09043611617626186, 0.13326865209355582, 0.1137736491411468, 0.12306143962930459, 0.10549399461190011, 0.1233538607175532, 0.13905998155791233  …  0.09118806072290393, 0.10812830858621707, 0.15201320936592233, 0.12646382092903596, 0.14465004574157592, 0.1433954110344426, 0.11892255246754012, 0.12919573884385668, 0.11760580044138305, 0.07942619149771313], 2121.9741515615533, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[0.010124738156913726, -2.097776872527466], [-0.19501077567233055, -2.2594223134227267], [0.0032561040753081305, -2.101967478848762], [-0.2809777144895412, -2.474045203130275], [0.0256583718287699, -2.051785599222854], [-0.10974097657708692, -2.3228500828785132], [-0.041158184194330816, -2.170620804176573], [-0.15704075636753234, -2.2943850081165538], [-0.034241273565303265, -2.144662513160022], [0.050640262799539426, -2.130207662720001]  …  [-0.25897815624611964, -2.3946235064799817], [-0.13758468566629078, -2.271922872098748], [0.1283365557326372, -2.0418603743807555], [-0.007982650328953955, -2.075261721276357], [0.10486611338601226, -1.9767946671701162], [0.08988013773691278, -2.0294853126598147], [-0.06825778720757236, -2.2103268382277643], [-0.011470749164096183, -2.2058029286361878], [-0.059610586229416784, -2.1215335528945265], [-0.3562663126233827, -2.4697134906550824]], [0.19086731662646836, 0.23975803286065456, 0.19246135239498, 0.26052221685851923, 0.18727828732958243, 0.21919136958602453, 0.20286391380578409, 0.2305786716501415, 0.20123373811676779, 0.18155534800702886  …  0.255222738823729, 0.22588592275057934, 0.16419409260622098, 0.19507849467544766, 0.169363614119004, 0.17269942274265332, 0.2092824866140665, 0.1958929428466275, 0.20722915857226065, 0.2784834736573924], 1050.873902666056, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.40943063634857946, -2.4048425340129276], [-0.6468952383568759, -2.55942291949343], [-0.4171373916944443, -2.438540467494471], [-0.7757867551155961, -2.7773782381800056], [-0.38469874801580095, -2.3650012482014757], [-0.5743109931527897, -2.6750271074340866], [-0.4752823450296454, -2.5366081925215855], [-0.6159177579908431, -2.651203055635107], [-0.46317377619730765, -2.4964663450196665], [-0.3754012697444608, -2.455310086631698]  …  [-0.737902857542116, -2.7002573693174474], [-0.5919692600860404, -2.6546041036053594], [-0.28003551914351393, -2.3926737308644364], [-0.4230349945842254, -2.393665351808879], [-0.290492820048011, -2.3071781700342338], [-0.31601692479505017, -2.391022422250916], [-0.5103231548531253, -2.538425475996815], [-0.4526313348913338, -2.5785341297758073], [-0.48391729680832213, -2.431094905506053], [-0.8502090107543991, -2.76217006509812]], [0.2858051024566005, 0.33732768896703297, 0.28760114193468433, 0.3604697275454204, 0.2800044608730002, 0.3225882008748378, 0.30094380844012425, 0.3311698881627479, 0.29819822531143775, 0.2778104472539514  …  0.3541176739568405, 0.3262718218426316, 0.2549992082527214, 0.2889715898626, 0.2575205328064286, 0.2636586457872285, 0.3087772908822412, 0.2957928442516994, 0.30289005895316046, 0.37172521261181884], 1685.9805923062218, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-0.890399143151165, -2.6433641207708485], [-1.1587798222555619, -2.6373536913808895], [-0.9048454851933385, -2.6767605192892607], [-1.3312624027515971, -2.817267564303421], [-0.8576989976560961, -2.624477329252665], [-1.1093164146396068, -2.806416235892677], [-0.9826039835339625, -2.71966901520548], [-1.1461583691178645, -2.8246094891255513], [-0.9624670452012409, -2.706576873123501], [-0.8664632870708004, -2.7286195728643454]  …  [-1.2779543314056054, -2.7629868977737706], [-1.1228900808071125, -2.7654695818168697], [-0.7585702653164013, -2.679819081976572], [-0.9017680649460011, -2.6323411439192768], [-0.7519284540548579, -2.6059481889512894], [-0.7942214092452333, -2.6757372923388583], [-1.0180082500524883, -2.7255361268191876], [-0.9683381608464953, -2.787920750514625], [-0.9701362779095328, -2.6067610535139707], [-1.402643023774023, -2.663398255299124]], [0.35756543467320107, 0.30420747306110196, 0.35511921990729245, 0.26396776954285095, 0.3628851689100001, 0.31510599936579287, 0.3410122273643299, 0.3070234477774845, 0.34481078232793905, 0.3614895739715475  …  0.2766779874761434, 0.3121529760953866, 0.37702859267900096, 0.3556451375410172, 0.37786294935987175, 0.372300632114961, 0.3341062288694351, 0.34371332228673546, 0.34337554032802536, 0.24675754854300574], 3881.2030574275686, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.4190719673053347, -2.5508908114096305], [-1.68625056053174, -2.293771683681416], [-1.4401975890511907, -2.580735117835229], [-1.8947159156122813, -2.239045003962128], [-1.3825944635066292, -2.5869365900168986], [-1.6705996618181422, -2.506892767560828], [-1.5265377865750587, -2.5351761397777106], [-1.7110802669429748, -2.445334495121277], [-1.5037824198259413, -2.5425308003737346], [-1.4121872016436696, -2.6733529604919872]  …  [-1.8305517109603597, -2.2173809053515545], [-1.6759839971704866, -2.4145420784480978], [-1.2945340817117157, -2.7196661518054], [-1.4282362937298565, -2.525601576077366], [-1.2731180918451157, -2.666907903910311], [-1.329368867713005, -2.671378300322685], [-1.5631154754163257, -2.5096649673003153], [-1.5259223109494202, -2.6173132286808913], [-1.491488488612327, -2.429492713290145], [-1.935322674833848, -1.9768630626884067]], [0.10886643004599787, 0.16158410324100173, 0.11261168812423886, 0.20925862292440306, 0.10258253927138633, 0.1582001864208381, 0.12870766875009634, 0.16701775859232215, 0.12434459636157315, 0.10766259759686045  …  0.19414823802832545, 0.15936067825139075, 0.08838094431007579, 0.1104816384901763, 0.08513558049456889, 0.093834173172692, 0.13589656230412428, 0.1285885440593728, 0.1220229512443858, 0.2189570657182057], 364.12099553100785, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-1.9292501295872608, -1.8304369146520711], [-1.9292501295872608, -1.8651919237722723], [-1.9292501295872608, -1.8715227557752367], [-2.145004897268023, -1.2997061549619047], [-2.145004897268023, -1.2816388767280469], [-2.145004897268023, -1.2981177048360928], [-2.145004897268023, -1.2759799047064742], [-2.145004897268023, -1.2434195382805957], [-1.9563446126182364, -1.8460350173399478], [-1.9563446126182364, -1.859077753146819]  …  [-2.0493849566855986, -1.7182313409510648], [-1.9773870312703559, -1.6463564358404088], [-1.9773870312703559, -1.6458527479031475], [-1.9773870312703559, -1.6674815071990121], [-2.330695287371529, -0.739162279420627], [-2.330695287371529, -0.7358847725888698], [-2.330695287371529, -0.7087099549200033], [-2.330695287371529, -0.7186719212354216], [-2.330695287371529, -0.7408050185354842], [-2.330695287371529, -0.7488821983367777]], [0.15635187854828334, 0.15635187854828334, 0.15635187854828334, 0.20523251344373855, 0.20523251344373855, 0.20523251344373855, 0.20523251344373855, 0.20523251344373855, 0.1621994921363648, 0.1621994921363648  …  0.18297046864824315, 0.1668068948339977, 0.1668068948339977, 0.1668068948339977, 0.24988456376863977, 0.24988456376863977, 0.24988456376863977, 0.24988456376863977, 0.24988456376863977, 0.24988456376863977], 815.6572935885164, nothing, nothing)
 WeightedParticleBelief{Vector{Float64}}([[-2.295337512517675, -0.6412358380181733], [-2.295337512517675, -0.6798126283746424], [-2.3022885143417153, -0.6902956719480726], [-2.3022885143417153, -0.6816821975180578], [-2.303554680742308, -0.6575352418297398], [-2.404946128260404, -0.08805020551478915], [-2.404946128260404, -0.1406210782830204], [-2.404946128260404, -0.13202667016145608], [-2.4013326726136324, -0.11760030645204722], [-2.4013326726136324, -0.13101740754153823]  …  [-2.47243727835553, 0.24709825153316578], [-2.4744296716186134, 0.2591470533008413], [-2.4744296716186134, 0.24955054126353626], [-2.4744296716186134, 0.26928249623561107], [-2.478856291078626, 0.2848009692019522], [-2.478856291078626, 0.23118882663616602], [-2.478856291078626, 0.24352464235620408], [-2.4804717270388847, 0.26011513768663974], [-2.4804717270388847, 0.23953430810356435], [-2.4804717270388847, 0.2422745785225806]], [0.10227108184144673, 0.10227108184144673, 0.10110240311891722, 0.10110240311891722, 0.10089043886975427, 0.08484021911110774, 0.08484021911110774, 0.08484021911110774, 0.08538080584641618, 0.08538080584641618  …  0.07516882908660531, 0.07489554615117625, 0.07489554615117625, 0.07489554615117625, 0.07429087222584325, 0.07429087222584325, 0.07429087222584325, 0.07407106097556176, 0.07407106097556176, 0.07407106097556176], 1453.2796047720626, nothing, nothing)</code></pre><h2 id="Plotting-the-Results"><a class="docs-heading-anchor" href="#Plotting-the-Results">Plotting the Results</a><a id="Plotting-the-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-the-Results" title="Permalink"></a></h2><p>We can now plot the observations, the smoothed estimate of the position (the mean of the belief at every time step), and the true state. Note that the estimated position is much closer to the true position than the noisy measurements.</p><pre><code class="language-julia hljs">xmat = readdlm(&quot;x.txt&quot;);

plot_data = [(; t, x1=x[1], x2=x[2], y, b_mean=mean(b)[1]) for (t, (x, y, b)) in enumerate(zip(eachslice(xmat; dims=1), ys, bs))]

plot_data |&gt; @vlplot(x = :t, width = 700) +
             @vlplot(:line, y = :x1, color = {datum = &quot;True State&quot;}) +
             @vlplot(:point, y = :y, color = {datum = &quot;Observation&quot;}) +
             @vlplot(:line, y = :b_mean, color = {datum = &quot;Mean Belief&quot;})</code></pre><img src="156ef48e.svg" alt="Example block output"/><h2 id="Appendix"><a class="docs-heading-anchor" href="#Appendix">Appendix</a><a id="Appendix-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix" title="Permalink"></a></h2><h3 id="Code-for-Generating-Data"><a class="docs-heading-anchor" href="#Code-for-Generating-Data">Code for Generating Data</a><a id="Code-for-Generating-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Code-for-Generating-Data" title="Permalink"></a></h3><p>The following code can be used to generate the data in the text files:</p><pre><code class="language-julia hljs">rng = MersenneTwister(1)

k = 100
h(x, rng) = x[1] + sigma*randn(rng)

x = [3.0, 0.0]
xs = Array{typeof(x)}(undef, k)
us = zeros(k)
ys = zeros(k)
for t in 1:k
    x = f(x, us[t], rng)
    ys[t] = h(x, rng)
    xs[t] = x
end

using DelimitedFiles
writedlm(&quot;x.txt&quot;, xs)
writedlm(&quot;y.txt&quot;, ys)
writedlm(&quot;u.txt&quot;, us)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sampling/">« Sampling</a><a class="docs-footer-nextpage" href="../example-feedback/">Example: Feedback Control »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Saturday 26 April 2025 17:24">Saturday 26 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
